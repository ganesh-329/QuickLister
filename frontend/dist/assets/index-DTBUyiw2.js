var an=Object.defineProperty;var on=(t,e,r)=>e in t?an(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var bt=(t,e,r)=>on(t,typeof e!="symbol"?e+"":e,r);import{j as s,C as Xs,M as st,O as Qs,u as Zs,G as er}from"./maps-MJXBvrIf.js";import{a as ln,r as tr,g as cn}from"./vendor-BtP0CW_r.js";import{r as x,R as B,a as Vt,u as ue,b as dn,B as un,c as hn,d as K,N as ee}from"./router-CAX-aOzw.js";import{P as sr,M as mn,L as fn,a as ce,A as rr,X as ne,C as nr,S as ar,b as at,D as Jt,c as Ue,U as we,d as pn,T as or,e as Yt,f as ot,g as ir,F as Ne,R as gn,B as ie,h as xn,i as Fe,j as yn,k as bn,l as wn,m as jn,n as vn,H as Nn,o as lr,p as Sn,q as wt,r as kn,s as Cn,t as Pt,E as En,u as An,v as Kt,w as _n,x as cr,y as dr,z as Rn,G as Tn,I as Pn,J as Ln}from"./icons-nYqfWIpE.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}})();var qe={},ys;function On(){if(ys)return qe;ys=1;var t=ln();return qe.createRoot=t.createRoot,qe.hydrateRoot=t.hydrateRoot,qe}var Dn=On();const Fn=({onToggleLocationPicker:t,resetToLiveLocation:e,isLocationPickerActive:r,hasManualLocation:n,mapRef:a})=>{const o=()=>{if(a){const c=a.getZoom()||0;a.setZoom(c+1)}},i=()=>{if(a){const c=a.getZoom()||0;a.setZoom(Math.max(0,c-1))}},l=()=>{if(a){const d=a.getMapTypeId()==="roadmap"?"satellite":"roadmap";a.setMapTypeId(d)}};return s.jsx(s.Fragment,{children:s.jsxs("div",{className:"absolute left-6 top-8 z-[400] flex flex-col gap-3",children:[s.jsx("button",{className:"bg-white p-3 rounded-full shadow-lg hover:bg-gray-100 focus:outline-none transition-all",title:"Zoom In",onClick:o,children:s.jsx(sr,{size:24,className:"text-gray-700"})}),s.jsx("button",{className:"bg-white p-3 rounded-full shadow-lg hover:bg-gray-100 focus:outline-none transition-all",title:"Zoom Out",onClick:i,children:s.jsx(mn,{size:24,className:"text-gray-700"})}),s.jsx("button",{onClick:l,className:"bg-white p-3 rounded-full shadow-lg hover:bg-gray-100 focus:outline-none transition-all",title:"Toggle Map Type",children:s.jsx(fn,{size:24,className:"text-gray-700"})}),s.jsx("button",{onClick:t,className:`p-3 rounded-full shadow-lg focus:outline-none transition-all ${r?"bg-red-500 text-white hover:bg-red-600":n?"bg-green-500 text-white hover:bg-green-600":"bg-white text-gray-700 hover:bg-gray-100"}`,title:"Set Location Manually",children:s.jsx(ce,{size:24})}),n&&s.jsx("button",{onClick:e,className:"bg-blue-500 text-white p-3 rounded-full shadow-lg hover:bg-blue-600 focus:outline-none transition-all",title:"Return to Live Location",children:s.jsx(rr,{size:24})})]})})},Mn=({mapRef:t})=>{const[e,r]=x.useState(null),[n,a]=x.useState(0),[o,i]=x.useState(!0),[l,c]=x.useState(!1),d=x.useRef(null);return x.useEffect(()=>{if(!t||l||!("geolocation"in navigator))return;console.log("Starting geolocation watch..."),c(!0),navigator.geolocation.getCurrentPosition(m=>{const u={lat:m.coords.latitude,lng:m.coords.longitude};console.log("Got initial position:",u),r(u),a(m.coords.accuracy),t&&o&&(t.panTo(u),t.setZoom(15),i(!1))},m=>{console.warn("Error getting initial position:",m)},{enableHighAccuracy:!0,maximumAge:1e4,timeout:8e3});const h=navigator.geolocation.watchPosition(m=>{const u={lat:m.coords.latitude,lng:m.coords.longitude};console.log("Position updated:",u),r(u),a(m.coords.accuracy),t&&o&&(t.panTo(u),t.setZoom(15),i(!1))},m=>{console.error("Error watching position:",m)},{enableHighAccuracy:!0,maximumAge:3e4,timeout:1e4});return()=>{console.log("Cleaning up geolocation watch..."),h!==null&&navigator.geolocation.clearWatch(h),c(!1)}},[t]),x.useEffect(()=>{if(!t||!e)return;d.current&&(d.current.map=null,d.current=null);const h=document.createElement("div");h.style.width="16px",h.style.height="16px",h.style.borderRadius="50%",h.style.backgroundColor="#4285F4",h.style.border="2px solid #FFFFFF",h.style.boxShadow="0 2px 6px rgba(0,0,0,0.3)";try{d.current=new google.maps.marker.AdvancedMarkerElement({map:t,position:e,content:h,title:"Your location"})}catch(m){console.warn("Error creating advanced marker, falling back to regular marker:",m),d.current=new google.maps.Marker({map:t,position:e,icon:{path:google.maps.SymbolPath.CIRCLE,scale:8,fillColor:"#4285F4",fillOpacity:1,strokeColor:"#FFFFFF",strokeWeight:2},title:"Your location"})}return()=>{if(d.current){try{"map"in d.current&&typeof d.current.map=="object"?d.current.map=null:"setMap"in d.current&&typeof d.current.setMap=="function"&&d.current.setMap(null)}catch(m){console.warn("Error cleaning up marker:",m)}d.current=null}}},[t,e]),e?s.jsx(s.Fragment,{children:s.jsx(Xs,{center:e,radius:n,options:{fillColor:"#4285F4",fillOpacity:.2,strokeColor:"#4285F4",strokeOpacity:.8,strokeWeight:1}})}):null},In=({isActive:t,onSelect:e,onCancel:r,mapRef:n})=>{var c;const[a,o]=x.useState(null),i=d=>{!t||!d.latLng||o({lat:d.latLng.lat(),lng:d.latLng.lng()})};B.useEffect(()=>{var u;if(!n||!t)return;const d=n.addListener("click",i),h=document.createElement("div");h.id="location-picker-instruction",h.className="absolute top-4 left-1/2 transform -translate-x-1/2 bg-white py-2 px-4 rounded-full shadow-md z-50",h.innerHTML='<span class="font-medium">Tap on the map to set your location</span>',(u=document.querySelector(".h-full.w-full.relative"))==null||u.appendChild(h);const m=n.getDiv();return m.style.cursor="crosshair",()=>{var w;google.maps.event.removeListener(d),(w=document.getElementById("location-picker-instruction"))==null||w.remove(),m.style.cursor="",t&&o(null)}},[n,t]);const l=()=>{a&&(e(a),o(null))};return s.jsx(s.Fragment,{children:t&&a&&s.jsxs(s.Fragment,{children:[s.jsx(st,{position:a,icon:{path:(c=window.google)==null?void 0:c.maps.SymbolPath.CIRCLE,scale:8,fillColor:"#EF4444",fillOpacity:1,strokeColor:"#FFFFFF",strokeWeight:2}}),s.jsxs("div",{className:"absolute bottom-24 left-1/2 transform -translate-x-1/2 flex space-x-4 z-50",children:[s.jsx("button",{onClick:r,className:"bg-white p-3 rounded-full shadow-md hover:bg-gray-100 focus:outline-none","aria-label":"Cancel location selection",children:s.jsx(ne,{size:24,className:"text-red-500"})}),s.jsx("button",{onClick:l,className:"bg-blue-500 p-3 rounded-full shadow-md hover:bg-blue-600 focus:outline-none","aria-label":"Confirm location selection",children:s.jsx(nr,{size:24,className:"text-white"})})]})]})})},Bn=({onPlaceSelected:t,onClose:e,isActive:r})=>{const[n,a]=x.useState(""),[o,i]=x.useState([]),[l,c]=x.useState(!1),d=x.useRef(null);x.useEffect(()=>{r&&d.current&&d.current.focus()},[r]);const h=async u=>{const w=u.target.value;if(a(w),w.length>2)try{const g=await new google.maps.places.AutocompleteService().getPlacePredictions({input:w,types:["geocode","establishment"],componentRestrictions:{country:"in"}});i((g==null?void 0:g.predictions)||[]),c(!0)}catch(p){console.error("Error fetching predictions:",p),i([])}else i([]),c(!1)},m=async u=>{try{const w=new google.maps.places.PlacesService(document.createElement("div")),p=await new Promise((g,f)=>{w.getDetails({placeId:u.place_id,fields:["geometry","name","formatted_address"]},(y,j)=>{j===google.maps.places.PlacesServiceStatus.OK&&y?g(y):f(new Error("Failed to get place details"))})});t(p),a(u.description),c(!1)}catch(w){console.error("Error getting place details:",w)}};return r?s.jsx("div",{className:"absolute top-4 left-1/2 transform -translate-x-1/2 z-[400] w-full max-w-md px-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-2",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx("input",{ref:d,type:"text",value:n,onChange:h,placeholder:"Search for a location...",className:"w-full px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),n&&s.jsx("button",{onClick:()=>{a(""),i([]),c(!1)},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s.jsx(ne,{})})]}),s.jsx("button",{onClick:e,className:"p-2 text-gray-500 hover:text-gray-700",children:s.jsx(ne,{})})]}),l&&o.length>0&&s.jsx("div",{className:"mt-2 max-h-60 overflow-y-auto",children:o.map(u=>s.jsxs("button",{onClick:()=>m(u),className:"w-full px-4 py-2 text-left hover:bg-gray-100 flex items-center gap-2",children:[s.jsx(ar,{className:"text-gray-400"}),s.jsx("span",{className:"text-sm",children:u.description})]},u.place_id))})]})}):null},Un=({gig:t,isSelected:e,onClick:r})=>{const[n,a]=x.useState(!1),[o,i]=x.useState(!1),l={lat:t.location.coordinates[1],lng:t.location.coordinates[0]};B.useEffect(()=>{if(e){i(!0);const m=setTimeout(()=>i(!1),600);return()=>clearTimeout(m)}},[e]);const c=B.useCallback(()=>{r&&r(t._id)},[t._id,r]),d=()=>{switch(t.urgency){case"urgent":return"bg-red-500 border-red-600";case"high":return"bg-orange-500 border-orange-600";case"medium":return"bg-yellow-500 border-yellow-600";default:return"bg-green-500 border-green-600"}},h=()=>{switch(t.category.toLowerCase()){case"delivery":return"ðŸšš";case"tech":return"ðŸ’»";case"home":return"ðŸ ";case"food":return"ðŸ•";default:return"ðŸ’¼"}};return s.jsx(Qs,{position:l,mapPaneName:"overlayMouseTarget",getPixelPositionOffset:()=>({x:-20,y:-40}),children:s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:`
            relative cursor-pointer transform transition-all duration-200 hover:scale-110
            ${o?"animate-bounce":""}
            ${e?"z-50":"z-10"}
          `,onClick:c,onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),children:[s.jsxs("div",{className:`
            w-10 h-10 ${d()} rounded-full flex items-center justify-center
            shadow-lg border-2 border-white relative
            ${n||e?"ring-4 ring-opacity-30":""}
            ${n||e?"ring-blue-400":""}
          `,children:[s.jsx("span",{className:"text-white text-lg",children:h()}),s.jsx("div",{className:`
              absolute -bottom-2 left-1/2 transform -translate-x-1/2
              w-0 h-0 border-l-[8px] border-r-[8px] border-t-[10px]
              border-l-transparent border-r-transparent
              ${d().replace("bg-","border-t-")}
            `})]}),s.jsxs("div",{className:`
            absolute -top-2 -right-2 bg-gray-900 text-white text-xs px-2 py-1 rounded-full
            font-semibold shadow-md border border-gray-700
            ${n||e?"opacity-100":"opacity-90"}
          `,children:["â‚¹",t.payment.rate,t.payment.paymentType==="hourly"&&"/hr"]})]}),(n||e)&&s.jsxs("div",{className:`
            absolute bottom-full left-1/2 transform -translate-x-1/2 mb-3
            bg-white rounded-lg shadow-xl border border-gray-200 p-3
            min-w-[250px] max-w-[300px] z-50
            ${n||e?"animate-fadeIn":""}
          `,children:[s.jsx("div",{className:`absolute -bottom-2 left-1/2 transform -translate-x-1/2 
                          w-0 h-0 border-l-[8px] border-r-[8px] border-t-[8px]
                          border-l-transparent border-r-transparent border-t-white`}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"font-semibold text-gray-900 text-sm line-clamp-2",children:t.title}),s.jsxs("div",{className:"flex items-center text-xs text-gray-600 gap-1",children:[s.jsx(ce,{className:"text-gray-400"}),s.jsx("span",{className:"line-clamp-1",children:t.location.address})]}),s.jsxs("div",{className:"flex items-center text-xs text-gray-600 gap-1",children:[s.jsx(at,{className:"text-gray-400"}),s.jsxs("span",{children:[t.timeline.duration?`${t.timeline.duration} hours`:"Flexible",t.timeline.preferredTime&&` â€¢ ${t.timeline.preferredTime}`]})]}),t.skills.length>0&&s.jsxs("div",{className:"flex flex-wrap gap-1",children:[t.skills.slice(0,3).map((m,u)=>s.jsx("span",{className:"bg-blue-100 text-blue-700 text-xs px-2 py-0.5 rounded-full",children:m.name},u)),t.skills.length>3&&s.jsxs("span",{className:"text-xs text-gray-500",children:["+",t.skills.length-3," more"]})]}),s.jsx("div",{className:"flex items-center justify-between pt-2 border-t border-gray-100",children:s.jsxs("div",{className:"text-xs text-gray-500",children:[t.applicationsCount," applicant",t.applicationsCount!==1?"s":""]})})]})]})]})})},ur=({isOpen:t,onClose:e,title:r,children:n,size:a="md"})=>{if(x.useEffect(()=>{const l=c=>{c.key==="Escape"&&e()};return t&&(document.addEventListener("keydown",l),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",l),document.body.style.overflow="unset"}},[t,e]),!t)return null;const o={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"},i=s.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:e}),s.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:s.jsxs("div",{className:`relative bg-white rounded-lg shadow-xl transform transition-all w-full ${o[a]}`,onClick:l=>l.stopPropagation(),children:[r&&s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:r}),s.jsx("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded-full transition-colors",children:s.jsx(ne,{size:20,className:"text-gray-400"})})]}),s.jsx("div",{className:"p-6",children:n})]})})]});return Vt.createPortal(i,document.body)},zn={},bs=t=>{let e;const r=new Set,n=(h,m)=>{const u=typeof h=="function"?h(e):h;if(!Object.is(u,e)){const w=e;e=m??(typeof u!="object"||u===null)?u:Object.assign({},e,u),r.forEach(p=>p(e,w))}},a=()=>e,c={setState:n,getState:a,getInitialState:()=>d,subscribe:h=>(r.add(h),()=>r.delete(h)),destroy:()=>{(zn?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},d=e=t(n,a,c);return c},$n=t=>t?bs(t):bs;var jt={exports:{}},vt={},Nt={exports:{}},St={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ws;function qn(){if(ws)return St;ws=1;var t=tr();function e(m,u){return m===u&&(m!==0||1/m===1/u)||m!==m&&u!==u}var r=typeof Object.is=="function"?Object.is:e,n=t.useState,a=t.useEffect,o=t.useLayoutEffect,i=t.useDebugValue;function l(m,u){var w=u(),p=n({inst:{value:w,getSnapshot:u}}),g=p[0].inst,f=p[1];return o(function(){g.value=w,g.getSnapshot=u,c(g)&&f({inst:g})},[m,w,u]),a(function(){return c(g)&&f({inst:g}),m(function(){c(g)&&f({inst:g})})},[m]),i(w),w}function c(m){var u=m.getSnapshot;m=m.value;try{var w=u();return!r(m,w)}catch{return!0}}function d(m,u){return u()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:l;return St.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:h,St}var js;function Wn(){return js||(js=1,Nt.exports=qn()),Nt.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vs;function Gn(){if(vs)return vt;vs=1;var t=tr(),e=Wn();function r(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var n=typeof Object.is=="function"?Object.is:r,a=e.useSyncExternalStore,o=t.useRef,i=t.useEffect,l=t.useMemo,c=t.useDebugValue;return vt.useSyncExternalStoreWithSelector=function(d,h,m,u,w){var p=o(null);if(p.current===null){var g={hasValue:!1,value:null};p.current=g}else g=p.current;p=l(function(){function y(_){if(!j){if(j=!0,N=_,_=u(_),w!==void 0&&g.hasValue){var S=g.value;if(w(S,_))return v=S}return v=_}if(S=v,n(N,_))return S;var L=u(_);return w!==void 0&&w(S,L)?(N=_,S):(N=_,v=L)}var j=!1,N,v,C=m===void 0?null:m;return[function(){return y(h())},C===null?void 0:function(){return y(C())}]},[h,m,u,w]);var f=a(d,p[0],p[1]);return i(function(){g.hasValue=!0,g.value=f},[f]),c(f),f},vt}var Ns;function Hn(){return Ns||(Ns=1,jt.exports=Gn()),jt.exports}var Vn=Hn();const Jn=cn(Vn),hr={},{useDebugValue:Yn}=B,{useSyncExternalStoreWithSelector:Kn}=Jn;let Ss=!1;const Xn=t=>t;function Qn(t,e=Xn,r){(hr?"production":void 0)!=="production"&&r&&!Ss&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Ss=!0);const n=Kn(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,r);return Yn(n),n}const ks=t=>{(hr?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?$n(t):t,r=(n,a)=>Qn(e,n,a);return Object.assign(r,e),r},Xt=t=>t?ks(t):ks,Zn=t=>(e,r,n)=>{const a=n.subscribe;return n.subscribe=(i,l,c)=>{let d=i;if(l){const h=(c==null?void 0:c.equalityFn)||Object.is;let m=i(n.getState());d=u=>{const w=i(u);if(!h(m,w)){const p=m;l(m=w,p)}},c!=null&&c.fireImmediately&&l(m,m)}return a(d)},t(e,r,n)},ea=Zn;function mr(t,e){return function(){return t.apply(e,arguments)}}const{toString:ta}=Object.prototype,{getPrototypeOf:Qt}=Object,{iterator:it,toStringTag:fr}=Symbol,lt=(t=>e=>{const r=ta.call(e);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Q=t=>(t=t.toLowerCase(),e=>lt(e)===t),ct=t=>e=>typeof e===t,{isArray:Se}=Array,Me=ct("undefined");function sa(t){return t!==null&&!Me(t)&&t.constructor!==null&&!Me(t.constructor)&&W(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const pr=Q("ArrayBuffer");function ra(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&pr(t.buffer),e}const na=ct("string"),W=ct("function"),gr=ct("number"),dt=t=>t!==null&&typeof t=="object",aa=t=>t===!0||t===!1,Ve=t=>{if(lt(t)!=="object")return!1;const e=Qt(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(fr in t)&&!(it in t)},oa=Q("Date"),ia=Q("File"),la=Q("Blob"),ca=Q("FileList"),da=t=>dt(t)&&W(t.pipe),ua=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||W(t.append)&&((e=lt(t))==="formdata"||e==="object"&&W(t.toString)&&t.toString()==="[object FormData]"))},ha=Q("URLSearchParams"),[ma,fa,pa,ga]=["ReadableStream","Request","Response","Headers"].map(Q),xa=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ze(t,e,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let n,a;if(typeof t!="object"&&(t=[t]),Se(t))for(n=0,a=t.length;n<a;n++)e.call(null,t[n],n,t);else{const o=r?Object.getOwnPropertyNames(t):Object.keys(t),i=o.length;let l;for(n=0;n<i;n++)l=o[n],e.call(null,t[l],l,t)}}function xr(t,e){e=e.toLowerCase();const r=Object.keys(t);let n=r.length,a;for(;n-- >0;)if(a=r[n],e===a.toLowerCase())return a;return null}const ge=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,yr=t=>!Me(t)&&t!==ge;function Lt(){const{caseless:t}=yr(this)&&this||{},e={},r=(n,a)=>{const o=t&&xr(e,a)||a;Ve(e[o])&&Ve(n)?e[o]=Lt(e[o],n):Ve(n)?e[o]=Lt({},n):Se(n)?e[o]=n.slice():e[o]=n};for(let n=0,a=arguments.length;n<a;n++)arguments[n]&&ze(arguments[n],r);return e}const ya=(t,e,r,{allOwnKeys:n}={})=>(ze(e,(a,o)=>{r&&W(a)?t[o]=mr(a,r):t[o]=a},{allOwnKeys:n}),t),ba=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),wa=(t,e,r,n)=>{t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),r&&Object.assign(t.prototype,r)},ja=(t,e,r,n)=>{let a,o,i;const l={};if(e=e||{},t==null)return e;do{for(a=Object.getOwnPropertyNames(t),o=a.length;o-- >0;)i=a[o],(!n||n(i,t,e))&&!l[i]&&(e[i]=t[i],l[i]=!0);t=r!==!1&&Qt(t)}while(t&&(!r||r(t,e))&&t!==Object.prototype);return e},va=(t,e,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=e.length;const n=t.indexOf(e,r);return n!==-1&&n===r},Na=t=>{if(!t)return null;if(Se(t))return t;let e=t.length;if(!gr(e))return null;const r=new Array(e);for(;e-- >0;)r[e]=t[e];return r},Sa=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&Qt(Uint8Array)),ka=(t,e)=>{const n=(t&&t[it]).call(t);let a;for(;(a=n.next())&&!a.done;){const o=a.value;e.call(t,o[0],o[1])}},Ca=(t,e)=>{let r;const n=[];for(;(r=t.exec(e))!==null;)n.push(r);return n},Ea=Q("HTMLFormElement"),Aa=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),Cs=(({hasOwnProperty:t})=>(e,r)=>t.call(e,r))(Object.prototype),_a=Q("RegExp"),br=(t,e)=>{const r=Object.getOwnPropertyDescriptors(t),n={};ze(r,(a,o)=>{let i;(i=e(a,o,t))!==!1&&(n[o]=i||a)}),Object.defineProperties(t,n)},Ra=t=>{br(t,(e,r)=>{if(W(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=t[r];if(W(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},Ta=(t,e)=>{const r={},n=a=>{a.forEach(o=>{r[o]=!0})};return Se(t)?n(t):n(String(t).split(e)),r},Pa=()=>{},La=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function Oa(t){return!!(t&&W(t.append)&&t[fr]==="FormData"&&t[it])}const Da=t=>{const e=new Array(10),r=(n,a)=>{if(dt(n)){if(e.indexOf(n)>=0)return;if(!("toJSON"in n)){e[a]=n;const o=Se(n)?[]:{};return ze(n,(i,l)=>{const c=r(i,a+1);!Me(c)&&(o[l]=c)}),e[a]=void 0,o}}return n};return r(t,0)},Fa=Q("AsyncFunction"),Ma=t=>t&&(dt(t)||W(t))&&W(t.then)&&W(t.catch),wr=((t,e)=>t?setImmediate:e?((r,n)=>(ge.addEventListener("message",({source:a,data:o})=>{a===ge&&o===r&&n.length&&n.shift()()},!1),a=>{n.push(a),ge.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",W(ge.postMessage)),Ia=typeof queueMicrotask<"u"?queueMicrotask.bind(ge):typeof process<"u"&&process.nextTick||wr,Ba=t=>t!=null&&W(t[it]),b={isArray:Se,isArrayBuffer:pr,isBuffer:sa,isFormData:ua,isArrayBufferView:ra,isString:na,isNumber:gr,isBoolean:aa,isObject:dt,isPlainObject:Ve,isReadableStream:ma,isRequest:fa,isResponse:pa,isHeaders:ga,isUndefined:Me,isDate:oa,isFile:ia,isBlob:la,isRegExp:_a,isFunction:W,isStream:da,isURLSearchParams:ha,isTypedArray:Sa,isFileList:ca,forEach:ze,merge:Lt,extend:ya,trim:xa,stripBOM:ba,inherits:wa,toFlatObject:ja,kindOf:lt,kindOfTest:Q,endsWith:va,toArray:Na,forEachEntry:ka,matchAll:Ca,isHTMLForm:Ea,hasOwnProperty:Cs,hasOwnProp:Cs,reduceDescriptors:br,freezeMethods:Ra,toObjectSet:Ta,toCamelCase:Aa,noop:Pa,toFiniteNumber:La,findKey:xr,global:ge,isContextDefined:yr,isSpecCompliantForm:Oa,toJSONObject:Da,isAsyncFn:Fa,isThenable:Ma,setImmediate:wr,asap:Ia,isIterable:Ba};function A(t,e,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}b.inherits(A,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:b.toJSONObject(this.config),code:this.code,status:this.status}}});const jr=A.prototype,vr={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{vr[t]={value:t}});Object.defineProperties(A,vr);Object.defineProperty(jr,"isAxiosError",{value:!0});A.from=(t,e,r,n,a,o)=>{const i=Object.create(jr);return b.toFlatObject(t,i,function(c){return c!==Error.prototype},l=>l!=="isAxiosError"),A.call(i,t.message,e,r,n,a),i.cause=t,i.name=t.name,o&&Object.assign(i,o),i};const Ua=null;function Ot(t){return b.isPlainObject(t)||b.isArray(t)}function Nr(t){return b.endsWith(t,"[]")?t.slice(0,-2):t}function Es(t,e,r){return t?t.concat(e).map(function(a,o){return a=Nr(a),!r&&o?"["+a+"]":a}).join(r?".":""):e}function za(t){return b.isArray(t)&&!t.some(Ot)}const $a=b.toFlatObject(b,{},null,function(e){return/^is[A-Z]/.test(e)});function ut(t,e,r){if(!b.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,r=b.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,f){return!b.isUndefined(f[g])});const n=r.metaTokens,a=r.visitor||h,o=r.dots,i=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&b.isSpecCompliantForm(e);if(!b.isFunction(a))throw new TypeError("visitor must be a function");function d(p){if(p===null)return"";if(b.isDate(p))return p.toISOString();if(!c&&b.isBlob(p))throw new A("Blob is not supported. Use a Buffer instead.");return b.isArrayBuffer(p)||b.isTypedArray(p)?c&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function h(p,g,f){let y=p;if(p&&!f&&typeof p=="object"){if(b.endsWith(g,"{}"))g=n?g:g.slice(0,-2),p=JSON.stringify(p);else if(b.isArray(p)&&za(p)||(b.isFileList(p)||b.endsWith(g,"[]"))&&(y=b.toArray(p)))return g=Nr(g),y.forEach(function(N,v){!(b.isUndefined(N)||N===null)&&e.append(i===!0?Es([g],v,o):i===null?g:g+"[]",d(N))}),!1}return Ot(p)?!0:(e.append(Es(f,g,o),d(p)),!1)}const m=[],u=Object.assign($a,{defaultVisitor:h,convertValue:d,isVisitable:Ot});function w(p,g){if(!b.isUndefined(p)){if(m.indexOf(p)!==-1)throw Error("Circular reference detected in "+g.join("."));m.push(p),b.forEach(p,function(y,j){(!(b.isUndefined(y)||y===null)&&a.call(e,y,b.isString(j)?j.trim():j,g,u))===!0&&w(y,g?g.concat(j):[j])}),m.pop()}}if(!b.isObject(t))throw new TypeError("data must be an object");return w(t),e}function As(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function Zt(t,e){this._pairs=[],t&&ut(t,this,e)}const Sr=Zt.prototype;Sr.append=function(e,r){this._pairs.push([e,r])};Sr.toString=function(e){const r=e?function(n){return e.call(this,n,As)}:As;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function qa(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function kr(t,e,r){if(!e)return t;const n=r&&r.encode||qa;b.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let o;if(a?o=a(e,r):o=b.isURLSearchParams(e)?e.toString():new Zt(e,r).toString(n),o){const i=t.indexOf("#");i!==-1&&(t=t.slice(0,i)),t+=(t.indexOf("?")===-1?"?":"&")+o}return t}class _s{constructor(){this.handlers=[]}use(e,r,n){return this.handlers.push({fulfilled:e,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){b.forEach(this.handlers,function(n){n!==null&&e(n)})}}const Cr={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Wa=typeof URLSearchParams<"u"?URLSearchParams:Zt,Ga=typeof FormData<"u"?FormData:null,Ha=typeof Blob<"u"?Blob:null,Va={isBrowser:!0,classes:{URLSearchParams:Wa,FormData:Ga,Blob:Ha},protocols:["http","https","file","blob","url","data"]},es=typeof window<"u"&&typeof document<"u",Dt=typeof navigator=="object"&&navigator||void 0,Ja=es&&(!Dt||["ReactNative","NativeScript","NS"].indexOf(Dt.product)<0),Ya=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Ka=es&&window.location.href||"http://localhost",Xa=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:es,hasStandardBrowserEnv:Ja,hasStandardBrowserWebWorkerEnv:Ya,navigator:Dt,origin:Ka},Symbol.toStringTag,{value:"Module"})),z={...Xa,...Va};function Qa(t,e){return ut(t,new z.classes.URLSearchParams,Object.assign({visitor:function(r,n,a,o){return z.isNode&&b.isBuffer(r)?(this.append(n,r.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},e))}function Za(t){return b.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function eo(t){const e={},r=Object.keys(t);let n;const a=r.length;let o;for(n=0;n<a;n++)o=r[n],e[o]=t[o];return e}function Er(t){function e(r,n,a,o){let i=r[o++];if(i==="__proto__")return!0;const l=Number.isFinite(+i),c=o>=r.length;return i=!i&&b.isArray(a)?a.length:i,c?(b.hasOwnProp(a,i)?a[i]=[a[i],n]:a[i]=n,!l):((!a[i]||!b.isObject(a[i]))&&(a[i]=[]),e(r,n,a[i],o)&&b.isArray(a[i])&&(a[i]=eo(a[i])),!l)}if(b.isFormData(t)&&b.isFunction(t.entries)){const r={};return b.forEachEntry(t,(n,a)=>{e(Za(n),a,r,0)}),r}return null}function to(t,e,r){if(b.isString(t))try{return(e||JSON.parse)(t),b.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(t)}const $e={transitional:Cr,adapter:["xhr","http","fetch"],transformRequest:[function(e,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,o=b.isObject(e);if(o&&b.isHTMLForm(e)&&(e=new FormData(e)),b.isFormData(e))return a?JSON.stringify(Er(e)):e;if(b.isArrayBuffer(e)||b.isBuffer(e)||b.isStream(e)||b.isFile(e)||b.isBlob(e)||b.isReadableStream(e))return e;if(b.isArrayBufferView(e))return e.buffer;if(b.isURLSearchParams(e))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(o){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Qa(e,this.formSerializer).toString();if((l=b.isFileList(e))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return ut(l?{"files[]":e}:e,c&&new c,this.formSerializer)}}return o||a?(r.setContentType("application/json",!1),to(e)):e}],transformResponse:[function(e){const r=this.transitional||$e.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(b.isResponse(e)||b.isReadableStream(e))return e;if(e&&b.isString(e)&&(n&&!this.responseType||a)){const i=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(e)}catch(l){if(i)throw l.name==="SyntaxError"?A.from(l,A.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:z.classes.FormData,Blob:z.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};b.forEach(["delete","get","head","post","put","patch"],t=>{$e.headers[t]={}});const so=b.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ro=t=>{const e={};let r,n,a;return t&&t.split(`
`).forEach(function(i){a=i.indexOf(":"),r=i.substring(0,a).trim().toLowerCase(),n=i.substring(a+1).trim(),!(!r||e[r]&&so[r])&&(r==="set-cookie"?e[r]?e[r].push(n):e[r]=[n]:e[r]=e[r]?e[r]+", "+n:n)}),e},Rs=Symbol("internals");function Ae(t){return t&&String(t).trim().toLowerCase()}function Je(t){return t===!1||t==null?t:b.isArray(t)?t.map(Je):String(t)}function no(t){const e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(t);)e[n[1]]=n[2];return e}const ao=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function kt(t,e,r,n,a){if(b.isFunction(n))return n.call(this,e,r);if(a&&(e=r),!!b.isString(e)){if(b.isString(n))return e.indexOf(n)!==-1;if(b.isRegExp(n))return n.test(e)}}function oo(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,r,n)=>r.toUpperCase()+n)}function io(t,e){const r=b.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+r,{value:function(a,o,i){return this[n].call(this,e,a,o,i)},configurable:!0})})}let G=class{constructor(e){e&&this.set(e)}set(e,r,n){const a=this;function o(l,c,d){const h=Ae(c);if(!h)throw new Error("header name must be a non-empty string");const m=b.findKey(a,h);(!m||a[m]===void 0||d===!0||d===void 0&&a[m]!==!1)&&(a[m||c]=Je(l))}const i=(l,c)=>b.forEach(l,(d,h)=>o(d,h,c));if(b.isPlainObject(e)||e instanceof this.constructor)i(e,r);else if(b.isString(e)&&(e=e.trim())&&!ao(e))i(ro(e),r);else if(b.isObject(e)&&b.isIterable(e)){let l={},c,d;for(const h of e){if(!b.isArray(h))throw TypeError("Object iterator must return a key-value pair");l[d=h[0]]=(c=l[d])?b.isArray(c)?[...c,h[1]]:[c,h[1]]:h[1]}i(l,r)}else e!=null&&o(r,e,n);return this}get(e,r){if(e=Ae(e),e){const n=b.findKey(this,e);if(n){const a=this[n];if(!r)return a;if(r===!0)return no(a);if(b.isFunction(r))return r.call(this,a,n);if(b.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,r){if(e=Ae(e),e){const n=b.findKey(this,e);return!!(n&&this[n]!==void 0&&(!r||kt(this,this[n],n,r)))}return!1}delete(e,r){const n=this;let a=!1;function o(i){if(i=Ae(i),i){const l=b.findKey(n,i);l&&(!r||kt(n,n[l],l,r))&&(delete n[l],a=!0)}}return b.isArray(e)?e.forEach(o):o(e),a}clear(e){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const o=r[n];(!e||kt(this,this[o],o,e,!0))&&(delete this[o],a=!0)}return a}normalize(e){const r=this,n={};return b.forEach(this,(a,o)=>{const i=b.findKey(n,o);if(i){r[i]=Je(a),delete r[o];return}const l=e?oo(o):String(o).trim();l!==o&&delete r[o],r[l]=Je(a),n[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const r=Object.create(null);return b.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=e&&b.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,r])=>e+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...r){const n=new this(e);return r.forEach(a=>n.set(a)),n}static accessor(e){const n=(this[Rs]=this[Rs]={accessors:{}}).accessors,a=this.prototype;function o(i){const l=Ae(i);n[l]||(io(a,i),n[l]=!0)}return b.isArray(e)?e.forEach(o):o(e),this}};G.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);b.reduceDescriptors(G.prototype,({value:t},e)=>{let r=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(n){this[r]=n}}});b.freezeMethods(G);function Ct(t,e){const r=this||$e,n=e||r,a=G.from(n.headers);let o=n.data;return b.forEach(t,function(l){o=l.call(r,o,a.normalize(),e?e.status:void 0)}),a.normalize(),o}function Ar(t){return!!(t&&t.__CANCEL__)}function ke(t,e,r){A.call(this,t??"canceled",A.ERR_CANCELED,e,r),this.name="CanceledError"}b.inherits(ke,A,{__CANCEL__:!0});function _r(t,e,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?t(r):e(new A("Request failed with status code "+r.status,[A.ERR_BAD_REQUEST,A.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function lo(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function co(t,e){t=t||10;const r=new Array(t),n=new Array(t);let a=0,o=0,i;return e=e!==void 0?e:1e3,function(c){const d=Date.now(),h=n[o];i||(i=d),r[a]=c,n[a]=d;let m=o,u=0;for(;m!==a;)u+=r[m++],m=m%t;if(a=(a+1)%t,a===o&&(o=(o+1)%t),d-i<e)return;const w=h&&d-h;return w?Math.round(u*1e3/w):void 0}}function uo(t,e){let r=0,n=1e3/e,a,o;const i=(d,h=Date.now())=>{r=h,a=null,o&&(clearTimeout(o),o=null),t.apply(null,d)};return[(...d)=>{const h=Date.now(),m=h-r;m>=n?i(d,h):(a=d,o||(o=setTimeout(()=>{o=null,i(a)},n-m)))},()=>a&&i(a)]}const rt=(t,e,r=3)=>{let n=0;const a=co(50,250);return uo(o=>{const i=o.loaded,l=o.lengthComputable?o.total:void 0,c=i-n,d=a(c),h=i<=l;n=i;const m={loaded:i,total:l,progress:l?i/l:void 0,bytes:c,rate:d||void 0,estimated:d&&l&&h?(l-i)/d:void 0,event:o,lengthComputable:l!=null,[e?"download":"upload"]:!0};t(m)},r)},Ts=(t,e)=>{const r=t!=null;return[n=>e[0]({lengthComputable:r,total:t,loaded:n}),e[1]]},Ps=t=>(...e)=>b.asap(()=>t(...e)),ho=z.hasStandardBrowserEnv?((t,e)=>r=>(r=new URL(r,z.origin),t.protocol===r.protocol&&t.host===r.host&&(e||t.port===r.port)))(new URL(z.origin),z.navigator&&/(msie|trident)/i.test(z.navigator.userAgent)):()=>!0,mo=z.hasStandardBrowserEnv?{write(t,e,r,n,a,o){const i=[t+"="+encodeURIComponent(e)];b.isNumber(r)&&i.push("expires="+new Date(r).toGMTString()),b.isString(n)&&i.push("path="+n),b.isString(a)&&i.push("domain="+a),o===!0&&i.push("secure"),document.cookie=i.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function fo(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function po(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function Rr(t,e,r){let n=!fo(e);return t&&(n||r==!1)?po(t,e):e}const Ls=t=>t instanceof G?{...t}:t;function je(t,e){e=e||{};const r={};function n(d,h,m,u){return b.isPlainObject(d)&&b.isPlainObject(h)?b.merge.call({caseless:u},d,h):b.isPlainObject(h)?b.merge({},h):b.isArray(h)?h.slice():h}function a(d,h,m,u){if(b.isUndefined(h)){if(!b.isUndefined(d))return n(void 0,d,m,u)}else return n(d,h,m,u)}function o(d,h){if(!b.isUndefined(h))return n(void 0,h)}function i(d,h){if(b.isUndefined(h)){if(!b.isUndefined(d))return n(void 0,d)}else return n(void 0,h)}function l(d,h,m){if(m in e)return n(d,h);if(m in t)return n(void 0,d)}const c={url:o,method:o,data:o,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:l,headers:(d,h,m)=>a(Ls(d),Ls(h),m,!0)};return b.forEach(Object.keys(Object.assign({},t,e)),function(h){const m=c[h]||a,u=m(t[h],e[h],h);b.isUndefined(u)&&m!==l||(r[h]=u)}),r}const Tr=t=>{const e=je({},t);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:o,headers:i,auth:l}=e;e.headers=i=G.from(i),e.url=kr(Rr(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),l&&i.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):"")));let c;if(b.isFormData(r)){if(z.hasStandardBrowserEnv||z.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((c=i.getContentType())!==!1){const[d,...h]=c?c.split(";").map(m=>m.trim()).filter(Boolean):[];i.setContentType([d||"multipart/form-data",...h].join("; "))}}if(z.hasStandardBrowserEnv&&(n&&b.isFunction(n)&&(n=n(e)),n||n!==!1&&ho(e.url))){const d=a&&o&&mo.read(o);d&&i.set(a,d)}return e},go=typeof XMLHttpRequest<"u",xo=go&&function(t){return new Promise(function(r,n){const a=Tr(t);let o=a.data;const i=G.from(a.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:d}=a,h,m,u,w,p;function g(){w&&w(),p&&p(),a.cancelToken&&a.cancelToken.unsubscribe(h),a.signal&&a.signal.removeEventListener("abort",h)}let f=new XMLHttpRequest;f.open(a.method.toUpperCase(),a.url,!0),f.timeout=a.timeout;function y(){if(!f)return;const N=G.from("getAllResponseHeaders"in f&&f.getAllResponseHeaders()),C={data:!l||l==="text"||l==="json"?f.responseText:f.response,status:f.status,statusText:f.statusText,headers:N,config:t,request:f};_r(function(S){r(S),g()},function(S){n(S),g()},C),f=null}"onloadend"in f?f.onloadend=y:f.onreadystatechange=function(){!f||f.readyState!==4||f.status===0&&!(f.responseURL&&f.responseURL.indexOf("file:")===0)||setTimeout(y)},f.onabort=function(){f&&(n(new A("Request aborted",A.ECONNABORTED,t,f)),f=null)},f.onerror=function(){n(new A("Network Error",A.ERR_NETWORK,t,f)),f=null},f.ontimeout=function(){let v=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const C=a.transitional||Cr;a.timeoutErrorMessage&&(v=a.timeoutErrorMessage),n(new A(v,C.clarifyTimeoutError?A.ETIMEDOUT:A.ECONNABORTED,t,f)),f=null},o===void 0&&i.setContentType(null),"setRequestHeader"in f&&b.forEach(i.toJSON(),function(v,C){f.setRequestHeader(C,v)}),b.isUndefined(a.withCredentials)||(f.withCredentials=!!a.withCredentials),l&&l!=="json"&&(f.responseType=a.responseType),d&&([u,p]=rt(d,!0),f.addEventListener("progress",u)),c&&f.upload&&([m,w]=rt(c),f.upload.addEventListener("progress",m),f.upload.addEventListener("loadend",w)),(a.cancelToken||a.signal)&&(h=N=>{f&&(n(!N||N.type?new ke(null,t,f):N),f.abort(),f=null)},a.cancelToken&&a.cancelToken.subscribe(h),a.signal&&(a.signal.aborted?h():a.signal.addEventListener("abort",h)));const j=lo(a.url);if(j&&z.protocols.indexOf(j)===-1){n(new A("Unsupported protocol "+j+":",A.ERR_BAD_REQUEST,t));return}f.send(o||null)})},yo=(t,e)=>{const{length:r}=t=t?t.filter(Boolean):[];if(e||r){let n=new AbortController,a;const o=function(d){if(!a){a=!0,l();const h=d instanceof Error?d:this.reason;n.abort(h instanceof A?h:new ke(h instanceof Error?h.message:h))}};let i=e&&setTimeout(()=>{i=null,o(new A(`timeout ${e} of ms exceeded`,A.ETIMEDOUT))},e);const l=()=>{t&&(i&&clearTimeout(i),i=null,t.forEach(d=>{d.unsubscribe?d.unsubscribe(o):d.removeEventListener("abort",o)}),t=null)};t.forEach(d=>d.addEventListener("abort",o));const{signal:c}=n;return c.unsubscribe=()=>b.asap(l),c}},bo=function*(t,e){let r=t.byteLength;if(r<e){yield t;return}let n=0,a;for(;n<r;)a=n+e,yield t.slice(n,a),n=a},wo=async function*(t,e){for await(const r of jo(t))yield*bo(r,e)},jo=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:r,value:n}=await e.read();if(r)break;yield n}}finally{await e.cancel()}},Os=(t,e,r,n)=>{const a=wo(t,e);let o=0,i,l=c=>{i||(i=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:d,value:h}=await a.next();if(d){l(),c.close();return}let m=h.byteLength;if(r){let u=o+=m;r(u)}c.enqueue(new Uint8Array(h))}catch(d){throw l(d),d}},cancel(c){return l(c),a.return()}},{highWaterMark:2})},ht=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Pr=ht&&typeof ReadableStream=="function",vo=ht&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),Lr=(t,...e)=>{try{return!!t(...e)}catch{return!1}},No=Pr&&Lr(()=>{let t=!1;const e=new Request(z.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),Ds=64*1024,Ft=Pr&&Lr(()=>b.isReadableStream(new Response("").body)),nt={stream:Ft&&(t=>t.body)};ht&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!nt[e]&&(nt[e]=b.isFunction(t[e])?r=>r[e]():(r,n)=>{throw new A(`Response type '${e}' is not supported`,A.ERR_NOT_SUPPORT,n)})})})(new Response);const So=async t=>{if(t==null)return 0;if(b.isBlob(t))return t.size;if(b.isSpecCompliantForm(t))return(await new Request(z.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(b.isArrayBufferView(t)||b.isArrayBuffer(t))return t.byteLength;if(b.isURLSearchParams(t)&&(t=t+""),b.isString(t))return(await vo(t)).byteLength},ko=async(t,e)=>{const r=b.toFiniteNumber(t.getContentLength());return r??So(e)},Co=ht&&(async t=>{let{url:e,method:r,data:n,signal:a,cancelToken:o,timeout:i,onDownloadProgress:l,onUploadProgress:c,responseType:d,headers:h,withCredentials:m="same-origin",fetchOptions:u}=Tr(t);d=d?(d+"").toLowerCase():"text";let w=yo([a,o&&o.toAbortSignal()],i),p;const g=w&&w.unsubscribe&&(()=>{w.unsubscribe()});let f;try{if(c&&No&&r!=="get"&&r!=="head"&&(f=await ko(h,n))!==0){let C=new Request(e,{method:"POST",body:n,duplex:"half"}),_;if(b.isFormData(n)&&(_=C.headers.get("content-type"))&&h.setContentType(_),C.body){const[S,L]=Ts(f,rt(Ps(c)));n=Os(C.body,Ds,S,L)}}b.isString(m)||(m=m?"include":"omit");const y="credentials"in Request.prototype;p=new Request(e,{...u,signal:w,method:r.toUpperCase(),headers:h.normalize().toJSON(),body:n,duplex:"half",credentials:y?m:void 0});let j=await fetch(p);const N=Ft&&(d==="stream"||d==="response");if(Ft&&(l||N&&g)){const C={};["status","statusText","headers"].forEach(U=>{C[U]=j[U]});const _=b.toFiniteNumber(j.headers.get("content-length")),[S,L]=l&&Ts(_,rt(Ps(l),!0))||[];j=new Response(Os(j.body,Ds,S,()=>{L&&L(),g&&g()}),C)}d=d||"text";let v=await nt[b.findKey(nt,d)||"text"](j,t);return!N&&g&&g(),await new Promise((C,_)=>{_r(C,_,{data:v,headers:G.from(j.headers),status:j.status,statusText:j.statusText,config:t,request:p})})}catch(y){throw g&&g(),y&&y.name==="TypeError"&&/Load failed|fetch/i.test(y.message)?Object.assign(new A("Network Error",A.ERR_NETWORK,t,p),{cause:y.cause||y}):A.from(y,y&&y.code,t,p)}}),Mt={http:Ua,xhr:xo,fetch:Co};b.forEach(Mt,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const Fs=t=>`- ${t}`,Eo=t=>b.isFunction(t)||t===null||t===!1,Or={getAdapter:t=>{t=b.isArray(t)?t:[t];const{length:e}=t;let r,n;const a={};for(let o=0;o<e;o++){r=t[o];let i;if(n=r,!Eo(r)&&(n=Mt[(i=String(r)).toLowerCase()],n===void 0))throw new A(`Unknown adapter '${i}'`);if(n)break;a[i||"#"+o]=n}if(!n){const o=Object.entries(a).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let i=e?o.length>1?`since :
`+o.map(Fs).join(`
`):" "+Fs(o[0]):"as no adapter specified";throw new A("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return n},adapters:Mt};function Et(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new ke(null,t)}function Ms(t){return Et(t),t.headers=G.from(t.headers),t.data=Ct.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Or.getAdapter(t.adapter||$e.adapter)(t).then(function(n){return Et(t),n.data=Ct.call(t,t.transformResponse,n),n.headers=G.from(n.headers),n},function(n){return Ar(n)||(Et(t),n&&n.response&&(n.response.data=Ct.call(t,t.transformResponse,n.response),n.response.headers=G.from(n.response.headers))),Promise.reject(n)})}const Dr="1.9.0",mt={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{mt[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const Is={};mt.transitional=function(e,r,n){function a(o,i){return"[Axios v"+Dr+"] Transitional option '"+o+"'"+i+(n?". "+n:"")}return(o,i,l)=>{if(e===!1)throw new A(a(i," has been removed"+(r?" in "+r:"")),A.ERR_DEPRECATED);return r&&!Is[i]&&(Is[i]=!0,console.warn(a(i," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(o,i,l):!0}};mt.spelling=function(e){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function Ao(t,e,r){if(typeof t!="object")throw new A("options must be an object",A.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let a=n.length;for(;a-- >0;){const o=n[a],i=e[o];if(i){const l=t[o],c=l===void 0||i(l,o,t);if(c!==!0)throw new A("option "+o+" must be "+c,A.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new A("Unknown option "+o,A.ERR_BAD_OPTION)}}const Ye={assertOptions:Ao,validators:mt},te=Ye.validators;let xe=class{constructor(e){this.defaults=e||{},this.interceptors={request:new _s,response:new _s}}async request(e,r){try{return await this._request(e,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const o=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?o&&!String(n.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+o):n.stack=o}catch{}}throw n}}_request(e,r){typeof e=="string"?(r=r||{},r.url=e):r=e||{},r=je(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:o}=r;n!==void 0&&Ye.assertOptions(n,{silentJSONParsing:te.transitional(te.boolean),forcedJSONParsing:te.transitional(te.boolean),clarifyTimeoutError:te.transitional(te.boolean)},!1),a!=null&&(b.isFunction(a)?r.paramsSerializer={serialize:a}:Ye.assertOptions(a,{encode:te.function,serialize:te.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Ye.assertOptions(r,{baseUrl:te.spelling("baseURL"),withXsrfToken:te.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=o&&b.merge(o.common,o[r.method]);o&&b.forEach(["delete","get","head","post","put","patch","common"],p=>{delete o[p]}),r.headers=G.concat(i,o);const l=[];let c=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(r)===!1||(c=c&&g.synchronous,l.unshift(g.fulfilled,g.rejected))});const d=[];this.interceptors.response.forEach(function(g){d.push(g.fulfilled,g.rejected)});let h,m=0,u;if(!c){const p=[Ms.bind(this),void 0];for(p.unshift.apply(p,l),p.push.apply(p,d),u=p.length,h=Promise.resolve(r);m<u;)h=h.then(p[m++],p[m++]);return h}u=l.length;let w=r;for(m=0;m<u;){const p=l[m++],g=l[m++];try{w=p(w)}catch(f){g.call(this,f);break}}try{h=Ms.call(this,w)}catch(p){return Promise.reject(p)}for(m=0,u=d.length;m<u;)h=h.then(d[m++],d[m++]);return h}getUri(e){e=je(this.defaults,e);const r=Rr(e.baseURL,e.url,e.allowAbsoluteUrls);return kr(r,e.params,e.paramsSerializer)}};b.forEach(["delete","get","head","options"],function(e){xe.prototype[e]=function(r,n){return this.request(je(n||{},{method:e,url:r,data:(n||{}).data}))}});b.forEach(["post","put","patch"],function(e){function r(n){return function(o,i,l){return this.request(je(l||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:o,data:i}))}}xe.prototype[e]=r(),xe.prototype[e+"Form"]=r(!0)});let _o=class Fr{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(o){r=o});const n=this;this.promise.then(a=>{if(!n._listeners)return;let o=n._listeners.length;for(;o-- >0;)n._listeners[o](a);n._listeners=null}),this.promise.then=a=>{let o;const i=new Promise(l=>{n.subscribe(l),o=l}).then(a);return i.cancel=function(){n.unsubscribe(o)},i},e(function(o,i,l){n.reason||(n.reason=new ke(o,i,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const r=this._listeners.indexOf(e);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const e=new AbortController,r=n=>{e.abort(n)};return this.subscribe(r),e.signal.unsubscribe=()=>this.unsubscribe(r),e.signal}static source(){let e;return{token:new Fr(function(a){e=a}),cancel:e}}};function Ro(t){return function(r){return t.apply(null,r)}}function To(t){return b.isObject(t)&&t.isAxiosError===!0}const It={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(It).forEach(([t,e])=>{It[e]=t});function Mr(t){const e=new xe(t),r=mr(xe.prototype.request,e);return b.extend(r,xe.prototype,e,{allOwnKeys:!0}),b.extend(r,e,null,{allOwnKeys:!0}),r.create=function(a){return Mr(je(t,a))},r}const O=Mr($e);O.Axios=xe;O.CanceledError=ke;O.CancelToken=_o;O.isCancel=Ar;O.VERSION=Dr;O.toFormData=ut;O.AxiosError=A;O.Cancel=O.CanceledError;O.all=function(e){return Promise.all(e)};O.spread=Ro;O.isAxiosError=To;O.mergeConfig=je;O.AxiosHeaders=G;O.formToJSON=t=>Er(b.isHTMLForm(t)?new FormData(t):t);O.getAdapter=Or.getAdapter;O.HttpStatusCode=It;O.default=O;const{Axios:pc,AxiosError:gc,CanceledError:xc,isCancel:yc,CancelToken:bc,VERSION:wc,all:jc,Cancel:vc,isAxiosError:Nc,spread:Sc,toFormData:kc,AxiosHeaders:Cc,HttpStatusCode:Ec,formToJSON:Ac,getAdapter:_c,mergeConfig:Rc}=O,Po="http://localhost:5000/api",P=O.create({baseURL:Po,timeout:3e4,headers:{"Content-Type":"application/json"}});let Bt=null;const pe=t=>{Bt=t,t?(P.defaults.headers.authorization=`Bearer ${t}`,localStorage.setItem("access_token",t)):(delete P.defaults.headers.authorization,localStorage.removeItem("access_token"))},Bs=localStorage.getItem("access_token");Bs&&pe(Bs);P.interceptors.request.use(t=>(Bt&&(t.headers.authorization=`Bearer ${Bt}`),t),t=>(console.error("âŒ Request Error:",t),Promise.reject(t)));P.interceptors.response.use(t=>t,t=>{var e;return console.error("âŒ Response Error:",t),((e=t.response)==null?void 0:e.status)===401&&(pe(null),window.dispatchEvent(new CustomEvent("auth:logout"))),t.response||console.error("âŒ Network Error - Server might be down"),Promise.reject(t)});const Ir=t=>{var e;return t.response?{status:t.response.status,code:(e=t.response.data)==null?void 0:e.code}:t.request?{status:0}:{}},I=async t=>{try{const e=await t();if(!e.data.success)throw new Error(e.data.message||"API call failed");return e.data.data}catch(e){const r=Ir(e);throw new Error(r.code)}};class q{static async getGigs(e={}){const r=new URLSearchParams;return Object.entries(e).forEach(([n,a])=>{a!=null&&(Array.isArray(a)?a.forEach(o=>r.append(n,o.toString())):r.append(n,a.toString()))}),await I(()=>P.get(`/gigs?${r.toString()}`))}static async getGigById(e){return await I(()=>P.get(`/gigs/${e}`))}static async createGig(e){return await I(()=>P.post("/gigs",e))}static async updateGig(e,r){return await I(()=>P.put(`/gigs/${e}`,r))}static async deleteGig(e){return await I(()=>P.delete(`/gigs/${e}`))}static async searchGigs(e,r,n){const a=new URLSearchParams({search:e});return r!==void 0&&n!==void 0&&(a.append("lat",r.toString()),a.append("lng",n.toString())),await I(()=>P.get(`/gigs?${a.toString()}`))}static async applyToGig(e,r){return await I(()=>P.post(`/gigs/${e}/apply`,r))}static async acceptApplication(e,r){return await I(()=>P.put(`/gigs/${e}/applications/${r}/accept`))}static async getUserPostedGigs(e={}){const r=new URLSearchParams;return Object.entries(e).forEach(([n,a])=>{a!=null&&r.append(n,a.toString())}),await I(()=>P.get(`/gigs/user/posted?${r.toString()}`))}static async getUserApplications(e={}){const r=new URLSearchParams;Object.entries(e).forEach(([n,a])=>{a!=null&&r.append(n,a.toString())});try{return(await P.get(`/gigs/user/applications?${r.toString()}`)).data}catch(n){const a=Ir(n);throw new Error(a.code||"Failed to fetch user applications")}}static async getGigApplications(e,r={}){const n=new URLSearchParams;return Object.entries(r).forEach(([a,o])=>{o!=null&&n.append(a,o.toString())}),await I(()=>P.get(`/applications/gig/${e}?${n.toString()}`))}static async rejectApplication(e,r){return await I(()=>P.put(`/gigs/${e}/applications/${r}/reject`))}}const ft=Xt()(ea((t,e)=>({gigs:[],selectedGig:null,userPostedGigs:[],userApplications:[],loading:!1,error:null,searchQuery:"",userLocation:null,pagination:{page:1,limit:20,total:0,pages:0},fetchGigs:async r=>{try{t({loading:!0,error:null});const{userLocation:n}=e(),a={...r,...n&&{lat:n.lat,lng:n.lng}},o=await q.getGigs(a);t({gigs:o.gigs,pagination:o.pagination,loading:!1})}catch(n){t({error:n.message,loading:!1,gigs:[]})}},fetchGigById:async r=>{try{t({loading:!0,error:null});const n=await q.getGigById(r);t({selectedGig:n.gig,loading:!1})}catch(n){t({error:n.message,loading:!1,selectedGig:null})}},createGig:async r=>{try{t({loading:!0,error:null});const n=await q.createGig(r),{gigs:a}=e();return t({gigs:[n.gig,...a],loading:!1}),n.gig}catch(n){throw t({error:n.message,loading:!1}),n}},updateGig:async(r,n)=>{try{t({loading:!0,error:null});const a=await q.updateGig(r,n),{gigs:o,selectedGig:i}=e(),l=o.map(c=>c._id===r?a.gig:c);t({gigs:l,selectedGig:(i==null?void 0:i._id)===r?a.gig:i,loading:!1})}catch(a){throw t({error:a.message,loading:!1}),a}},deleteGig:async r=>{try{t({loading:!0,error:null}),await q.deleteGig(r);const{gigs:n,selectedGig:a}=e(),o=n.filter(i=>i._id!==r);t({gigs:o,selectedGig:(a==null?void 0:a._id)===r?null:a,loading:!1})}catch(n){throw t({error:n.message,loading:!1}),n}},applyToGig:async(r,n)=>{try{t({loading:!0,error:null});const a=await q.applyToGig(r,n),{gigs:o,selectedGig:i}=e(),l=o.map(c=>c._id===r?a.gig:c);t({gigs:l,selectedGig:(i==null?void 0:i._id)===r?a.gig:i,loading:!1})}catch(a){throw t({error:a.message,loading:!1}),a}},acceptApplication:async(r,n)=>{try{t({loading:!0,error:null});const a=await q.acceptApplication(r,n),{gigs:o,selectedGig:i,userPostedGigs:l}=e(),c=o.map(h=>h._id===r?a.gig:h),d=l.map(h=>h._id===r?a.gig:h);t({gigs:c,userPostedGigs:d,selectedGig:(i==null?void 0:i._id)===r?a.gig:i,loading:!1})}catch(a){throw t({error:a.message,loading:!1}),a}},fetchUserPostedGigs:async()=>{try{t({loading:!0,error:null});const r=await q.getUserPostedGigs();t({userPostedGigs:r.gigs,loading:!1})}catch(r){t({error:r.message,loading:!1,userPostedGigs:[]})}},fetchUserApplications:async()=>{var r;try{t({loading:!0,error:null});const n=await q.getUserApplications();t({userApplications:((r=n.data)==null?void 0:r.applications)||[],loading:!1})}catch(n){t({error:n.message,loading:!1,userApplications:[]})}},searchGigs:async r=>{try{t({loading:!0,error:null,searchQuery:r});const{userLocation:n}=e(),a=await q.searchGigs(r,n==null?void 0:n.lat,n==null?void 0:n.lng);t({gigs:a.gigs,loading:!1})}catch(n){t({error:n.message,loading:!1,gigs:[]})}},setUserLocation:r=>{t({userLocation:r})},setSelectedGig:r=>{t({selectedGig:r})},clearError:()=>{t({error:null})}})));class re{static async login(e){const r=await I(()=>P.post("/auth/login",e));return pe(r.accessToken),localStorage.setItem("refresh_token",r.refreshToken),r}static async adminLogin(e){const r=await I(()=>P.post("/admin/login",e));return pe(r.accessToken),localStorage.setItem("refresh_token",r.refreshToken),r}static async register(e){const r=await I(()=>P.post("/auth/register",e));return pe(r.accessToken),localStorage.setItem("refresh_token",r.refreshToken),r}static async getProfile(){return await I(()=>P.get("/auth/me"))}static async refreshToken(){const e=localStorage.getItem("refresh_token");if(!e)throw new Error("No refresh token available");const r=await I(()=>P.post("/auth/refresh",{refreshToken:e}));return pe(r.accessToken),localStorage.setItem("refresh_token",r.refreshToken),r}static async logout(){const e=localStorage.getItem("refresh_token");try{e&&await I(()=>P.post("/auth/logout",{refreshToken:e}))}catch(r){console.warn("Logout error:",r)}finally{localStorage.removeItem("refresh_token"),pe(null)}}static getToken(){return localStorage.getItem("access_token")}static isAuthenticated(){const e=this.getToken();if(!e)return!1;try{return JSON.parse(atob(e.split(".")[1])).exp*1e3>Date.now()}catch{return!1}}static async isAdmin(){try{if(!this.isAuthenticated())return!1;const{user:e}=await this.getProfile();return e.role==="admin"}catch{return!1}}}const Br=x.createContext({isAuthenticated:!1,user:null,accessToken:null,refreshToken:null,login:async()=>{},signup:async()=>{},logout:async()=>{},verifyOTP:async()=>{},refreshAuth:async()=>{},updateUser:()=>{},isLoading:!1,error:null,isInitialized:!1}),he=()=>{const t=x.useContext(Br);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},Lo=({children:t})=>{const[e,r]=x.useState({isAuthenticated:!1,user:null,accessToken:re.getToken(),refreshToken:localStorage.getItem("refresh_token")}),[n,a]=x.useState(!1),[o,i]=x.useState(!1),[l,c]=x.useState(null),d=x.useCallback(async(f,y)=>{try{i(!0),c(null);const j=await re.login({email:f,password:y});localStorage.setItem("user",JSON.stringify(j.user)),r({isAuthenticated:!0,user:j.user,accessToken:j.accessToken,refreshToken:j.refreshToken})}finally{i(!1)}},[]),h=x.useCallback(async f=>{try{i(!0),c(null);const y=await re.register(f);localStorage.setItem("user",JSON.stringify(y.user)),r({isAuthenticated:!0,user:y.user,accessToken:y.accessToken,refreshToken:y.refreshToken})}finally{i(!1)}},[]),m=x.useCallback(async()=>{try{await re.logout()}catch{console.warn("Logout API call failed, but continuing with local cleanup")}finally{localStorage.removeItem("user"),r({isAuthenticated:!1,user:null,accessToken:null,refreshToken:null})}},[]),u=x.useCallback(async f=>{console.log("OTP verification disabled")},[]),w=x.useCallback(async()=>{try{const f=await re.refreshToken();r(y=>({...y,accessToken:f.accessToken,refreshToken:f.refreshToken}))}catch{await m()}},[m]),p=x.useCallback(f=>{r(y=>{if(!y.user)return y;const j={...y.user,...f};return localStorage.setItem("user",JSON.stringify(j)),{...y,user:j}})},[]);x.useEffect(()=>{(()=>{const y=re.getToken(),j=localStorage.getItem("refresh_token"),N=localStorage.getItem("user");let v=null;if(N)try{v=JSON.parse(N)}catch{v=null}r(y&&v?{isAuthenticated:!0,user:v,accessToken:y,refreshToken:j}:{isAuthenticated:!1,user:null,accessToken:null,refreshToken:null}),a(!0)})()},[]),x.useEffect(()=>{if(e.accessToken&&n){const f=setInterval(()=>{w()},84e4);return()=>clearInterval(f)}},[e.accessToken,w,n]),x.useEffect(()=>{const f=()=>{m()};return window.addEventListener("auth:logout",f),()=>window.removeEventListener("auth:logout",f)},[m]);const g=l?Vt.createPortal(s.jsx("div",{className:"fixed top-4 right-4 bg-red-500 text-white px-4 py-2 rounded shadow-lg z-50",children:l}),document.body):null;return s.jsxs(Br.Provider,{value:{...e,login:d,signup:h,logout:m,verifyOTP:u,refreshAuth:w,updateUser:p,isLoading:o,error:l,isInitialized:n},children:[t,g]})},Oo=({gig:t,onApply:e,onClose:r})=>{const{applyToGig:n,loading:a}=ft(),{user:o,isAuthenticated:i}=he(),[l,c]=x.useState({message:"",proposedRate:t.payment.rate,estimatedDuration:t.timeline.duration||1}),[d,h]=x.useState(!1),[m,u]=x.useState(null),[w,p]=x.useState(!1),g=t.applications.some(S=>(typeof S.applicantId=="string"?S.applicantId:S.applicantId._id)===(o==null?void 0:o.id)),y=(typeof t.posterId=="string"?t.posterId:t.posterId._id)===(o==null?void 0:o.id),j=()=>{if(!i){u("Please login to apply for this gig");return}if(y){u("You cannot apply to your own gig");return}if(g){u("You have already applied to this gig");return}h(!0)},N=async()=>{u(null);try{await n(t._id,{message:l.message,proposedRate:l.proposedRate,estimatedDuration:l.estimatedDuration}),p(!0),h(!1),e==null||e()}catch(S){u(S.message||"Failed to apply to gig")}},v=S=>new Intl.NumberFormat("en-IN",{style:"currency",currency:t.payment.currency||"INR"}).format(S),C=S=>new Date(S).toLocaleDateString("en-IN"),_=S=>{switch(S){case"urgent":return"text-red-600 bg-red-100";case"high":return"text-orange-600 bg-orange-100";case"medium":return"text-yellow-600 bg-yellow-100";case"low":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}};return w?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"text-green-600 text-6xl mb-4",children:"âœ“"}),s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Application Submitted!"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Your application has been sent to the gig poster. They will review it and get back to you."}),s.jsx("button",{onClick:r,className:"bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600",children:"Close"})]}):s.jsxs("div",{className:"space-y-6 max-h-[80vh] overflow-y-auto",children:[m&&s.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:m}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 flex-1",children:t.title}),s.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${_(t.urgency)}`,children:t.urgency.charAt(0).toUpperCase()+t.urgency.slice(1)})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-600",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(Jt,{size:16,className:"mr-1 text-green-600"}),s.jsxs("span",{className:"font-semibold text-green-700",children:[v(t.payment.rate),t.payment.paymentType==="hourly"&&"/hr"]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx(ce,{size:16,className:"mr-1"}),s.jsx("span",{children:t.location.address})]}),t.timeline.duration&&s.jsxs("div",{className:"flex items-center",children:[s.jsx(Ue,{size:16,className:"mr-1"}),s.jsxs("span",{children:[t.timeline.duration," hours"]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx(at,{size:16,className:"mr-1"}),s.jsxs("span",{children:["Posted ",C(t.postedAt)]})]})]})]}),s.jsxs("div",{className:"flex items-center gap-3 p-4 bg-gray-50 rounded-lg",children:[s.jsx("div",{className:"h-12 w-12 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx(we,{size:24,className:"text-blue-600"})}),s.jsxs("div",{children:[s.jsxs("div",{className:"font-medium text-gray-900",children:["Posted by ",t.posterId.name||"Anonymous"]}),s.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[s.jsx(pn,{size:16,className:"mr-1 text-yellow-400 fill-current"}),s.jsx("span",{children:"4.8 (124 reviews)"})]})]}),s.jsxs("div",{className:"ml-auto text-sm text-gray-500",children:[t.applicationsCount," applications"]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Description"}),s.jsx("p",{className:"text-gray-700 leading-relaxed",children:t.description})]}),t.skills.length>0&&s.jsxs("div",{children:[s.jsxs("h3",{className:"font-semibold text-gray-900 mb-2 flex items-center",children:[s.jsx(or,{size:16,className:"mr-1"}),"Required Skills"]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:t.skills.map((S,L)=>s.jsxs("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full",children:[S.name,S.isRequired&&s.jsx("span",{className:"ml-1 text-blue-600",children:"*"})]},L))})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-gray-700",children:"Experience Level:"}),s.jsx("span",{className:"ml-2 text-gray-600 capitalize",children:t.experienceLevel})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-gray-700",children:"Payment Method:"}),s.jsx("span",{className:"ml-2 text-gray-600 capitalize",children:t.payment.paymentMethod.replace("_"," ")})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-gray-700",children:"Timeline:"}),s.jsx("span",{className:"ml-2 text-gray-600",children:t.timeline.isFlexible?"Flexible":"Fixed"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-gray-700",children:"Remote Work:"}),s.jsx("span",{className:"ml-2 text-gray-600",children:t.allowsRemote?"Allowed":"On-site only"})]})]}),d&&s.jsxs("div",{className:"border-t pt-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Apply for this Gig"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cover Message"}),s.jsx("textarea",{value:l.message,onChange:S=>c(L=>({...L,message:S.target.value})),placeholder:"Why are you the right person for this job?",className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-400",rows:3})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Your Rate (",t.payment.currency,")"]}),s.jsx("input",{type:"number",value:l.proposedRate,onChange:S=>c(L=>({...L,proposedRate:parseInt(S.target.value)})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-400",min:"1"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estimated Duration (hours)"}),s.jsx("input",{type:"number",value:l.estimatedDuration,onChange:S=>c(L=>({...L,estimatedDuration:parseInt(S.target.value)})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-400",min:"1"})]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:()=>h(!1),className:"flex-1 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:N,disabled:a,className:"flex-1 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-blue-300",children:a?"Submitting...":"Submit Application"})]})]})]}),!d&&s.jsx("div",{className:"border-t pt-6",children:y?s.jsx("div",{className:"text-center text-gray-600",children:s.jsx("p",{children:"This is your gig. You cannot apply to your own posting."})}):g?s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-green-600 mb-2",children:"âœ“ Application Submitted"}),s.jsx("p",{className:"text-gray-600",children:"You have already applied to this gig."})]}):s.jsx("button",{onClick:j,className:"w-full py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 font-medium transition-colors",children:i?"Apply Now":"Login to Apply"})})]})},Ur="AIzaSyC80llSiGLLP65mGdtN5deyTDDpNiLMW3A",Ut={lat:28.6139,lng:77.209},Do=13,zr={disableDefaultUI:!1,zoomControl:!1,streetViewControl:!1,cameraControl:!1,mapTypeControl:!1,fullscreenControl:!0,styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}]},Fo=["places"],Mo=({searchQuery:t,selectedLocation:e,onMapsApiLoaded:r})=>{var ms;const{gigs:n,loading:a,error:o,fetchGigs:i,setUserLocation:l,searchGigs:c,selectedGig:d,setSelectedGig:h}=ft(),[m,u]=x.useState(null),[w,p]=x.useState(Ut),[g,f]=x.useState(!0),[y,j]=x.useState(!1),[N,v]=x.useState(null),[C,_]=x.useState(!1),S=x.useRef(null),[L,U]=x.useState([]),[k,V]=x.useState(null),[ae,J]=x.useState(!1),{isLoaded:me,loadError:E}=Zs({googleMapsApiKey:Ur,libraries:Fo});x.useEffect(()=>{r&&r(me)},[me,r]),x.useEffect(()=>{i()},[]),x.useEffect(()=>{t?c(t):i()},[t]),x.useEffect(()=>{_(!1),v(null),f(!0),yt(null)},[]),x.useEffect(()=>{me&&navigator.geolocation&&!C&&g&&navigator.geolocation.getCurrentPosition(R=>{const D={lat:R.coords.latitude,lng:R.coords.longitude};p(D),l(D),m&&(m.panTo(D),m.setZoom(15)),_(!0)},()=>{_(!0)},{enableHighAccuracy:!0,timeout:8e3,maximumAge:1e4})},[me,m,C,g]);const M=x.useCallback(R=>{u(R)},[]),Y=x.useCallback(()=>{j(R=>!R),y||h(null)},[y,h]),Z=x.useCallback(R=>{v(R),p(R),j(!1),f(!1),l(R),i({lat:R.lat,lng:R.lng,radius:15})},[]),Ee=x.useCallback(()=>{j(!1)},[]),tn=x.useCallback(()=>{v(null),f(!0)},[]),sn=x.useCallback(R=>{var D;if((D=R.geometry)!=null&&D.location){const $={lat:R.geometry.location.lat(),lng:R.geometry.location.lng()};p($),v($),f(!1),l($),yt($),i({lat:$.lat,lng:$.lng,radius:15}),m&&(m.panTo($),m.setZoom(15)),J(!1)}},[m]);x.useEffect(()=>{!m||!window.google||(S.current&&S.current.clearMarkers(),L.forEach(R=>R.setMap(null)),U([]))},[n,m,y]);const us=x.useCallback((R,D,$,fs)=>{const ps=($-R)*Math.PI/180,gs=(fs-D)*Math.PI/180,xs=Math.sin(ps/2)*Math.sin(ps/2)+Math.cos(R*Math.PI/180)*Math.cos($*Math.PI/180)*Math.sin(gs/2)*Math.sin(gs/2);return 6371e3*(2*Math.atan2(Math.sqrt(xs),Math.sqrt(1-xs)))},[]),rn=x.useCallback(R=>{V(R)},[]);x.useEffect(()=>{if(k&&k<=15e3){const R=N||w,D=n.filter($=>us(R.lat,R.lng,$.location.coordinates[1],$.location.coordinates[0])<=k);console.log(`Found ${D.length} gigs within ${k}m radius`)}},[k,n,N,w,us]),x.useEffect(()=>{var R;if(e&&((R=e.geometry)!=null&&R.location)){const D={lat:e.geometry.location.lat(),lng:e.geometry.location.lng()};p(D),v(D),f(!1),l(D),i({lat:D.lat,lng:D.lng,radius:15}),m&&(m.panTo(D),m.setZoom(15))}},[e,m]);const[hs,yt]=x.useState(null);x.useEffect(()=>{var R;if(e&&((R=e.geometry)!=null&&R.location)){const D={lat:e.geometry.location.lat(),lng:e.geometry.location.lng()};yt(D)}},[e]);const nn=x.useCallback(R=>{const D=n.find($=>$._id===R);h(D||null)},[n,h]);return E?s.jsx("div",{className:"h-full w-full flex items-center justify-center",children:s.jsx("p",{className:"text-red-500",children:"Error loading maps"})}):me?s.jsxs("div",{className:"h-full w-full relative",children:[s.jsxs(er,{mapContainerStyle:{height:"100%",width:"100%"},center:w,zoom:Do,options:zr,onLoad:M,children:[g&&!y&&s.jsx(Mn,{mapRef:m}),N&&!y&&s.jsx(st,{position:N,icon:{path:(ms=window.google)==null?void 0:ms.maps.SymbolPath.CIRCLE,scale:10,fillColor:"#10B981",fillOpacity:1,strokeColor:"#FFFFFF",strokeWeight:2},title:"Your selected location"}),hs&&!y&&s.jsx(st,{position:hs,icon:{url:"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(`
                <svg width="32" height="40" viewBox="0 0 32 40" xmlns="http://www.w3.org/2000/svg">
                  <path d="M16 0C7.163 0 0 7.163 0 16c0 11 16 24 16 24s16-13 16-24c0-8.837-7.163-16-16-16z" fill="#EF4444" stroke="#FFFFFF" stroke-width="2"/>
                  <circle cx="16" cy="16" r="6" fill="#FFFFFF"/>
                </svg>
              `),scaledSize:new window.google.maps.Size(32,40),anchor:new window.google.maps.Point(16,40)},title:"Selected search location"}),!y&&n.map(R=>s.jsx(Un,{gig:R,isSelected:(d==null?void 0:d._id)===R._id,onClick:nn,mapRef:m},R._id)),k&&!y&&s.jsx(Xs,{center:N||w,radius:k,options:{strokeColor:"#10B981",strokeOpacity:.8,strokeWeight:2,fillColor:"#10B981",fillOpacity:.1}}),s.jsx(In,{isActive:y,onSelect:Z,onCancel:Ee,mapRef:m}),s.jsx(Fn,{onToggleLocationPicker:Y,isLocationPickerActive:y,resetToLiveLocation:tn,hasManualLocation:!!N,mapRef:m,searchRadius:k,onRadiusChange:rn})]}),s.jsx(Bn,{isActive:ae,onPlaceSelected:sn,onClose:()=>J(!1)}),a&&s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-20 flex items-center justify-center pointer-events-none",children:s.jsx("div",{className:"bg-white p-4 rounded-lg shadow-lg",children:s.jsx("p",{children:"Loading gigs..."})})}),o&&s.jsxs("div",{className:"absolute top-4 right-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:[s.jsxs("p",{children:["Error: ",o]}),s.jsx("button",{onClick:()=>i(),className:"mt-2 bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600",children:"Retry"})]}),d&&s.jsx(ur,{isOpen:!!d,onClose:()=>h(null),title:"Gig Details",size:"lg",children:s.jsx(Oo,{gig:d,onApply:()=>{i()},onClose:()=>h(null)})})]}):s.jsx("div",{className:"h-full w-full flex items-center justify-center",children:s.jsx("p",{children:"Loading maps..."})})},ye=({size:t="medium",color:e="blue"})=>{const r={small:"h-4 w-4",medium:"h-8 w-8",large:"h-12 w-12"},n={blue:"text-blue-600",white:"text-white"};return s.jsx("div",{className:"flex items-center justify-center",children:s.jsxs("svg",{className:`animate-spin ${r[t]} ${n[e]}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})},ts=()=>s.jsx("div",{className:"fixed inset-0 bg-gray-100 flex items-center justify-center",children:s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("img",{src:"/images/logo.svg",alt:"QuickLister Logo",className:"h-16 w-16 mx-auto mb-4"}),s.jsx(ye,{size:"large"}),s.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:"Loading..."}),s.jsx("p",{className:"text-gray-500",children:"Please wait while we set things up"})]})}),ss=()=>s.jsx("footer",{className:"w-full py-4 px-8 border-t border-gray-100 bg-white",children:s.jsxs("div",{className:"max-w-7xl mx-auto flex justify-center items-center text-sm text-gray-600 space-x-4",children:[s.jsx("span",{children:"Â© 2025 QuickLister. All rights reserved."}),s.jsx("span",{className:"text-gray-300",children:"|"}),s.jsx("a",{href:"https://github.com/ganesh-329/QuickLister",target:"_blank",rel:"noopener noreferrer",className:"hover:text-blue-600 transition-colors","aria-label":"GitHub Repository",children:s.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:s.jsx("path",{d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"})})})]})}),Io=({onGetStarted:t})=>s.jsxs("div",{className:"min-h-screen bg-white flex flex-col",children:[s.jsx("div",{className:"w-full px-8 py-4 border-b border-gray-100",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("img",{src:"/images/logo.svg",alt:"QuickLister Logo",className:"h-10 w-10"}),s.jsx("span",{className:"ml-2 text-xl font-bold text-blue-700",children:"QuickLister"})]})}),s.jsxs("div",{className:"flex-1 flex",children:[s.jsx("div",{className:"flex-1 flex items-center justify-center px-8 lg:px-16",children:s.jsxs("div",{className:"max-w-lg",children:[s.jsxs("div",{className:"text-center mb-12",children:[s.jsxs("div",{className:"flex flex-col items-center mb-8",children:[s.jsx("h1",{className:"text-4xl lg:text-5xl font-bold text-gray-900 mb-3",children:"Welcome to QuickLister"}),s.jsx("p",{className:"text-xl text-blue-600 font-medium mb-6",children:"List. Connect. Earn. Repeat."})]}),s.jsx("p",{className:"text-xl text-gray-600 mb-8 leading-relaxed",children:"Find and post local micro jobs instantly. Connect, earn, and get things done in your neighborhood!"}),s.jsx("button",{onClick:t,className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-4 px-8 rounded-lg text-lg transition-colors duration-200 shadow-lg",children:"Get Started"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-6 mt-16",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"bg-blue-50 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-3",children:s.jsx("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})})}),s.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Interactive job map"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Find jobs near you"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"bg-blue-50 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-3",children:s.jsx("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),s.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Easy sign up & posting"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Get started in minutes"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"bg-blue-50 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-3",children:s.jsx("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})})}),s.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Smart Gig Management"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Find what you need"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"bg-blue-50 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-3",children:s.jsx("svg",{className:"w-8 h-8 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})}),s.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Built-in AI assistant"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Smart help when needed"})]})]})]})}),s.jsxs("div",{className:"flex-1 relative",children:[s.jsx("img",{src:"/bg.jpg",alt:"Professional handyman painting",className:"absolute inset-0 w-full h-full object-cover"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-l from-transparent to-white opacity-20"})]})]}),s.jsx(ss,{})]}),rs=({className:t=""})=>s.jsx("div",{className:`w-full px-8 py-4 ${t}`,children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("img",{src:"/images/logo.svg",alt:"QuickLister Logo",className:"h-8 w-8"}),s.jsx("span",{className:"ml-2 text-xl font-bold text-blue-700",children:"QuickLister"})]})}),Bo=({onLoginClick:t,onSignupClick:e,onBack:r})=>s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-white flex flex-col",children:[s.jsx(rs,{}),s.jsx("div",{className:"flex-1 flex items-center justify-center px-4",children:s.jsxs("div",{className:"max-w-md w-full",children:[s.jsxs("button",{onClick:r,className:"mb-8 flex items-center text-gray-600 hover:text-gray-800 transition-colors",children:[s.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]}),s.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-8",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6 text-center",children:"Get Started"}),s.jsx("p",{className:"text-gray-600 text-center mb-8",children:"Choose an option to continue"}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("button",{onClick:t,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors duration-200",children:"Log In"}),s.jsx("button",{onClick:e,className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold py-3 px-6 rounded-lg transition-colors duration-200",children:"Sign Up"})]})]})]})})]}),Us={pending:{icon:Ue,color:"text-yellow-600",bgColor:"bg-yellow-50",borderColor:"border-yellow-200",label:"Pending"},accepted:{icon:ot,color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200",label:"Accepted"},rejected:{icon:Yt,color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200",label:"Rejected"}},Uo=({gigId:t,onBack:e})=>{const[r,n]=x.useState([]),[a,o]=x.useState(!0),[i,l]=x.useState(null),[c,d]=x.useState(null);x.useEffect(()=>{h()},[t]);const h=async()=>{try{o(!0);const p=await q.getGigApplications(t);n(p.applications)}catch(p){l("Failed to load applications"),console.error("Error fetching gig applications:",p)}finally{o(!1)}},m=async p=>{try{d(p),await q.acceptApplication(t,p),await h()}catch(g){console.error("Error accepting application:",g),l("Failed to accept application")}finally{d(null)}},u=async p=>{try{d(p),await q.rejectApplication(t,p),await h()}catch(g){console.error("Error rejecting application:",g),l("Failed to reject application")}finally{d(null)}},w=p=>new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return a?s.jsx("div",{className:"h-full bg-gray-50 flex items-center justify-center",children:s.jsx(ye,{})}):s.jsx("div",{className:"h-full bg-gray-50 flex flex-col",children:s.jsx("div",{className:"flex-1 overflow-y-auto",children:s.jsxs("div",{className:"max-w-6xl mx-auto p-4",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs("button",{onClick:e,className:"flex items-center text-blue-600 hover:text-blue-800 mb-4 font-medium",children:[s.jsx(rr,{className:"w-4 h-4 mr-2"}),"Back to My Gigs"]}),s.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Applications (",r.length,")"]})]}),i&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4",children:s.jsx("p",{className:"text-red-800",children:i})}),r.length===0?s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-8 text-center",children:[s.jsx(we,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Applications Yet"}),s.jsx("p",{className:"text-gray-600",children:"Your gig hasn't received any applications yet. Make sure your gig details are clear and attractive to get more applications."})]}):s.jsx("div",{className:"space-y-4",children:r.map(p=>{const g=Us[p.status]||Us.pending,f=g.icon,y=c===p._id;return s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:p.applicantId.avatar?s.jsx("img",{src:p.applicantId.avatar,alt:p.applicantId.name,className:"w-12 h-12 rounded-full object-cover"}):s.jsx(we,{className:"w-6 h-6 text-blue-600"})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:p.applicantId.name}),s.jsx("p",{className:"text-gray-600 text-sm mb-2",children:p.applicantId.email}),p.applicantId.phone&&s.jsx("p",{className:"text-gray-600 text-sm mb-2",children:p.applicantId.phone}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Applied on ",w(p.appliedAt)]})]})]}),s.jsx("div",{className:"flex items-center gap-3",children:s.jsxs("div",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${g.bgColor} ${g.color} ${g.borderColor}`,children:[s.jsx(f,{className:"w-3 h-3 mr-1"}),g.label]})})]}),p.proposedRate&&s.jsx("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Proposed Rate:"})," â‚¹",p.proposedRate]})}),p.message&&s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx(ir,{className:"w-4 h-4 text-gray-500"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Application Message"})]}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:s.jsx("p",{className:"text-gray-700 text-sm leading-relaxed",children:p.message})})]}),p.status==="pending"&&s.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-100",children:[s.jsx("button",{onClick:()=>m(p._id),disabled:y,className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:y?s.jsx(ye,{}):s.jsxs(s.Fragment,{children:[s.jsx(ot,{className:"w-4 h-4"}),"Accept"]})}),s.jsx("button",{onClick:()=>u(p._id),disabled:y,className:"flex-1 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:y?s.jsx(ye,{}):s.jsxs(s.Fragment,{children:[s.jsx(Yt,{className:"w-4 h-4"}),"Reject"]})})]})]},p._id)})})]})})})},zo=()=>{const[t,e]=x.useState([]),[r,n]=x.useState(!0),[a,o]=x.useState(null),[i,l]=x.useState(null);x.useEffect(()=>{c()},[]);const c=async()=>{try{n(!0);const m=await q.getUserPostedGigs();e(m.gigs)}catch(m){o("Failed to load your gigs"),console.error("Error fetching my gigs:",m),e([])}finally{n(!1)}},d=m=>{switch(m){case"active":return"bg-green-100 text-green-800";case"completed":return"bg-blue-100 text-blue-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},h=m=>new Date(m).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return i?s.jsx(Uo,{gigId:i,onBack:()=>l(null)}):r?s.jsx("div",{className:"h-full bg-gray-50 flex items-center justify-center",children:s.jsx(ye,{})}):s.jsx("div",{className:"h-full bg-gray-50 flex flex-col",children:s.jsx("div",{className:"flex-1 overflow-y-auto",children:s.jsxs("div",{className:"max-w-6xl mx-auto p-4",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Gigs"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your posted gigs and track applications"})]}),a&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4",children:s.jsx("p",{className:"text-red-800",children:a})}),t.length===0?s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-8 text-center",children:[s.jsx("div",{className:"text-gray-400 mb-4",children:s.jsx("svg",{className:"w-16 h-16 mx-auto",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No gigs posted yet"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Start by posting your first gig to connect with potential clients"}),s.jsxs("button",{onClick:()=>window.history.back(),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Post Your First Gig"]})]}):s.jsx("div",{className:"grid gap-6",children:t.map(m=>s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:m.title}),s.jsx("p",{className:"text-gray-600 mb-3 line-clamp-2",children:m.description}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),m.location.address]}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),m.category]}),s.jsxs("span",{children:["Posted ",h(m.createdAt)]})]})]}),s.jsxs("div",{className:"flex flex-col items-end gap-3",children:[s.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${d(m.status)}`,children:m.status.charAt(0).toUpperCase()+m.status.slice(1)}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:["â‚¹",m.payment.rate]}),s.jsxs("div",{className:"text-sm text-gray-500",children:[m.applicationsCount||0," applications"]})]})]})]}),s.jsx("div",{className:"flex gap-3",children:s.jsx("button",{onClick:()=>l(m._id),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:"View Applications"})})]},m._id))})]})})})},$o={pending:{icon:Ue,color:"text-yellow-600",bgColor:"bg-yellow-50",borderColor:"border-yellow-200",label:"Pending"},accepted:{icon:ot,color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200",label:"Accepted"},rejected:{icon:Yt,color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200",label:"Rejected"}},qo=()=>{const[t,e]=x.useState([]),[r,n]=x.useState(!0),[a,o]=x.useState(null);x.useEffect(()=>{i()},[]);const i=async()=>{var c;try{n(!0),o(null),console.log("Fetching applications...");const d=await q.getUserApplications();if(!d)throw new Error("No response from server");if(!d.success){const u=d.message||"Failed to load applications";throw console.error("API Error:",u),new Error(u)}const h=((c=d.data)==null?void 0:c.applications)||[];if(!Array.isArray(h))throw console.error("Invalid applications data format:",h),new Error("Invalid applications data format");if(h.length===0){console.log("No applications found"),e([]);return}const m=h.map(u=>{var w,p,g,f,y,j,N,v,C,_,S,L,U,k,V,ae;try{let J=null;return u.application&&u._id?J={application:{_id:u.application._id||"",status:u.application.status||"pending",appliedAt:u.application.appliedAt||new Date().toISOString(),message:u.application.message||"",proposedRate:u.application.proposedRate||0},gig:{_id:u._id,title:u.title||"Untitled Gig",description:u.description||"",location:{address:((w=u.location)==null?void 0:w.address)||"No address provided",city:((p=u.location)==null?void 0:p.city)||"",state:((g=u.location)==null?void 0:g.state)||"",country:((f=u.location)==null?void 0:f.country)||""},payment:{rate:((y=u.payment)==null?void 0:y.rate)||0,currency:((j=u.payment)==null?void 0:j.currency)||"USD"},poster:{name:((N=u.poster)==null?void 0:N.name)||"Unknown",email:((v=u.poster)==null?void 0:v.email)||""}}}:u._id&&u.status&&(J={application:{_id:u._id,status:u.status||"pending",appliedAt:u.appliedAt||new Date().toISOString(),message:u.message||"",proposedRate:u.proposedRate||0},gig:{_id:u.gigId||"",title:u.gigTitle||"Untitled Gig",description:u.gigDescription||"",location:{address:((C=u.location)==null?void 0:C.address)||"No address provided",city:((_=u.location)==null?void 0:_.city)||"",state:((S=u.location)==null?void 0:S.state)||"",country:((L=u.location)==null?void 0:L.country)||""},payment:{rate:((U=u.payment)==null?void 0:U.rate)||0,currency:((k=u.payment)==null?void 0:k.currency)||"USD"},poster:{name:((V=u.poster)==null?void 0:V.name)||"Unknown",email:((ae=u.poster)==null?void 0:ae.email)||""}}}),J||(console.warn("Unexpected application format:",u),null)}catch(J){return console.error("Error mapping application:",J,u),null}}).filter(u=>u?!!(u.application&&u.gig):!1);if(console.log("Mapped applications:",m),m.length===0){console.log("No valid applications after mapping"),e([]);return}e(m)}catch(d){o("Failed to load applications"),console.error("Error fetching applications:",d)}finally{n(!1)}},l=c=>new Date(c).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return r?s.jsx("div",{className:"h-full bg-gray-50 flex items-center justify-center",children:s.jsx(ye,{})}):s.jsx("div",{className:"h-full bg-gray-50 flex flex-col",children:s.jsx("div",{className:"flex-1 overflow-y-auto",children:s.jsxs("div",{className:"max-w-6xl mx-auto p-4",children:[s.jsxs("div",{className:"flex items-center mb-4",children:[s.jsx(Ne,{className:"w-6 h-6 text-blue-600 mr-3"}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Applications"})]}),a&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4",children:s.jsx("p",{className:"text-red-800",children:a})}),t.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ne,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Applications Yet"}),s.jsx("p",{className:"text-gray-500 mb-6",children:"You haven't applied to any gigs yet."}),s.jsx("button",{onClick:()=>window.location.href="/main",className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Browse Jobs"})]}):s.jsx("div",{className:"space-y-4",children:t.map(c=>{const d=$o[c.application.status],h=d.icon;return s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[s.jsx("div",{className:"flex items-start justify-between mb-4",children:s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center mb-2",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mr-3",children:c.gig.title}),s.jsxs("div",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ${d.bgColor} ${d.color} ${d.borderColor}`,children:[s.jsx(h,{className:"w-3 h-3 mr-1"}),d.label]})]}),s.jsx("p",{className:"text-gray-600 mb-2",children:c.gig.poster.name}),s.jsx("p",{className:"text-sm text-gray-500 mb-2",children:c.gig.location.address}),s.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[s.jsx(Ue,{className:"w-4 h-4 mr-1"}),"Applied on ",l(c.application.appliedAt)]}),c.application.proposedRate&&s.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:["Proposed Rate: ",c.gig.payment.currency," ",c.application.proposedRate]})]})}),c.application.message&&s.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:s.jsx("p",{className:"text-sm text-gray-600",children:c.application.message})})]},c.application._id)})})]})})})};class Wo{async getDashboardStats(){try{return(await P.get("/dashboard/stats")).data.data}catch(e){throw console.error("Error fetching dashboard stats:",e),e}}}const Go=new Wo,Ho=Xt((t,e)=>({dashboardData:null,loading:!1,error:null,lastFetched:null,fetchDashboardData:async()=>{try{t({loading:!0,error:null});const r=await Go.getDashboardStats();t({dashboardData:r,loading:!1,lastFetched:new Date})}catch(r){t({error:r.message||"Failed to fetch dashboard data",loading:!1})}},clearError:()=>{t({error:null})},refreshDashboard:async()=>{const{fetchDashboardData:r}=e();await r()}})),Vo=()=>{const t=ue(),{dashboardData:e,loading:r,error:n,fetchDashboardData:a,refreshDashboard:o,clearError:i}=Ho();x.useEffect(()=>{a()},[a]);const l=async()=>{await o()},c=g=>new Date(g).toLocaleDateString(),d=g=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0}).format(g),h=g=>{switch(g){case"active":case"posted":return"bg-green-100 text-green-800";case"completed":return"bg-blue-100 text-blue-800";case"cancelled":return"bg-red-100 text-red-800";case"in_progress":case"assigned":return"bg-yellow-100 text-yellow-800";case"draft":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},m=g=>{switch(g){case"accepted":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"rejected":return"bg-red-100 text-red-800";case"withdrawn":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};if(r&&!e)return s.jsx("div",{className:"h-full bg-gray-50 flex items-center justify-center",children:s.jsx(ye,{})});const u=e==null?void 0:e.stats,w=(e==null?void 0:e.recentGigs)||[],p=(e==null?void 0:e.recentApplications)||[];return s.jsx("div",{className:"h-full bg-gray-50 flex flex-col",children:s.jsx("div",{className:"flex-1 overflow-y-auto",children:s.jsxs("div",{className:"max-w-7xl mx-auto p-4",children:[s.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Welcome back! Here's what's happening with your gigs."})]}),s.jsxs("button",{onClick:l,disabled:r,className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:[s.jsx(gn,{className:`w-4 h-4 ${r?"animate-spin":""}`}),"Refresh"]})]}),n&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-red-800",children:n}),s.jsx("button",{onClick:i,className:"text-red-600 hover:text-red-800 font-medium",children:"Ã—"})]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(ie,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{className:"ml-3",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Gigs"}),s.jsx("p",{className:"text-xl font-bold text-gray-900",children:(u==null?void 0:u.totalGigs)||0})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:s.jsx(xn,{className:"w-5 h-5 text-green-600"})}),s.jsxs("div",{className:"ml-3",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Gigs"}),s.jsx("p",{className:"text-xl font-bold text-gray-900",children:(u==null?void 0:u.activeGigs)||0})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:s.jsx(Ne,{className:"w-5 h-5 text-purple-600"})}),s.jsxs("div",{className:"ml-3",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Applications"}),s.jsx("p",{className:"text-xl font-bold text-gray-900",children:(u==null?void 0:u.totalApplications)||0})]})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-emerald-100 rounded-lg",children:s.jsx(Jt,{className:"w-5 h-5 text-emerald-600"})}),s.jsxs("div",{className:"ml-3",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Earnings"}),s.jsx("p",{className:"text-xl font-bold text-gray-900",children:d((u==null?void 0:u.totalEarnings)||0)})]})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(u==null?void 0:u.completedGigs)||0}),s.jsx("p",{className:"text-sm text-gray-600",children:"Completed Gigs"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(u==null?void 0:u.pendingApplications)||0}),s.jsx("p",{className:"text-sm text-gray-600",children:"Pending Applications"})]})}),s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(u==null?void 0:u.totalViews)||0}),s.jsx("p",{className:"text-sm text-gray-600",children:"Total Views"})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsx("div",{className:"lg:col-span-2",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Recent Gigs"}),s.jsx("button",{onClick:()=>t("/my-gigs"),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"View All"})]})}),s.jsx("div",{className:"p-6",children:w.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(ie,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No gigs yet"}),s.jsx("p",{className:"text-gray-500 mb-4",children:"Start by posting your first gig"}),s.jsx("button",{onClick:()=>t("/main"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Post a Gig"})]}):s.jsx("div",{className:"space-y-4",children:w.map(g=>s.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:g.title}),s.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500 mb-2",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(ce,{className:"w-4 h-4"}),g.location.address]}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(at,{className:"w-4 h-4"}),c(g.createdAt)]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${h(g.status)}`,children:g.status.charAt(0).toUpperCase()+g.status.slice(1).replace("_"," ")}),s.jsxs("span",{className:"text-sm text-gray-500",children:[g.applicationsCount||0," applications"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-lg font-bold text-gray-900",children:d(g.payment.rate)}),s.jsx("div",{className:"text-sm text-gray-500",children:g.payment.paymentType})]})]})},g._id))})})]})}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("button",{onClick:()=>t("/main"),className:"w-full flex items-center px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(ie,{className:"w-5 h-5 mr-3"}),"Post New Gig"]}),s.jsxs("button",{onClick:()=>t("/applications"),className:"w-full flex items-center px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:[s.jsx(Ne,{className:"w-5 h-5 mr-3"}),"View Applications"]}),s.jsxs("button",{onClick:()=>t("/profile"),className:"w-full flex items-center px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:[s.jsx(we,{className:"w-5 h-5 mr-3"}),"Edit Profile"]})]})]}),p.length>0&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Applications"}),s.jsx("div",{className:"space-y-3",children:p.slice(0,3).map(g=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${m(g.status)}`,children:g.status.charAt(0).toUpperCase()+g.status.slice(1)})}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:c(g.appliedAt)})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-sm font-medium",children:d(g.proposedRate||g.gigPayment.rate)}),s.jsx("p",{className:"text-xs text-gray-500",children:g.gigPayment.paymentType})]})]},g._id))}),s.jsx("button",{onClick:()=>t("/applications"),className:"w-full mt-3 text-blue-600 hover:text-blue-800 text-sm font-medium",children:"View All Applications â†’"})]}),u&&u.pendingApplications>0&&s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(Fe,{className:"w-5 h-5 text-yellow-600 mr-2"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Action Required"}),s.jsxs("p",{className:"text-sm text-yellow-700",children:["You have ",u.pendingApplications," pending application",u.pendingApplications>1?"s":""," to review"]}),s.jsx("button",{onClick:()=>t("/my-gigs"),className:"text-sm text-yellow-800 font-medium hover:underline mt-1",children:"Review now â†’"})]})]})}),u&&(u.totalEarnings>0||u.pendingEarnings>0)&&s.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Earnings Summary"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Total Earned:"}),s.jsx("span",{className:"font-semibold text-green-600",children:d(u.totalEarnings)})]}),u.pendingEarnings>0&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Pending:"}),s.jsx("span",{className:"font-semibold text-yellow-600",children:d(u.pendingEarnings)})]})]})]})]})]})]})})})};class Jo{async getUserProfile(){var e,r;try{const n=await P.get("/profile");if(!n.data.success)throw new Error(n.data.message||"Failed to fetch profile");return n.data.data}catch(n){throw console.error("Get profile error:",n),new Error(((r=(e=n.response)==null?void 0:e.data)==null?void 0:r.message)||n.message||"Failed to fetch profile")}}async updateProfile(e){var r,n;try{const a=await P.put("/profile",e);if(!a.data.success)throw new Error(a.data.message||"Failed to update profile");return a.data.data}catch(a){throw console.error("Update profile error:",a),new Error(((n=(r=a.response)==null?void 0:r.data)==null?void 0:n.message)||a.message||"Failed to update profile")}}async uploadAvatar(e){var r,n;try{const a=new FormData;a.append("avatar",e);const o=await P.post("/profile/avatar",a,{headers:{"Content-Type":"multipart/form-data"}});if(!o.data.success)throw new Error(o.data.message||"Failed to upload avatar");return o.data.data}catch(a){throw console.error("Upload avatar error:",a),new Error(((n=(r=a.response)==null?void 0:r.data)==null?void 0:n.message)||a.message||"Failed to upload avatar")}}async deleteAccount(){var e,r;try{const n=await P.delete("/profile");if(!n.data.success)throw new Error(n.data.message||"Failed to delete account")}catch(n){throw console.error("Delete account error:",n),new Error(((r=(e=n.response)==null?void 0:e.data)==null?void 0:r.message)||n.message||"Failed to delete account")}}}const zs=new Jo,Yo=()=>{const{user:t,updateUser:e}=he(),[r,n]=x.useState(!1),[a,o]=x.useState(!1),[i,l]=x.useState(!1),[c,d]=x.useState(!1),[h,m]=x.useState(null),[u,w]=x.useState({name:(t==null?void 0:t.name)||"",email:(t==null?void 0:t.email)||"",phone:(t==null?void 0:t.phone)||"",location:(t==null?void 0:t.location)||"",bio:(t==null?void 0:t.bio)||""}),[p,g]=x.useState({}),f=()=>{const v={};return u.name.trim()?u.name.trim().length<2&&(v.name="Name must be at least 2 characters"):v.name="Name is required",u.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u.email)||(v.email="Please enter a valid email address"):v.email="Email is required",u.phone&&!/^[+]?[1-9]?[0-9]{7,15}$/.test(u.phone)&&(v.phone="Please enter a valid phone number"),g(v),Object.keys(v).length===0},y=async()=>{if(f()){o(!0),m(null);try{const v={name:u.name.trim(),phone:u.phone.trim()||void 0,location:u.location.trim()||void 0,bio:u.bio.trim()||void 0},C=await zs.updateProfile(v);e({name:C.name,phone:C.phone,location:C.location,bio:C.bio}),m({type:"success",text:"Profile updated successfully!"}),n(!1),g({}),setTimeout(()=>m(null),3e3)}catch(v){console.error("Profile update error:",v),m({type:"error",text:v.message||"Failed to update profile. Please try again."})}finally{o(!1)}}},j=()=>{w({name:(t==null?void 0:t.name)||"",email:(t==null?void 0:t.email)||"",phone:(t==null?void 0:t.phone)||"",location:(t==null?void 0:t.location)||"",bio:(t==null?void 0:t.bio)||""}),g({}),m(null),n(!1)},N=async()=>{l(!0),m(null);try{await zs.deleteAccount(),m({type:"success",text:"Account deleted successfully. Redirecting..."}),setTimeout(()=>{localStorage.removeItem("user"),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),window.location.href="/"},2e3)}catch(v){console.error("Delete account error:",v),m({type:"error",text:v.message||"Failed to delete account. Please try again."})}finally{l(!1),d(!1)}};return s.jsx("div",{className:"h-full bg-gray-50 flex flex-col",children:s.jsx("div",{className:"flex-1 overflow-y-auto",children:s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-4",children:[s.jsxs("div",{className:"mb-4",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Profile"}),s.jsx("p",{className:"mt-1 text-gray-600",children:"Manage your account settings and profile information."})]}),h&&s.jsxs("div",{className:`mb-4 p-4 rounded-md flex items-center ${h.type==="success"?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:[h.type==="success"?s.jsx(ot,{className:"h-5 w-5 text-green-400 mr-3"}):s.jsx(Fe,{className:"h-5 w-5 text-red-400 mr-3"}),s.jsx("span",{className:`text-sm font-medium ${h.type==="success"?"text-green-800":"text-red-800"}`,children:h.text})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[s.jsx("div",{className:"px-6 py-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"h-20 w-20 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("img",{src:`https://ui-avatars.com/api/?name=${encodeURIComponent((t==null?void 0:t.name)||"User")}&background=3b82f6&color=ffffff&size=80`,alt:"Profile",className:"h-20 w-20 rounded-full"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:t==null?void 0:t.name}),s.jsx("p",{className:"text-gray-500",children:t==null?void 0:t.email})]})]}),s.jsx("div",{className:"flex space-x-2",children:r?s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:j,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[s.jsx(ne,{className:"h-4 w-4 mr-2"}),"Cancel"]}),s.jsxs("button",{onClick:y,disabled:a,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[a?s.jsx("div",{className:"h-4 w-4 mr-2 border-2 border-white border-t-transparent rounded-full animate-spin"}):s.jsx(bn,{className:"h-4 w-4 mr-2"}),a?"Saving...":"Save Changes"]})]}):s.jsxs("button",{onClick:()=>n(!0),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[s.jsx(yn,{className:"h-4 w-4 mr-2"}),"Edit Profile"]})})]})}),s.jsx("div",{className:"px-6 py-6",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s.jsx(we,{className:"h-4 w-4 inline mr-1"}),"Full Name"]}),r?s.jsxs("div",{children:[s.jsx("input",{type:"text",value:u.name,onChange:v=>w({...u,name:v.target.value}),className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${p.name?"border-red-300":"border-gray-300"}`,placeholder:"Enter your full name"}),p.name&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.name})]}):s.jsx("p",{className:"px-3 py-2 text-gray-900",children:(t==null?void 0:t.name)||"Not provided"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s.jsx(wn,{className:"h-4 w-4 inline mr-1"}),"Email Address"]}),r?s.jsxs("div",{children:[s.jsx("input",{type:"email",value:u.email,onChange:v=>w({...u,email:v.target.value}),className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${p.email?"border-red-300":"border-gray-300"}`,placeholder:"Enter your email address",disabled:!0}),p.email&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.email}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Email cannot be changed"})]}):s.jsx("p",{className:"px-3 py-2 text-gray-900",children:(t==null?void 0:t.email)||"Not provided"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s.jsx(jn,{className:"h-4 w-4 inline mr-1"}),"Phone Number"]}),r?s.jsxs("div",{children:[s.jsx("input",{type:"tel",value:u.phone,onChange:v=>w({...u,phone:v.target.value}),className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 ${p.phone?"border-red-300":"border-gray-300"}`,placeholder:"Enter your phone number"}),p.phone&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.phone})]}):s.jsx("p",{className:"px-3 py-2 text-gray-900",children:(t==null?void 0:t.phone)||"Not provided"})]}),s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[s.jsx(ce,{className:"h-4 w-4 inline mr-1"}),"Location"]}),r?s.jsx("input",{type:"text",value:u.location,onChange:v=>w({...u,location:v.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your location"}):s.jsx("p",{className:"px-3 py-2 text-gray-900",children:(t==null?void 0:t.location)||"Not provided"})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio"}),r?s.jsx("textarea",{value:u.bio,onChange:v=>w({...u,bio:v.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Tell us about yourself..."}):s.jsx("p",{className:"px-3 py-2 text-gray-900",children:(t==null?void 0:t.bio)||"No bio provided"})]})]})})]}),s.jsx("div",{className:"mt-8 bg-white rounded-lg shadow-sm border border-red-200",children:s.jsxs("div",{className:"px-6 py-6",children:[s.jsx("h3",{className:"text-lg font-medium text-red-900 mb-4",children:"Danger Zone"}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("button",{onClick:()=>d(!0),className:"inline-flex items-center px-4 py-2 border border-red-300 rounded-md shadow-sm text-sm font-medium text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:[s.jsx(vn,{className:"h-4 w-4 mr-2"}),"Delete Account"]}),s.jsx("p",{className:"text-sm text-gray-500",children:"Once you delete your account, there is no going back. Please be certain."})]})]})}),c&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[s.jsxs("div",{className:"flex items-center mb-4",children:[s.jsx(Fe,{className:"h-6 w-6 text-red-600 mr-3"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Delete Account"})]}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to delete your account? This action cannot be undone and all your data will be permanently removed."}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:()=>d(!1),disabled:i,className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:"Cancel"}),s.jsx("button",{onClick:N,disabled:i,className:"flex-1 px-4 py-2 border border-transparent rounded-md text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50 disabled:cursor-not-allowed",children:i?s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsx("div",{className:"h-4 w-4 mr-2 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Deleting..."]}):"Delete Account"})]})]})})]})})})};class fe{static async searchGigs(e,r={}){const n=new URLSearchParams;e.trim()&&n.append("search",e),r.page&&n.append("page",r.page.toString()),r.limit&&n.append("limit",r.limit.toString()),r.category&&n.append("category",r.category),r.location&&n.append("location",r.location);const a=await I(()=>P.get(`/gigs?${n.toString()}`));return{results:a.gigs.map(i=>({id:i._id,title:i.title,type:"gig",description:i.description,category:i.category,location:`${i.location.city}, ${i.location.state}`,paymentRange:`$${i.payment.rate} ${i.payment.paymentType}`})),totalCount:a.pagination.total,hasMore:a.pagination.page<a.pagination.pages}}static async getSearchSuggestions(e){if(!e||e.length<2)return this.getPopularSuggestions();const n=this.getPopularSuggestions().filter(a=>a.text.toLowerCase().includes(e.toLowerCase()));return n.length>0?n:this.getPopularSuggestions().slice(0,5)}static getPopularSuggestions(){return[{id:"1",text:"Graphic Design",type:"popular"},{id:"2",text:"Web Development",type:"popular"},{id:"3",text:"Photography",type:"popular"},{id:"4",text:"Writing & Translation",type:"popular"},{id:"5",text:"Video Editing",type:"popular"},{id:"6",text:"Social Media Marketing",type:"popular"},{id:"7",text:"Tutoring",type:"popular"},{id:"8",text:"Data Entry",type:"popular"},{id:"9",text:"Virtual Assistant",type:"popular"},{id:"10",text:"Content Writing",type:"popular"}]}static async quickSearch(e){if(!e||e.length<2)return[];try{return(await this.searchGigs(e,{limit:5})).results}catch(r){return console.error("Quick search failed:",r),[]}}static saveRecentSearch(e){if(!e.trim())return;const n=this.getRecentSearches().filter(o=>o!==e),a=[e,...n].slice(0,10);localStorage.setItem("recentSearches",JSON.stringify(a))}static getRecentSearches(){try{const e=localStorage.getItem("recentSearches");return e?JSON.parse(e):[]}catch{return[]}}static clearRecentSearches(){localStorage.removeItem("recentSearches")}}const Ko=({value:t,onChange:e,onSearchSubmit:r})=>{const[n,a]=x.useState([]),[o,i]=x.useState([]),[l,c]=x.useState([]),[d,h]=x.useState(!1),[m,u]=x.useState(!1),[w,p]=x.useState(-1),[g,f]=x.useState(!1),[y,j]=x.useState(0),N=x.useRef(null),v=x.useRef(null),C=x.useRef(),_=x.useRef(null);x.useEffect(()=>{c(fe.getRecentSearches())},[]);const S=x.useCallback(async E=>{var Y;const M=Date.now();if(!(M-y<500)){j(M),_.current&&_.current.abort(),_.current=new AbortController,h(!0),f(!1);try{const Z=await fe.getSearchSuggestions(E);if(i(Z),E.length>=2){const Ee=await fe.quickSearch(E);a(Ee)}else a([]);u(!0)}catch(Z){if(console.warn("Search failed, using fallback:",Z.message),!((Y=_.current)!=null&&Y.signal.aborted)){const Ee=fe.getSearchSuggestions(E);i(await Ee),a([]),f(!0),u(!0)}}finally{h(!1)}}},[y]);x.useEffect(()=>{if(C.current&&clearTimeout(C.current),t.trim().length===0){a([]),i([]),f(!1);return}return C.current=setTimeout(()=>{S(t)},600),()=>{C.current&&clearTimeout(C.current)}},[t,S]),x.useEffect(()=>()=>{_.current&&_.current.abort()},[]),x.useEffect(()=>{function E(M){N.current&&!N.current.contains(M.target)&&(u(!1),p(-1))}return m&&document.addEventListener("mousedown",E),()=>{document.removeEventListener("mousedown",E)}},[m]);const L=E=>{var Y;if(!m)return;const M=o.length+n.length+(t?1:0)+l.length;switch(E.key){case"ArrowDown":E.preventDefault(),p(Z=>(Z+1)%M);break;case"ArrowUp":E.preventDefault(),p(Z=>Z<=0?M-1:Z-1);break;case"Enter":E.preventDefault(),U();break;case"Escape":u(!1),p(-1),(Y=v.current)==null||Y.blur();break}},U=E=>{const M=E||t;M.trim()&&(fe.saveRecentSearch(M),c(fe.getRecentSearches()),r==null||r(M),u(!1),p(-1))},k=()=>{(t.trim()||l.length>0)&&u(!0)},V=E=>{e(E),U(E)},ae=E=>{e(E.title),U(E.title)},J=E=>{e(E),U(E)},me=m&&(t.trim().length>0||l.length>0||o.length>0||n.length>0);return s.jsxs("div",{className:"w-full relative",ref:N,children:[s.jsxs("div",{className:"relative",children:[s.jsx("input",{ref:v,type:"text",value:t,onChange:E=>e(E.target.value),onKeyDown:L,onFocus:k,placeholder:"Search for jobs, services, or skills...",className:"w-full px-4 py-2 pl-10 pr-4 text-gray-900 placeholder-gray-500 bg-gray-50 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"}),s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:d?s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"}):s.jsx("svg",{className:"h-5 w-5 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor",children:s.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})})})]}),me&&s.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white shadow-lg rounded-lg border border-gray-200 max-h-96 overflow-y-auto",children:[g&&n.length===0&&t.length>=2&&s.jsx("div",{className:"p-4 text-center text-gray-500",children:s.jsxs("div",{className:"text-sm",children:[s.jsx("svg",{className:"h-8 w-8 text-gray-300 mx-auto mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),s.jsx("p",{className:"font-medium",children:"Search temporarily unavailable"}),s.jsx("p",{className:"text-xs mt-1",children:"Showing popular suggestions instead"})]})}),t.trim().length===0&&l.length>0&&s.jsxs("div",{className:"p-2",children:[s.jsxs("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide px-2 py-1 flex items-center justify-between",children:["Recent Searches",s.jsx("button",{onClick:()=>{fe.clearRecentSearches(),c([])},className:"text-blue-500 hover:text-blue-700 text-xs font-normal normal-case",children:"Clear"})]}),l.map((E,M)=>s.jsxs("button",{onClick:()=>J(E),className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-100 rounded flex items-center gap-2 transition-colors ${w===M?"bg-blue-50 text-blue-700":""}`,children:[s.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),E]},E))]}),o.length>0&&s.jsxs("div",{className:"p-2",children:[s.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide px-2 py-1",children:g&&n.length===0?"Popular Categories":"Suggestions"}),o.map((E,M)=>{const Y=M+(t.trim().length===0?l.length:0);return s.jsxs("button",{onClick:()=>V(E.text),className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-100 rounded flex items-center gap-2 transition-colors ${w===Y?"bg-blue-50 text-blue-700":""}`,children:[s.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),E.text,E.type==="popular"&&s.jsx("span",{className:"ml-auto text-xs text-blue-500 bg-blue-50 px-2 py-0.5 rounded",children:"Popular"})]},E.id)})]}),n.length>0&&s.jsxs("div",{className:"p-2 border-t border-gray-100",children:[s.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide px-2 py-1",children:"Available Jobs"}),n.map((E,M)=>{const Y=M+o.length+(t.trim().length===0?l.length:0);return s.jsxs("button",{onClick:()=>ae(E),className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-100 rounded transition-colors ${w===Y?"bg-blue-50 text-blue-700":""}`,children:[s.jsx("div",{className:"font-medium text-gray-900",children:E.title}),s.jsxs("div",{className:"text-xs text-gray-500 flex items-center gap-2 mt-1",children:[s.jsx("span",{className:"bg-gray-100 px-2 py-0.5 rounded",children:E.category}),E.paymentRange&&s.jsx("span",{className:"text-green-600 font-medium",children:E.paymentRange})]})]},E.id)})]}),!d&&!g&&t.length>=2&&n.length===0&&o.length===0&&s.jsxs("div",{className:"p-6 text-center text-gray-500",children:[s.jsx("svg",{className:"h-12 w-12 text-gray-300 mx-auto mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),s.jsx("p",{className:"font-medium",children:"No results found"}),s.jsx("p",{className:"text-sm mt-1",children:"Try searching for different keywords"})]}),t.trim()&&s.jsx("div",{className:"p-2 border-t border-gray-100",children:s.jsxs("button",{onClick:()=>U(),className:`w-full text-left px-3 py-2 text-sm hover:bg-gray-100 rounded flex items-center gap-2 transition-colors ${w===o.length+n.length+(t.trim().length===0?l.length:0)?"bg-blue-50 text-blue-700":""}`,children:[s.jsx("svg",{className:"h-4 w-4 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),s.jsxs("span",{children:['Search for "',s.jsx("span",{className:"font-medium text-blue-600",children:t}),'"']})]})})]})]})},Xo=({toggleSidebar:t,searchQuery:e,setSearchQuery:r,onLocationSelect:n,isMapsApiLoaded:a,isAuthenticated:o,user:i,onLoginClick:l,onSignupClick:c,onLogout:d,onSearchSubmit:h})=>{const[m,u]=x.useState(!1),w=x.useRef(null);x.useEffect(()=>{function g(f){w.current&&!w.current.contains(f.target)&&u(!1)}return m?document.addEventListener("mousedown",g):document.removeEventListener("mousedown",g),()=>{document.removeEventListener("mousedown",g)}},[m]);const p=g=>{r(g),h==null||h(g)};return s.jsx("div",{className:"bg-white shadow-sm z-10",children:s.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex justify-between h-16",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("button",{onClick:t,className:"px-2 py-2 bg-white rounded-full shadow text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500","aria-label":"Open sidebar",children:s.jsx("img",{src:"https://img.icons8.com/?size=100&id=hW5GrtDF3kx6&format=png&color=000000",alt:"Open sidebar",width:28,height:28})}),s.jsxs("div",{className:"ml-2 flex flex-col",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("img",{src:"/images/logo.svg",alt:"QuickLister Logo",className:"h-8 w-8"}),s.jsx("span",{className:"ml-2 text-2xl font-bold text-blue-700",children:"QuickLister"})]}),s.jsx("span",{className:"text-sm text-gray-600",children:"List. Connect. Earn. Repeat."})]})]}),s.jsx("div",{className:"flex-1 flex items-center justify-center px-2 lg:ml-6 lg:justify-start max-w-2xl",children:s.jsx(Ko,{value:e,onChange:r,onLocationSelect:n,isMapsApiLoaded:a,onSearchSubmit:p})}),s.jsx("div",{className:"flex items-center lg:gap-4",children:o?s.jsxs("div",{className:"relative",ref:w,children:[s.jsxs("button",{type:"button",className:"flex items-center gap-2 p-2 rounded-full hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",onClick:()=>u(g=>!g),children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:i==null?void 0:i.name}),s.jsx("img",{src:`https://ui-avatars.com/api/?name=${encodeURIComponent((i==null?void 0:i.name)||"")}&background=random`,alt:"Profile",className:"h-8 w-8 rounded-full"})]}),m&&s.jsxs("div",{className:"absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5 z-50",children:[s.jsx("button",{onClick:()=>{u(!1),window.location.href="/profile"},className:"block w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 text-left",children:"Profile"}),s.jsx("button",{onClick:d,className:"block w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 text-left",children:"Log out"})]})]}):s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("button",{onClick:l,className:"text-gray-700 hover:text-gray-900 px-3 py-2 text-sm font-medium",children:"Log in"}),s.jsx("button",{onClick:c,className:"bg-blue-600 text-white hover:bg-blue-700 px-3 py-2 rounded-md text-sm font-medium",children:"Sign up"})]})})]})})})},Qo=({isOpen:t,isAuthenticated:e,onLoginClick:r,onLogout:n,onClose:a})=>{const o=ue(),i=dn(),l=h=>{o(h)},c=h=>i.pathname===h,d=()=>{a&&a()};return s.jsxs(s.Fragment,{children:[t&&s.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-20 md:hidden transition-all duration-300 ease-out",onClick:d}),s.jsxs("div",{className:`
          w-64 bg-white border-r border-gray-200 flex flex-col shadow-xl
          fixed inset-y-0 z-30 md:static md:shadow-none
          transform transition-all duration-300 ease-out
          ${t?"translate-x-0 opacity-100":"-translate-x-full opacity-0 md:opacity-100 md:translate-x-0 md:hidden"}
        `,style:{willChange:"transform, opacity"},children:[s.jsx("div",{className:"flex-1 px-4 py-6",children:e?s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{children:s.jsxs("nav",{className:"space-y-2",children:[s.jsxs("button",{onClick:()=>l("/dashboard"),className:`w-full flex items-center px-3 py-2 text-left rounded-lg transition-all duration-200 ${c("/dashboard")?"bg-blue-50 text-blue-700 border-r-2 border-blue-700":"text-gray-700 hover:bg-gray-100 hover:translate-x-1"}`,children:[s.jsx(Nn,{size:18,className:"mr-3"}),"Dashboard"]}),s.jsxs("button",{onClick:()=>l("/my-gigs"),className:`w-full flex items-center px-3 py-2 text-left rounded-lg transition-all duration-200 ${c("/my-gigs")?"bg-blue-50 text-blue-700 border-r-2 border-blue-700":"text-gray-700 hover:bg-gray-100 hover:translate-x-1"}`,children:[s.jsx(ie,{size:18,className:"mr-3"}),"My Gigs"]}),s.jsxs("button",{onClick:()=>l("/applications"),className:`w-full flex items-center px-3 py-2 text-left rounded-lg transition-all duration-200 ${c("/applications")?"bg-blue-50 text-blue-700 border-r-2 border-blue-700":"text-gray-700 hover:bg-gray-100 hover:translate-x-1"}`,children:[s.jsx(Ne,{size:18,className:"mr-3"}),"Applications"]}),s.jsxs("button",{onClick:()=>l("/profile"),className:`w-full flex items-center px-3 py-2 text-left rounded-lg transition-all duration-200 ${c("/profile")?"bg-blue-50 text-blue-700 border-r-2 border-blue-700":"text-gray-700 hover:bg-gray-100 hover:translate-x-1"}`,children:[s.jsx(we,{size:18,className:"mr-3"}),"Profile"]})]})}),s.jsx("div",{className:"border-t border-gray-200"}),s.jsx("div",{children:s.jsx("nav",{className:"space-y-2",children:s.jsxs("button",{onClick:()=>l("/main"),className:`w-full flex items-center px-3 py-2 text-left rounded-lg transition-all duration-200 ${c("/main")?"bg-blue-50 text-blue-700 border-r-2 border-blue-700":"text-gray-700 hover:bg-gray-100 hover:translate-x-1"}`,children:[s.jsx(ar,{size:18,className:"mr-3"}),"Browse Jobs"]})})})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Welcome!"}),s.jsxs("div",{className:"text-gray-600",children:[s.jsx("p",{className:"mb-4",children:"Sign in to post and apply for gigs."}),s.jsx("button",{onClick:r,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 transform hover:scale-105",children:"Sign In"})]})]})}),e&&s.jsx("div",{className:"border-t border-gray-200 px-4 py-4",children:s.jsx("nav",{className:"space-y-2",children:s.jsxs("button",{onClick:n,className:"w-full flex items-center px-3 py-2 text-left text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200 hover:translate-x-1",children:[s.jsx(lr,{size:18,className:"mr-3"}),"Logout"]})})})]})]})},Zo=["places"],ei=({isOpen:t,onLocationSelect:e,onClose:r,initialLocation:n})=>{var j;const[a,o]=x.useState(n||null),[i,l]=x.useState(null),[c,d]=x.useState(n||Ut),[h,m]=x.useState(!1),{isLoaded:u,loadError:w}=Zs({googleMapsApiKey:Ur,libraries:Zo});x.useEffect(()=>{t&&!i&&navigator.geolocation&&(m(!0),navigator.geolocation.getCurrentPosition(N=>{const v={lat:N.coords.latitude,lng:N.coords.longitude};l(v),d(v),m(!1)},N=>{console.error("Error getting user location:",N),m(!1),d(n||Ut)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5}))},[t,i,n]);const p=x.useCallback(N=>{if(!N.latLng)return;const v={lat:N.latLng.lat(),lng:N.latLng.lng()};console.log("Map clicked at position:",v),o(v)},[]),g=x.useCallback(()=>{i&&o(i)},[i]),f=x.useCallback(async()=>{var N,v;if(a)try{const C=new window.google.maps.Geocoder,S=((v=(N=(await new Promise((L,U)=>{C.geocode({location:a},(k,V)=>{V==="OK"?L({results:k||[]}):U(new Error(`Geocoding failed: ${V}`))})})).results)==null?void 0:N[0])==null?void 0:v.formatted_address)||"";e({lat:a.lat,lng:a.lng,address:S})}catch(C){console.error("Error getting address:",C),e({lat:a.lat,lng:a.lng})}},[a,e]);if(!t)return null;const y=s.jsxs(s.Fragment,{children:[w&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:s.jsxs("div",{className:"bg-white p-6 rounded-lg max-w-md w-full mx-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-red-600 mb-2",children:"Error Loading Map"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to load Google Maps. Please try again later."}),s.jsx("button",{onClick:r,className:"w-full px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600",children:"Close"})]})}),!u&&!w&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:s.jsx("div",{className:"bg-white p-6 rounded-lg",children:s.jsx("p",{children:"Loading map..."})})}),u&&!w&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60]",children:s.jsxs("div",{className:"bg-white rounded-lg w-full max-w-4xl h-full max-h-[80vh] mx-4 flex flex-col",children:[s.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(ce,{size:20,className:"mr-2 text-blue-500"}),s.jsx("h3",{className:"text-lg font-semibold",children:"Select Gig Location"})]}),s.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-full",children:s.jsx(ne,{size:20,className:"text-gray-500"})})]}),s.jsx("div",{className:`p-4 border-b border-gray-200 ${a?"bg-green-50":"bg-blue-50"}`,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:`text-sm ${a?"text-green-800":"text-blue-800"}`,children:a?"âœ… Location selected! You can confirm or click elsewhere to change it.":h?"Getting your location...":"Click on the map to select where this gig will take place. The map is centered on your current location."}),i&&s.jsxs("button",{onClick:g,className:"ml-4 px-3 py-1 bg-blue-600 text-white text-xs rounded-full hover:bg-blue-700 flex items-center gap-1",children:[s.jsx(Sn,{size:12}),"Use My Location"]})]})}),s.jsxs("div",{className:"flex-1 relative",children:[s.jsxs(er,{mapContainerStyle:{height:"100%",width:"100%"},center:c,zoom:15,options:zr,onClick:p,children:[i&&s.jsx(st,{position:i,icon:{path:(j=window.google)==null?void 0:j.maps.SymbolPath.CIRCLE,scale:8,fillColor:"#3B82F6",fillOpacity:1,strokeColor:"#FFFFFF",strokeWeight:2},title:"Your current location"}),a&&s.jsx(Qs,{position:a,mapPaneName:"overlayMouseTarget",children:s.jsx("div",{className:"relative",children:s.jsx("div",{className:"absolute bg-red-500 border-2 border-white rounded-full shadow-lg",style:{width:"18px",height:"18px",transform:"translate(-50%, -50%)",left:"0px",top:"0px"},children:s.jsx("div",{className:"absolute bg-white border border-red-500 rounded-full",style:{width:"6px",height:"6px",transform:"translate(-50%, -50%)",left:"50%",top:"50%"}})})})})]}),a&&s.jsxs("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-4",children:[s.jsx("button",{onClick:()=>o(null),className:"bg-white border border-gray-300 p-3 rounded-full shadow-lg hover:bg-gray-50 focus:outline-none",title:"Clear Selection",children:s.jsx(ne,{size:24,className:"text-red-500"})}),s.jsx("button",{onClick:f,className:"bg-blue-500 p-3 rounded-full shadow-lg hover:bg-blue-600 focus:outline-none",title:"Confirm Location",children:s.jsx(nr,{size:24,className:"text-white"})})]})]}),s.jsxs("div",{className:"p-4 border-t border-gray-200 flex justify-between items-center",children:[s.jsx("div",{className:"text-sm text-gray-600",children:a?s.jsxs("span",{children:["Selected: ",a.lat.toFixed(6),", ",a.lng.toFixed(6)]}):i?s.jsxs("span",{className:"text-blue-600",children:["ðŸ“ Your location: ",i.lat.toFixed(4),", ",i.lng.toFixed(4)]}):s.jsx("span",{children:"No location selected"})}),s.jsxs("div",{className:"flex space-x-3",children:[s.jsx("button",{onClick:r,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:f,disabled:!a,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed",children:"Use This Location"})]})]})]})})]});return Vt.createPortal(y,document.body)},ti=({onClose:t,onSuccess:e})=>{const{createGig:r,loading:n}=ft(),{user:a}=he(),[o,i]=x.useState(null),[l,c]=x.useState(!1),[d,h]=x.useState({title:"",description:"",category:"other",address:"",city:"",state:"",latitude:28.6139,longitude:77.209,pay:"",paymentType:"hourly",skills:[],duration:"1",urgency:"medium",experienceLevel:"intermediate",isFlexible:!0}),m=async f=>{if(f.preventDefault(),i(null),!a){i("You must be logged in to create a gig");return}try{const y={title:d.title,description:d.description,category:d.category,location:{type:"Point",coordinates:[d.longitude,d.latitude],address:d.address,city:d.city,state:d.state,country:"India"},skills:d.skills.map(j=>({name:j,category:"general",proficiency:"intermediate",isRequired:!0})),payment:{rate:parseInt(d.pay),currency:"INR",paymentType:d.paymentType,paymentMethod:"bank_transfer"},timeline:{duration:parseInt(d.duration),isFlexible:d.isFlexible},urgency:d.urgency,experienceLevel:d.experienceLevel,status:"posted"};await r(y),e==null||e(),t()}catch(y){i(y.message||"Failed to create gig")}},u=f=>{h(y=>({...y,skills:y.skills.includes(f)?y.skills.filter(j=>j!==f):[...y.skills,f]}))},w=f=>{h(y=>({...y,latitude:f.lat,longitude:f.lng,address:f.address||y.address})),c(!1)},p=["JavaScript","React","Node.js","Python","House Cleaning","Plumbing","Electrical","Driving","Tutoring","Photography","Writing","Design","Marketing","Customer Service","Repair","Gardening"],g=[{value:"tech_services",label:"Tech Services"},{value:"cleaning",label:"Cleaning"},{value:"tutoring",label:"Tutoring"},{value:"photography",label:"Photography"},{value:"plumbing",label:"Plumbing"},{value:"electrical",label:"Electrical"},{value:"home_services",label:"Home Services"},{value:"delivery",label:"Delivery"},{value:"other",label:"Other"}];return s.jsxs(s.Fragment,{children:[s.jsxs("form",{onSubmit:m,className:"space-y-6",children:[o&&s.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:o}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Gig Title"}),s.jsx("input",{type:"text",value:d.title,onChange:f=>h(y=>({...y,title:f.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400",placeholder:"Enter gig title",required:!0,minLength:5})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),s.jsx("select",{value:d.category,onChange:f=>h(y=>({...y,category:f.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400",required:!0,children:g.map(f=>s.jsx("option",{value:f.value,children:f.label},f.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),s.jsx("textarea",{value:d.description,onChange:f=>h(y=>({...y,description:f.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-400 focus:border-blue-400",rows:4,placeholder:"Describe the gig requirements (minimum 20 characters)",required:!0,minLength:20})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(ce,{size:16,className:"mr-1"}),"Location"]})}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx("input",{type:"text",value:d.address,onChange:f=>h(y=>({...y,address:f.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-400",placeholder:"Street address",required:!0}),s.jsx("input",{type:"text",value:d.city,onChange:f=>h(y=>({...y,city:f.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-400",placeholder:"City",required:!0})]}),s.jsxs("button",{type:"button",onClick:()=>c(!0),className:"w-full px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-400 flex items-center justify-center gap-2",children:[s.jsx(ce,{size:16}),"Select Location on Map"]}),d.latitude!==28.6139||d.longitude!==77.209?s.jsxs("div",{className:"text-xs text-green-600 bg-green-50 p-2 rounded",children:["âœ“ Location selected: ",d.latitude.toFixed(4),", ",d.longitude.toFixed(4)]}):null]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"mr-1 text-green-600 font-bold",children:"â‚¹"}),"Pay Rate (INR)"]})}),s.jsx("input",{type:"number",value:d.pay,onChange:f=>h(y=>({...y,pay:f.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-400",placeholder:"Enter amount",required:!0,min:"1"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Type"}),s.jsxs("select",{value:d.paymentType,onChange:f=>h(y=>({...y,paymentType:f.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-400",children:[s.jsx("option",{value:"hourly",children:"Per Hour"}),s.jsx("option",{value:"fixed",children:"Fixed Price"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(or,{size:16,className:"mr-1"}),"Required Skills"]})}),s.jsx("div",{className:"flex flex-wrap gap-2",children:p.map(f=>s.jsx("button",{type:"button",onClick:()=>u(f),className:`px-3 py-1 rounded-full text-sm ${d.skills.includes(f)?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:f},f))})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(Ue,{size:16,className:"mr-1"}),"Duration (hours)"]})}),s.jsxs("select",{value:d.duration,onChange:f=>h(y=>({...y,duration:f.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-400",children:[s.jsx("option",{value:"1",children:"1 hour"}),s.jsx("option",{value:"4",children:"4 hours"}),s.jsx("option",{value:"8",children:"8 hours"}),s.jsx("option",{value:"16",children:"2 days"}),s.jsx("option",{value:"40",children:"1 week"}),s.jsx("option",{value:"80",children:"2 weeks"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Urgency"}),s.jsxs("select",{value:d.urgency,onChange:f=>h(y=>({...y,urgency:f.target.value})),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-400",children:[s.jsx("option",{value:"low",children:"Low"}),s.jsx("option",{value:"medium",children:"Medium"}),s.jsx("option",{value:"high",children:"High"}),s.jsx("option",{value:"urgent",children:"Urgent"})]})]})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{type:"submit",disabled:n,className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-blue-300 disabled:cursor-not-allowed",children:n?"Creating...":"Post Gig"})]})]}),s.jsx(ei,{isOpen:l,onLocationSelect:w,onClose:()=>c(!1),initialLocation:{lat:d.latitude,lng:d.longitude}})]})},si=({isAuthenticated:t,onLoginClick:e})=>{const[r,n]=x.useState(!1),{fetchGigs:a}=ft(),o=()=>{if(!t&&e){e();return}t&&n(!0)},i=()=>{a()},l=()=>{n(!1)};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"fixed right-6 bottom-20 z-30",children:[s.jsxs("button",{onClick:o,className:`group relative bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-full p-4 shadow-xl hover:from-blue-700 hover:to-blue-800 focus:outline-none focus:ring-4 focus:ring-blue-300 transition-all duration-300 transform hover:scale-110 active:scale-95 ${t?"":"animate-pulse"}`,style:{minWidth:"56px",minHeight:"56px"},"aria-label":t?"Create new job":"Login to create job",children:[s.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-blue-600 to-blue-700 rounded-full opacity-0 group-hover:opacity-20 blur-lg transition-opacity duration-300"}),s.jsx("div",{className:"relative flex items-center justify-center",children:t?s.jsx(sr,{size:24,className:"transition-transform duration-300"}):s.jsx(ie,{size:24,className:"transition-transform duration-300"})})]}),!t&&s.jsx("div",{className:"absolute -bottom-2 -right-2 bg-orange-500 text-white text-xs px-2 py-1 rounded-full animate-bounce shadow-lg",children:"Login"})]}),s.jsx(ur,{isOpen:r,onClose:l,title:"ðŸš€ Create New Gig",size:"lg",children:s.jsx(ti,{onClose:l,onSuccess:i})})]})},_e="/api";class ri{getAuthHeaders(){const e=localStorage.getItem("access_token");return console.log("ChatService: Retrieved token from localStorage:",e?"Token present":"No token found"),console.log("ChatService: Token value:",(e==null?void 0:e.substring(0,20))+"..."||"null"),{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}}}async createChat(e){return(await O.post(`${_e}/chat`,e,this.getAuthHeaders())).data.chat}async getUserChats(){return(await O.get(`${_e}/chat`,this.getAuthHeaders())).data.chats}async getChatMessages(e,r=1,n=50){return(await O.get(`${_e}/chat/${e}/messages?page=${r}&limit=${n}`,this.getAuthHeaders())).data}async toggleAI(e,r){return(await O.patch(`${_e}/chat/${e}/ai`,{enabled:r},this.getAuthHeaders())).data.chat}async deleteChat(e){await O.delete(`${_e}/chat/${e}`,this.getAuthHeaders())}}const Re=new ri,se=Object.create(null);se.open="0";se.close="1";se.ping="2";se.pong="3";se.message="4";se.upgrade="5";se.noop="6";const Ke=Object.create(null);Object.keys(se).forEach(t=>{Ke[se[t]]=t});const zt={type:"error",data:"parser error"},$r=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",qr=typeof ArrayBuffer=="function",Wr=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,ns=({type:t,data:e},r,n)=>$r&&e instanceof Blob?r?n(e):$s(e,n):qr&&(e instanceof ArrayBuffer||Wr(e))?r?n(e):$s(new Blob([e]),n):n(se[t]+(e||"")),$s=(t,e)=>{const r=new FileReader;return r.onload=function(){const n=r.result.split(",")[1];e("b"+(n||""))},r.readAsDataURL(t)};function qs(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let At;function ni(t,e){if($r&&t.data instanceof Blob)return t.data.arrayBuffer().then(qs).then(e);if(qr&&(t.data instanceof ArrayBuffer||Wr(t.data)))return e(qs(t.data));ns(t,!1,r=>{At||(At=new TextEncoder),e(At.encode(r))})}const Ws="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Oe=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<Ws.length;t++)Oe[Ws.charCodeAt(t)]=t;const ai=t=>{let e=t.length*.75,r=t.length,n,a=0,o,i,l,c;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const d=new ArrayBuffer(e),h=new Uint8Array(d);for(n=0;n<r;n+=4)o=Oe[t.charCodeAt(n)],i=Oe[t.charCodeAt(n+1)],l=Oe[t.charCodeAt(n+2)],c=Oe[t.charCodeAt(n+3)],h[a++]=o<<2|i>>4,h[a++]=(i&15)<<4|l>>2,h[a++]=(l&3)<<6|c&63;return d},oi=typeof ArrayBuffer=="function",as=(t,e)=>{if(typeof t!="string")return{type:"message",data:Gr(t,e)};const r=t.charAt(0);return r==="b"?{type:"message",data:ii(t.substring(1),e)}:Ke[r]?t.length>1?{type:Ke[r],data:t.substring(1)}:{type:Ke[r]}:zt},ii=(t,e)=>{if(oi){const r=ai(t);return Gr(r,e)}else return{base64:!0,data:t}},Gr=(t,e)=>{switch(e){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},Hr="",li=(t,e)=>{const r=t.length,n=new Array(r);let a=0;t.forEach((o,i)=>{ns(o,!1,l=>{n[i]=l,++a===r&&e(n.join(Hr))})})},ci=(t,e)=>{const r=t.split(Hr),n=[];for(let a=0;a<r.length;a++){const o=as(r[a],e);if(n.push(o),o.type==="error")break}return n};function di(){return new TransformStream({transform(t,e){ni(t,r=>{const n=r.length;let a;if(n<126)a=new Uint8Array(1),new DataView(a.buffer).setUint8(0,n);else if(n<65536){a=new Uint8Array(3);const o=new DataView(a.buffer);o.setUint8(0,126),o.setUint16(1,n)}else{a=new Uint8Array(9);const o=new DataView(a.buffer);o.setUint8(0,127),o.setBigUint64(1,BigInt(n))}t.data&&typeof t.data!="string"&&(a[0]|=128),e.enqueue(a),e.enqueue(r)})}})}let _t;function We(t){return t.reduce((e,r)=>e+r.length,0)}function Ge(t,e){if(t[0].length===e)return t.shift();const r=new Uint8Array(e);let n=0;for(let a=0;a<e;a++)r[a]=t[0][n++],n===t[0].length&&(t.shift(),n=0);return t.length&&n<t[0].length&&(t[0]=t[0].slice(n)),r}function ui(t,e){_t||(_t=new TextDecoder);const r=[];let n=0,a=-1,o=!1;return new TransformStream({transform(i,l){for(r.push(i);;){if(n===0){if(We(r)<1)break;const c=Ge(r,1);o=(c[0]&128)===128,a=c[0]&127,a<126?n=3:a===126?n=1:n=2}else if(n===1){if(We(r)<2)break;const c=Ge(r,2);a=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),n=3}else if(n===2){if(We(r)<8)break;const c=Ge(r,8),d=new DataView(c.buffer,c.byteOffset,c.length),h=d.getUint32(0);if(h>Math.pow(2,21)-1){l.enqueue(zt);break}a=h*Math.pow(2,32)+d.getUint32(4),n=3}else{if(We(r)<a)break;const c=Ge(r,a);l.enqueue(as(o?c:_t.decode(c),e)),n=0}if(a===0||a>t){l.enqueue(zt);break}}}})}const Vr=4;function F(t){if(t)return hi(t)}function hi(t){for(var e in F.prototype)t[e]=F.prototype[e];return t}F.prototype.on=F.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};F.prototype.once=function(t,e){function r(){this.off(t,r),e.apply(this,arguments)}return r.fn=e,this.on(t,r),this};F.prototype.off=F.prototype.removeListener=F.prototype.removeAllListeners=F.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var n,a=0;a<r.length;a++)if(n=r[a],n===e||n.fn===e){r.splice(a,1);break}return r.length===0&&delete this._callbacks["$"+t],this};F.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),r=this._callbacks["$"+t],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,a=r.length;n<a;++n)r[n].apply(this,e)}return this};F.prototype.emitReserved=F.prototype.emit;F.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};F.prototype.hasListeners=function(t){return!!this.listeners(t).length};const pt=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,r)=>r(e,0),H=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),mi="arraybuffer";function Jr(t,...e){return e.reduce((r,n)=>(t.hasOwnProperty(n)&&(r[n]=t[n]),r),{})}const fi=H.setTimeout,pi=H.clearTimeout;function gt(t,e){e.useNativeTimers?(t.setTimeoutFn=fi.bind(H),t.clearTimeoutFn=pi.bind(H)):(t.setTimeoutFn=H.setTimeout.bind(H),t.clearTimeoutFn=H.clearTimeout.bind(H))}const gi=1.33;function xi(t){return typeof t=="string"?yi(t):Math.ceil((t.byteLength||t.size)*gi)}function yi(t){let e=0,r=0;for(let n=0,a=t.length;n<a;n++)e=t.charCodeAt(n),e<128?r+=1:e<2048?r+=2:e<55296||e>=57344?r+=3:(n++,r+=4);return r}function Yr(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function bi(t){let e="";for(let r in t)t.hasOwnProperty(r)&&(e.length&&(e+="&"),e+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return e}function wi(t){let e={},r=t.split("&");for(let n=0,a=r.length;n<a;n++){let o=r[n].split("=");e[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return e}class ji extends Error{constructor(e,r,n){super(e),this.description=r,this.context=n,this.type="TransportError"}}class os extends F{constructor(e){super(),this.writable=!1,gt(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,r,n){return super.emitReserved("error",new ji(e,r,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const r=as(e,this.socket.binaryType);this.onPacket(r)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,r={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const r=bi(e);return r.length?"?"+r:""}}class vi extends os{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const r=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||r()})),this.writable||(n++,this.once("drain",function(){--n||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const r=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};ci(e,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,li(e,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=Yr()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(e,r)}}let Kr=!1;try{Kr=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Ni=Kr;function Si(){}class ki extends vi{constructor(e){if(super(e),typeof location<"u"){const r=location.protocol==="https:";let n=location.port;n||(n=r?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,r){const n=this.request({method:"POST",data:e});n.on("success",r),n.on("error",(a,o)=>{this.onError("xhr post error",a,o)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(r,n)=>{this.onError("xhr poll error",r,n)}),this.pollXhr=e}}let ve=class Xe extends F{constructor(e,r,n){super(),this.createRequest=e,gt(this,n),this._opts=n,this._method=n.method||"GET",this._uri=r,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var e;const r=Jr(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(r);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let a in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(a)&&n.setRequestHeader(a,this._opts.extraHeaders[a])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var a;n.readyState===3&&((a=this._opts.cookieJar)===null||a===void 0||a.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(a){this.setTimeoutFn(()=>{this._onError(a)},0);return}typeof document<"u"&&(this._index=Xe.requestsCount++,Xe.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Si,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Xe.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};ve.requestsCount=0;ve.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Gs);else if(typeof addEventListener=="function"){const t="onpagehide"in H?"pagehide":"unload";addEventListener(t,Gs,!1)}}function Gs(){for(let t in ve.requests)ve.requests.hasOwnProperty(t)&&ve.requests[t].abort()}const Ci=function(){const t=Xr({xdomain:!1});return t&&t.responseType!==null}();class Ei extends ki{constructor(e){super(e);const r=e&&e.forceBase64;this.supportsBinary=Ci&&!r}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new ve(Xr,this.uri(),e)}}function Xr(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||Ni))return new XMLHttpRequest}catch{}if(!e)try{return new H[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const Qr=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Ai extends os{get name(){return"websocket"}doOpen(){const e=this.uri(),r=this.opts.protocols,n=Qr?{}:Jr(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,r,n)}catch(a){return this.emitReserved("error",a)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let r=0;r<e.length;r++){const n=e[r],a=r===e.length-1;ns(n,this.supportsBinary,o=>{try{this.doWrite(n,o)}catch{}a&&pt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=Yr()),this.supportsBinary||(r.b64=1),this.createUri(e,r)}}const Rt=H.WebSocket||H.MozWebSocket;class _i extends Ai{createSocket(e,r,n){return Qr?new Rt(e,r,n):r?new Rt(e,r):new Rt(e)}doWrite(e,r){this.ws.send(r)}}class Ri extends os{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const r=ui(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(r).getReader(),a=di();a.readable.pipeTo(e.writable),this._writer=a.writable.getWriter();const o=()=>{n.read().then(({done:l,value:c})=>{l||(this.onPacket(c),o())}).catch(l=>{})};o();const i={type:"open"};this.query.sid&&(i.data=`{"sid":"${this.query.sid}"}`),this._writer.write(i).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let r=0;r<e.length;r++){const n=e[r],a=r===e.length-1;this._writer.write(n).then(()=>{a&&pt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const Ti={websocket:_i,webtransport:Ri,polling:Ei},Pi=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Li=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function $t(t){if(t.length>8e3)throw"URI too long";const e=t,r=t.indexOf("["),n=t.indexOf("]");r!=-1&&n!=-1&&(t=t.substring(0,r)+t.substring(r,n).replace(/:/g,";")+t.substring(n,t.length));let a=Pi.exec(t||""),o={},i=14;for(;i--;)o[Li[i]]=a[i]||"";return r!=-1&&n!=-1&&(o.source=e,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=Oi(o,o.path),o.queryKey=Di(o,o.query),o}function Oi(t,e){const r=/\/{2,9}/g,n=e.replace(r,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&n.splice(0,1),e.slice(-1)=="/"&&n.splice(n.length-1,1),n}function Di(t,e){const r={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,a,o){a&&(r[a]=o)}),r}const qt=typeof addEventListener=="function"&&typeof removeEventListener=="function",Qe=[];qt&&addEventListener("offline",()=>{Qe.forEach(t=>t())},!1);class le extends F{constructor(e,r){if(super(),this.binaryType=mi,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(r=e,e=null),e){const n=$t(e);r.hostname=n.host,r.secure=n.protocol==="https"||n.protocol==="wss",r.port=n.port,n.query&&(r.query=n.query)}else r.host&&(r.hostname=$t(r.host).host);gt(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(n=>{const a=n.prototype.name;this.transports.push(a),this._transportsByName[a]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=wi(this.opts.query)),qt&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Qe.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const r=Object.assign({},this.opts.query);r.EIO=Vr,r.transport=e,this.id&&(r.sid=this.id);const n=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&le.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(e);r.open(),this.setTransport(r)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",le.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=e.data,this._onError(r);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let n=0;n<this.writeBuffer.length;n++){const a=this.writeBuffer[n].data;if(a&&(r+=xi(a)),n>0&&r>this._maxPayload)return this.writeBuffer.slice(0,n);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,pt(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,r,n){return this._sendPacket("message",e,r,n),this}send(e,r,n){return this._sendPacket("message",e,r,n),this}_sendPacket(e,r,n,a){if(typeof r=="function"&&(a=r,r=void 0),typeof n=="function"&&(a=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const o={type:e,data:r,options:n};this.emitReserved("packetCreate",o),this.writeBuffer.push(o),a&&this.once("flush",a),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),e()},n=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(le.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),qt&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=Qe.indexOf(this._offlineEventListener);n!==-1&&Qe.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,r),this.writeBuffer=[],this._prevBufferLen=0}}}le.protocol=Vr;class Fi extends le{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let r=this.createTransport(e),n=!1;le.priorWebsocketSuccess=!1;const a=()=>{n||(r.send([{type:"ping",data:"probe"}]),r.once("packet",m=>{if(!n)if(m.type==="pong"&&m.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;le.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(h(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const u=new Error("probe error");u.transport=r.name,this.emitReserved("upgradeError",u)}}))};function o(){n||(n=!0,h(),r.close(),r=null)}const i=m=>{const u=new Error("probe error: "+m);u.transport=r.name,o(),this.emitReserved("upgradeError",u)};function l(){i("transport closed")}function c(){i("socket closed")}function d(m){r&&m.name!==r.name&&o()}const h=()=>{r.removeListener("open",a),r.removeListener("error",i),r.removeListener("close",l),this.off("close",c),this.off("upgrading",d)};r.once("open",a),r.once("error",i),r.once("close",l),this.once("close",c),this.once("upgrading",d),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{n||r.open()},200):r.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const r=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&r.push(e[n]);return r}}let Mi=class extends Fi{constructor(e,r={}){const n=typeof e=="object"?e:r;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(a=>Ti[a]).filter(a=>!!a)),super(e,n)}};function Ii(t,e="",r){let n=t;r=r||typeof location<"u"&&location,t==null&&(t=r.protocol+"//"+r.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=r.protocol+t:t=r.host+t),/^(https?|wss?):\/\//.test(t)||(typeof r<"u"?t=r.protocol+"//"+t:t="https://"+t),n=$t(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const o=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+o+":"+n.port+e,n.href=n.protocol+"://"+o+(r&&r.port===n.port?"":":"+n.port),n}const Bi=typeof ArrayBuffer=="function",Ui=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,Zr=Object.prototype.toString,zi=typeof Blob=="function"||typeof Blob<"u"&&Zr.call(Blob)==="[object BlobConstructor]",$i=typeof File=="function"||typeof File<"u"&&Zr.call(File)==="[object FileConstructor]";function is(t){return Bi&&(t instanceof ArrayBuffer||Ui(t))||zi&&t instanceof Blob||$i&&t instanceof File}function Ze(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let r=0,n=t.length;r<n;r++)if(Ze(t[r]))return!0;return!1}if(is(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return Ze(t.toJSON(),!0);for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&Ze(t[r]))return!0;return!1}function qi(t){const e=[],r=t.data,n=t;return n.data=Wt(r,e),n.attachments=e.length,{packet:n,buffers:e}}function Wt(t,e){if(!t)return t;if(is(t)){const r={_placeholder:!0,num:e.length};return e.push(t),r}else if(Array.isArray(t)){const r=new Array(t.length);for(let n=0;n<t.length;n++)r[n]=Wt(t[n],e);return r}else if(typeof t=="object"&&!(t instanceof Date)){const r={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=Wt(t[n],e));return r}return t}function Wi(t,e){return t.data=Gt(t.data,e),delete t.attachments,t}function Gt(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let r=0;r<t.length;r++)t[r]=Gt(t[r],e);else if(typeof t=="object")for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=Gt(t[r],e));return t}const Gi=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Hi=5;var T;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(T||(T={}));class Vi{constructor(e){this.replacer=e}encode(e){return(e.type===T.EVENT||e.type===T.ACK)&&Ze(e)?this.encodeAsBinary({type:e.type===T.EVENT?T.BINARY_EVENT:T.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let r=""+e.type;return(e.type===T.BINARY_EVENT||e.type===T.BINARY_ACK)&&(r+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(r+=e.nsp+","),e.id!=null&&(r+=e.id),e.data!=null&&(r+=JSON.stringify(e.data,this.replacer)),r}encodeAsBinary(e){const r=qi(e),n=this.encodeAsString(r.packet),a=r.buffers;return a.unshift(n),a}}function Hs(t){return Object.prototype.toString.call(t)==="[object Object]"}class ls extends F{constructor(e){super(),this.reviver=e}add(e){let r;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(e);const n=r.type===T.BINARY_EVENT;n||r.type===T.BINARY_ACK?(r.type=n?T.EVENT:T.ACK,this.reconstructor=new Ji(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(is(e)||e.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(e),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let r=0;const n={type:Number(e.charAt(0))};if(T[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===T.BINARY_EVENT||n.type===T.BINARY_ACK){const o=r+1;for(;e.charAt(++r)!=="-"&&r!=e.length;);const i=e.substring(o,r);if(i!=Number(i)||e.charAt(r)!=="-")throw new Error("Illegal attachments");n.attachments=Number(i)}if(e.charAt(r+1)==="/"){const o=r+1;for(;++r&&!(e.charAt(r)===","||r===e.length););n.nsp=e.substring(o,r)}else n.nsp="/";const a=e.charAt(r+1);if(a!==""&&Number(a)==a){const o=r+1;for(;++r;){const i=e.charAt(r);if(i==null||Number(i)!=i){--r;break}if(r===e.length)break}n.id=Number(e.substring(o,r+1))}if(e.charAt(++r)){const o=this.tryParse(e.substr(r));if(ls.isPayloadValid(n.type,o))n.data=o;else throw new Error("invalid payload")}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,r){switch(e){case T.CONNECT:return Hs(r);case T.DISCONNECT:return r===void 0;case T.CONNECT_ERROR:return typeof r=="string"||Hs(r);case T.EVENT:case T.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&Gi.indexOf(r[0])===-1);case T.ACK:case T.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class Ji{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const r=Wi(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const Yi=Object.freeze(Object.defineProperty({__proto__:null,Decoder:ls,Encoder:Vi,get PacketType(){return T},protocol:Hi},Symbol.toStringTag,{value:"Module"}));function X(t,e,r){return t.on(e,r),function(){t.off(e,r)}}const Ki=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class en extends F{constructor(e,r,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=r,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[X(e,"open",this.onopen.bind(this)),X(e,"packet",this.onpacket.bind(this)),X(e,"error",this.onerror.bind(this)),X(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...r){var n,a,o;if(Ki.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(r.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const i={type:T.EVENT,data:r};if(i.options={},i.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const h=this.ids++,m=r.pop();this._registerAckCallback(h,m),i.id=h}const l=(a=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||a===void 0?void 0:a.writable,c=this.connected&&!(!((o=this.io.engine)===null||o===void 0)&&o._hasPingExpired());return this.flags.volatile&&!l||(c?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}_registerAckCallback(e,r){var n;const a=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(a===void 0){this.acks[e]=r;return}const o=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let l=0;l<this.sendBuffer.length;l++)this.sendBuffer[l].id===e&&this.sendBuffer.splice(l,1);r.call(this,new Error("operation has timed out"))},a),i=(...l)=>{this.io.clearTimeoutFn(o),r.apply(this,l)};i.withError=!0,this.acks[e]=i}emitWithAck(e,...r){return new Promise((n,a)=>{const o=(i,l)=>i?a(i):n(l);o.withError=!0,r.push(o),this.emit(e,...r)})}_addToQueue(e){let r;typeof e[e.length-1]=="function"&&(r=e.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((a,...o)=>n!==this._queue[0]?void 0:(a!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(a)):(this._queue.shift(),r&&r(null,...o)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!e||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:T.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(n=>String(n.id)===e)){const n=this.acks[e];delete this.acks[e],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case T.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case T.EVENT:case T.BINARY_EVENT:this.onevent(e);break;case T.ACK:case T.BINARY_ACK:this.onack(e);break;case T.DISCONNECT:this.ondisconnect();break;case T.CONNECT_ERROR:this.destroy();const n=new Error(e.data.message);n.data=e.data.data,this.emitReserved("connect_error",n);break}}onevent(e){const r=e.data||[];e.id!=null&&r.push(this.ack(e.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const n of r)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const r=this;let n=!1;return function(...a){n||(n=!0,r.packet({type:T.ACK,id:e,data:a}))}}onack(e){const r=this.acks[e.id];typeof r=="function"&&(delete this.acks[e.id],r.withError&&e.data.unshift(null),r.apply(this,e.data))}onconnect(e,r){this.id=e,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:T.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const r=this._anyListeners;for(let n=0;n<r.length;n++)if(e===r[n])return r.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const r=this._anyOutgoingListeners;for(let n=0;n<r.length;n++)if(e===r[n])return r.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const n of r)n.apply(this,e.data)}}}function Ce(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Ce.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),r=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-r:t+r}return Math.min(t,this.max)|0};Ce.prototype.reset=function(){this.attempts=0};Ce.prototype.setMin=function(t){this.ms=t};Ce.prototype.setMax=function(t){this.max=t};Ce.prototype.setJitter=function(t){this.jitter=t};class Ht extends F{constructor(e,r){var n;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(r=e,e=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,gt(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((n=r.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new Ce({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=e;const a=r.parser||Yi;this.encoder=new a.Encoder,this.decoder=new a.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var r;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(r=this.backoff)===null||r===void 0||r.setMin(e),this)}randomizationFactor(e){var r;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(r=this.backoff)===null||r===void 0||r.setJitter(e),this)}reconnectionDelayMax(e){var r;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(r=this.backoff)===null||r===void 0||r.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Mi(this.uri,this.opts);const r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const a=X(r,"open",function(){n.onopen(),e&&e()}),o=l=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",l),e?e(l):this.maybeReconnectOnOpen()},i=X(r,"error",o);if(this._timeout!==!1){const l=this._timeout,c=this.setTimeoutFn(()=>{a(),o(new Error("timeout")),r.close()},l);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(a),this.subs.push(i),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(X(e,"ping",this.onping.bind(this)),X(e,"data",this.ondata.bind(this)),X(e,"error",this.onerror.bind(this)),X(e,"close",this.onclose.bind(this)),X(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(r){this.onclose("parse error",r)}}ondecoded(e){pt(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,r){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new en(this,e,r),this.nsps[e]=n),n}_destroy(e){const r=Object.keys(this.nsps);for(const n of r)if(this.nsps[n].active)return;this._close()}_packet(e){const r=this.encoder.encode(e);for(let n=0;n<r.length;n++)this.engine.write(r[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,r){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(a=>{a?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",a)):e.onreconnect()}))},r);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const Te={};function et(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const r=Ii(t,e.path||"/socket.io"),n=r.source,a=r.id,o=r.path,i=Te[a]&&o in Te[a].nsps,l=e.forceNew||e["force new connection"]||e.multiplex===!1||i;let c;return l?c=new Ht(n,e):(Te[a]||(Te[a]=new Ht(n,e)),c=Te[a]),r.query&&!e.query&&(e.query=r.queryKey),c.socket(r.path,e)}Object.assign(et,{Manager:Ht,Socket:en,io:et,connect:et});class Xi{constructor(){bt(this,"socket",null);bt(this,"listeners",new Map)}connect(e){var n;if((n=this.socket)!=null&&n.connected){console.log("ðŸ”— Socket already connected");return}const r=e||void 0||window.location.origin;console.log("ðŸ”„ Connecting to socket server:",r),this.socket=et(r,{transports:["websocket","polling"],upgrade:!0,rememberUpgrade:!1,timeout:2e4,forceNew:!0}),this.socket.on("connect",()=>{console.log("Connected to socket server")}),this.socket.on("disconnect",()=>{console.log("Disconnected from socket server")}),this.socket.on("connect_error",a=>{console.error("Socket connection error:",a)}),this.socket.on("message",a=>{console.log("Received message via socket:",a),this.emit("message",a)}),this.socket.on("ai_error",a=>{console.log("Received AI error via socket:",a),this.emit("ai_error",a)}),this.socket.on("error",a=>{console.log("Received error via socket:",a),this.emit("error",a)})}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null),this.listeners.clear()}joinChat(e,r){if(console.log("SocketService joinChat called:",{chatId:e,userId:r,isConnected:this.isConnected}),!this.socket){console.error("Socket not initialized for joinChat");return}if(!this.socket.connected){console.error("Socket not connected for joinChat");return}console.log("Emitting join event via socket"),this.socket.emit("join",{chatId:e,userId:r})}leaveChat(e){this.socket&&this.socket.emit("leave",{chatId:e})}sendMessage(e,r){if(console.log("SocketService sendMessage called:",{chatId:e,content:r,isConnected:this.isConnected}),!this.socket){console.error("Socket not initialized");return}if(!this.socket.connected){console.error("Socket not connected");return}console.log("Emitting message event via socket"),this.socket.emit("message",{chatId:e,content:r})}on(e,r){this.listeners.has(e)||this.listeners.set(e,[]),this.listeners.get(e).push(r)}off(e,r){const n=this.listeners.get(e);if(n){const a=n.indexOf(r);a>-1&&n.splice(a,1)}}emit(e,...r){const n=this.listeners.get(e);n&&n.forEach(a=>{try{a(...r)}catch(o){console.error("Error in socket event callback:",o)}})}get isConnected(){var e;return((e=this.socket)==null?void 0:e.connected)||!1}}const oe=new Xi,Qi=Xt((t,e)=>({chats:[],currentChat:null,messages:[],isLoading:!1,error:null,isConnected:!1,setCurrentChat:r=>{const n=e();if(n.currentChat&&oe.leaveChat(n.currentChat._id),r){const a=localStorage.getItem("user");if(a)try{const i=JSON.parse(a).id;i?(console.log("ChatStore: Joining chat room:",{chatId:r._id,userId:i}),oe.joinChat(r._id,i)):console.error("ChatStore: No user ID found in user object")}catch(o){console.error("ChatStore: Error parsing user from localStorage:",o)}else console.error("ChatStore: No user found in localStorage")}t({currentChat:r,messages:[]})},createChat:async(r,n)=>{t({isLoading:!0,error:null});try{const a=await Re.createChat({participants:r,gig:n});return t(o=>({chats:[a,...o.chats],isLoading:!1})),a}catch(a){const o=a instanceof Error?a.message:"Failed to create chat";throw t({error:o,isLoading:!1}),a}},fetchChats:async()=>{t({isLoading:!0,error:null});try{const r=await Re.getUserChats();t({chats:r,isLoading:!1})}catch(r){const n=r instanceof Error?r.message:"Failed to fetch chats";t({error:n,isLoading:!1})}},fetchMessages:async r=>{t({isLoading:!0,error:null});try{const n=await Re.getChatMessages(r);t({messages:n.messages,isLoading:!1})}catch(n){const a=n instanceof Error?n.message:"Failed to fetch messages";t({error:a,isLoading:!1})}},sendMessage:r=>{const{currentChat:n,addOptimisticMessage:a,removeOptimisticMessage:o}=e();if(n&&r.trim()){const i=a(r.trim());oe.sendMessage(n._id,r.trim()),setTimeout(()=>{o(i)},1e4)}},toggleAI:async(r,n)=>{t({isLoading:!0,error:null});try{const a=await Re.toggleAI(r,n);t(o=>{var i;return{chats:o.chats.map(l=>l._id===r?a:l),currentChat:((i=o.currentChat)==null?void 0:i._id)===r?a:o.currentChat,isLoading:!1}})}catch(a){const o=a instanceof Error?a.message:"Failed to toggle AI";t({error:o,isLoading:!1})}},deleteChat:async r=>{t({isLoading:!0,error:null});try{await Re.deleteChat(r),t(n=>{var a,o;return{chats:n.chats.filter(i=>i._id!==r),currentChat:((a=n.currentChat)==null?void 0:a._id)===r?null:n.currentChat,messages:((o=n.currentChat)==null?void 0:o._id)===r?[]:n.messages,isLoading:!1}})}catch(n){const a=n instanceof Error?n.message:"Failed to delete chat";t({error:a,isLoading:!1})}},addMessage:r=>{t(n=>{if(n.messages.some(i=>i._id===r._id))return console.log("ChatStore: Message already exists, skipping duplicate:",r._id),n;let o=n.messages;return!r._id.startsWith("temp-")&&r.senderType==="user"&&(o=n.messages.filter(i=>i._id.startsWith("temp-")&&i.senderType==="user"&&i.content.trim()===r.content.trim()?(console.log("ChatStore: Removing optimistic message replaced by real message:",i._id),!1):!0)),console.log("ChatStore: Adding new message:",r._id),{messages:[...o,r]}})},addOptimisticMessage:r=>{var l;const n=`temp-${Date.now()}-${Math.random()}`,a=localStorage.getItem("user");let o=null;if(a)try{o=JSON.parse(a)}catch(c){console.error("ChatStore: Error parsing user for optimistic message:",c)}const i={_id:n,chat:((l=e().currentChat)==null?void 0:l._id)||"",sender:o?{_id:o.id,name:o.name,email:o.email}:null,senderType:"user",content:r,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return t(c=>({messages:[...c.messages,i]})),n},removeOptimisticMessage:r=>{t(n=>({messages:n.messages.filter(a=>a._id!==r)}))},clearMessages:()=>{t({messages:[]})},connectSocket:r=>{console.log("Connecting socket for user:",r),oe.connect(),oe.on("message",n=>{e().addMessage(n)}),oe.on("ai_error",({error:n})=>{t({error:n})}),oe.on("error",({error:n})=>{t({error:n})}),t({isConnected:!0})},disconnectSocket:()=>{oe.disconnect(),t({isConnected:!1})},setError:r=>{t({error:r})},clearError:()=>{t({error:null})}})),Zi=({onSignupClick:t,onBack:e})=>{const[r,n]=x.useState(""),[a,o]=x.useState(""),{login:i,isLoading:l,error:c}=he(),d=ue(),h=async m=>{m.preventDefault();try{await i(r,a),d("/main")}catch{}};return s.jsxs("div",{className:"w-full max-w-md mx-auto",children:[e&&s.jsxs("button",{onClick:e,className:"mb-8 flex items-center text-gray-600 hover:text-gray-800 transition-colors",children:[s.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]}),s.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-md",children:[s.jsx("h2",{className:"text-2xl font-bold text-center mb-6",children:"Login to QuickLister"}),s.jsxs("form",{onSubmit:h,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),s.jsx("input",{id:"email",type:"email",value:r,onChange:m=>n(m.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your email",autoComplete:"email",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),s.jsx("input",{id:"password",type:"password",value:a,onChange:m=>o(m.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your password",autoComplete:"current-password",required:!0})]}),s.jsx("button",{type:"submit",disabled:l,className:`w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white 
              ${l?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}`,children:l?s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Logging in..."]}):"Login"}),s.jsx("div",{className:"flex items-center justify-end mt-4",children:s.jsx("button",{type:"button",className:"text-sm text-blue-600 hover:text-blue-500 focus:outline-none",onClick:t,children:"Create account"})}),c&&s.jsx("div",{className:"mt-4 text-sm text-red-600 bg-red-50 p-3 rounded-md",children:c})]})]})]})},el=({onLoginClick:t,onSuccess:e,onBack:r})=>{const[n,a]=x.useState({name:"",email:"",phone:"",password:"",confirmPassword:""}),[o,i]=x.useState({}),[l,c]=x.useState(!1),{signup:d,isLoading:h,error:m}=he(),u=g=>{const{name:f,value:y}=g.target;a(j=>({...j,[f]:y})),o[f]&&i(j=>({...j,[f]:void 0}))},w=()=>{const g={};return n.name.trim()||(g.name="Name is required"),n.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.email)||(g.email="Invalid email address"):g.email="Email is required",n.phone.trim()?/^[6-9]\d{9}$/.test(n.phone)||(g.phone="Invalid Indian phone number"):g.phone="Phone number is required",n.password?n.password.length<8&&(g.password="Password must be at least 8 characters long"):g.password="Password is required",n.confirmPassword?n.password!==n.confirmPassword&&(g.confirmPassword="Passwords do not match"):g.confirmPassword="Please confirm your password",i(g),Object.keys(g).length===0},p=async g=>{if(g.preventDefault(),!!w())try{await d({name:n.name,email:n.email,phone:n.phone,password:n.password}),e()}catch{}};return s.jsxs("div",{className:"w-full max-w-md mx-auto",children:[r&&s.jsxs("button",{onClick:r,className:"mb-8 flex items-center text-gray-600 hover:text-gray-800 transition-colors",children:[s.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]}),s.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-md",children:[s.jsx("h2",{className:"text-2xl font-bold text-center mb-6",children:"Create an Account"}),s.jsxs("form",{onSubmit:p,className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),s.jsx("input",{id:"name",name:"name",type:"text",value:n.name,onChange:u,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent
                ${o.name?"border-red-500":"border-gray-300"}`,placeholder:"Enter your full name"}),o.name&&s.jsx("p",{className:"mt-1 text-xs text-red-600",children:o.name})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),s.jsx("input",{id:"email",name:"email",type:"email",value:n.email,onChange:u,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent
                ${o.email?"border-red-500":"border-gray-300"}`,placeholder:"Enter your email"}),o.email&&s.jsx("p",{className:"mt-1 text-xs text-red-600",children:o.email})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),s.jsx("input",{id:"phone",name:"phone",type:"tel",value:n.phone,onChange:u,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent
                ${o.phone?"border-red-500":"border-gray-300"}`,placeholder:"Enter your phone number"}),o.phone&&s.jsx("p",{className:"mt-1 text-xs text-red-600",children:o.phone})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{id:"password",name:"password",type:l?"text":"password",value:n.password,onChange:u,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent
                  ${o.password?"border-red-500":"border-gray-300"}`,placeholder:"Create a password"}),s.jsx("button",{type:"button",onClick:()=>c(!l),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:l?s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor",children:[s.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),s.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]}):s.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor",children:[s.jsx("path",{fillRule:"evenodd",d:"M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z",clipRule:"evenodd"}),s.jsx("path",{d:"M12.454 16.697L9.75 13.992a4 4 0 01-3.742-3.741L2.335 6.578A9.98 9.98 0 00.458 10c1.274 4.057 5.065 7 9.542 7 .847 0 1.669-.105 2.454-.303z"})]})})]}),o.password&&s.jsx("p",{className:"mt-1 text-xs text-red-600",children:o.password})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),s.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",value:n.confirmPassword,onChange:u,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent
                ${o.confirmPassword?"border-red-500":"border-gray-300"}`,placeholder:"Confirm your password"}),o.confirmPassword&&s.jsx("p",{className:"mt-1 text-xs text-red-600",children:o.confirmPassword})]}),s.jsx("button",{type:"submit",disabled:h,className:`w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white
              ${h?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}`,children:h?s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[s.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),s.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating account..."]}):"Create Account"}),m&&s.jsx("div",{className:"mt-4 text-sm text-red-600 bg-red-50 p-3 rounded-md",children:m}),s.jsxs("div",{className:"text-center mt-4",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Already have an account? "}),s.jsx("button",{type:"button",className:"text-sm text-blue-600 hover:text-blue-500 focus:outline-none",onClick:t,children:"Log in"})]})]})]})]})},He=43200,Vs=1440,Js=Symbol.for("constructDateFrom");function cs(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&Js in t?t[Js](e):t instanceof Date?new t.constructor(e):new Date(e)}function de(t,e){return cs(t,t)}let tl={};function sl(){return tl}function Ys(t){const e=de(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function ds(t,...e){const r=cs.bind(null,t||e.find(n=>typeof n=="object"));return e.map(r)}function tt(t,e){const r=+de(t)-+de(e);return r<0?-1:r>0?1:r}function rl(t){return cs(t,Date.now())}function nl(t,e,r){const[n,a]=ds(r==null?void 0:r.in,t,e),o=n.getFullYear()-a.getFullYear(),i=n.getMonth()-a.getMonth();return o*12+i}function al(t){return e=>{const n=(t?Math[t]:Math.trunc)(e);return n===0?0:n}}function ol(t,e){return+de(t)-+de(e)}function il(t,e){const r=de(t);return r.setHours(23,59,59,999),r}function ll(t,e){const r=de(t),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function cl(t,e){const r=de(t);return+il(r)==+ll(r)}function dl(t,e,r){const[n,a,o]=ds(r==null?void 0:r.in,t,t,e),i=tt(a,o),l=Math.abs(nl(a,o));if(l<1)return 0;a.getMonth()===1&&a.getDate()>27&&a.setDate(30),a.setMonth(a.getMonth()-i*l);let c=tt(a,o)===-i;cl(n)&&l===1&&tt(n,o)===1&&(c=!1);const d=i*(l-+c);return d===0?0:d}function ul(t,e,r){const n=ol(t,e)/1e3;return al(r==null?void 0:r.roundingMethod)(n)}const hl={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},ml=(t,e,r)=>{let n;const a=hl[t];return typeof a=="string"?n=a:e===1?n=a.one:n=a.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function Tt(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const fl={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},pl={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},gl={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},xl={date:Tt({formats:fl,defaultWidth:"full"}),time:Tt({formats:pl,defaultWidth:"full"}),dateTime:Tt({formats:gl,defaultWidth:"full"})},yl={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},bl=(t,e,r,n)=>yl[t];function Pe(t){return(e,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&t.formattingValues){const i=t.defaultFormattingWidth||t.defaultWidth,l=r!=null&&r.width?String(r.width):i;a=t.formattingValues[l]||t.formattingValues[i]}else{const i=t.defaultWidth,l=r!=null&&r.width?String(r.width):t.defaultWidth;a=t.values[l]||t.values[i]}const o=t.argumentCallback?t.argumentCallback(e):e;return a[o]}}const wl={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},jl={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},vl={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Nl={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Sl={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},kl={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Cl=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},El={ordinalNumber:Cl,era:Pe({values:wl,defaultWidth:"wide"}),quarter:Pe({values:jl,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Pe({values:vl,defaultWidth:"wide"}),day:Pe({values:Nl,defaultWidth:"wide"}),dayPeriod:Pe({values:Sl,defaultWidth:"wide",formattingValues:kl,defaultFormattingWidth:"wide"})};function Le(t){return(e,r={})=>{const n=r.width,a=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],o=e.match(a);if(!o)return null;const i=o[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?_l(l,m=>m.test(i)):Al(l,m=>m.test(i));let d;d=t.valueCallback?t.valueCallback(c):c,d=r.valueCallback?r.valueCallback(d):d;const h=e.slice(i.length);return{value:d,rest:h}}}function Al(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function _l(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function Rl(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const a=n[0],o=e.match(t.parsePattern);if(!o)return null;let i=t.valueCallback?t.valueCallback(o[0]):o[0];i=r.valueCallback?r.valueCallback(i):i;const l=e.slice(a.length);return{value:i,rest:l}}}const Tl=/^(\d+)(th|st|nd|rd)?/i,Pl=/\d+/i,Ll={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Ol={any:[/^b/i,/^(a|c)/i]},Dl={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Fl={any:[/1/i,/2/i,/3/i,/4/i]},Ml={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Il={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Bl={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Ul={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},zl={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},$l={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},ql={ordinalNumber:Rl({matchPattern:Tl,parsePattern:Pl,valueCallback:t=>parseInt(t,10)}),era:Le({matchPatterns:Ll,defaultMatchWidth:"wide",parsePatterns:Ol,defaultParseWidth:"any"}),quarter:Le({matchPatterns:Dl,defaultMatchWidth:"wide",parsePatterns:Fl,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Le({matchPatterns:Ml,defaultMatchWidth:"wide",parsePatterns:Il,defaultParseWidth:"any"}),day:Le({matchPatterns:Bl,defaultMatchWidth:"wide",parsePatterns:Ul,defaultParseWidth:"any"}),dayPeriod:Le({matchPatterns:zl,defaultMatchWidth:"any",parsePatterns:$l,defaultParseWidth:"any"})},Wl={code:"en-US",formatDistance:ml,formatLong:xl,formatRelative:bl,localize:El,match:ql,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Gl(t,e,r){const n=sl(),a=(r==null?void 0:r.locale)??n.locale??Wl,o=2520,i=tt(t,e);if(isNaN(i))throw new RangeError("Invalid time value");const l=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:i}),[c,d]=ds(r==null?void 0:r.in,...i>0?[e,t]:[t,e]),h=ul(d,c),m=(Ys(d)-Ys(c))/1e3,u=Math.round((h-m)/60);let w;if(u<2)return r!=null&&r.includeSeconds?h<5?a.formatDistance("lessThanXSeconds",5,l):h<10?a.formatDistance("lessThanXSeconds",10,l):h<20?a.formatDistance("lessThanXSeconds",20,l):h<40?a.formatDistance("halfAMinute",0,l):h<60?a.formatDistance("lessThanXMinutes",1,l):a.formatDistance("xMinutes",1,l):u===0?a.formatDistance("lessThanXMinutes",1,l):a.formatDistance("xMinutes",u,l);if(u<45)return a.formatDistance("xMinutes",u,l);if(u<90)return a.formatDistance("aboutXHours",1,l);if(u<Vs){const p=Math.round(u/60);return a.formatDistance("aboutXHours",p,l)}else{if(u<o)return a.formatDistance("xDays",1,l);if(u<He){const p=Math.round(u/Vs);return a.formatDistance("xDays",p,l)}else if(u<He*2)return w=Math.round(u/He),a.formatDistance("aboutXMonths",w,l)}if(w=dl(d,c),w<12){const p=Math.round(u/He);return a.formatDistance("xMonths",p,l)}else{const p=w%12,g=Math.trunc(w/12);return p<3?a.formatDistance("aboutXYears",g,l):p<9?a.formatDistance("overXYears",g,l):a.formatDistance("almostXYears",g+1,l)}}function Hl(t,e){return Gl(t,rl(t),e)}const Vl=()=>{const[t,e]=x.useState(!1),[r,n]=x.useState(""),[a,o]=x.useState(!1),i=x.useRef(null),{user:l}=he(),{currentChat:c,messages:d,isLoading:h,error:m,isConnected:u,createChat:w,sendMessage:p,toggleAI:g,connectSocket:f,setCurrentChat:y,clearError:j}=Qi();x.useEffect(()=>{l&&!u&&f(l.id)},[l,u,f]),x.useEffect(()=>{t&&l&&!c&&N()},[t,l,c]),x.useEffect(()=>{v()},[d]);const N=async()=>{if(l){console.log("FloatingChatbot: Initializing AI chat for user:",l),console.log("FloatingChatbot: User ID:",l.id),console.log("FloatingChatbot: Access token in localStorage:",localStorage.getItem("access_token")?"Present":"Missing");try{const k=await w([l.id]);y(k),console.log("FloatingChatbot: AI chat initialized successfully:",k._id)}catch(k){console.error("FloatingChatbot: Failed to initialize AI chat:",k)}}},v=()=>{var k;(k=i.current)==null||k.scrollIntoView({behavior:"smooth"})},C=()=>{e(!t),m&&j()},_=()=>{!r.trim()||!c||(p(r),n(""))},S=k=>{k.key==="Enter"&&!k.shiftKey&&(k.preventDefault(),_())},L=async()=>{if(c)try{await g(c._id,!c.aiEnabled),o(!1)}catch(k){console.error("Failed to toggle AI:",k)}},U=k=>{try{return Hl(new Date(k),{addSuffix:!0})}catch{return"just now"}};return l?s.jsx("div",{className:"fixed bottom-6 right-6 z-[1002]",children:t?s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-80 h-96 flex flex-col overflow-hidden",children:[s.jsxs("div",{className:"bg-blue-600 text-white p-3 flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(wt,{size:20,className:"mr-2"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium",children:"QuickLister AI"}),s.jsx("p",{className:"text-xs opacity-90",children:c!=null&&c.aiEnabled?"AI Assistant Active":"AI Disabled"})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>o(!a),className:"p-1 hover:bg-blue-700 rounded",title:"Settings",children:s.jsx(kn,{size:16})}),s.jsx("button",{onClick:C,className:"p-1 hover:bg-blue-700 rounded",children:s.jsx(ne,{size:20})})]})]}),a&&c&&s.jsxs("div",{className:"bg-gray-50 p-3 border-b",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium",children:"AI Assistant"}),s.jsx("button",{onClick:L,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${c.aiEnabled?"bg-blue-600":"bg-gray-300"}`,disabled:h,children:s.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${c.aiEnabled?"translate-x-6":"translate-x-1"}`})})]}),s.jsx("p",{className:"text-xs text-gray-600 mt-1",children:c.aiEnabled?"AI will respond to your messages":"AI responses are disabled"})]}),s.jsxs("div",{className:"flex-1 p-3 overflow-y-auto",children:[m&&s.jsx("div",{className:"mb-3 p-2 bg-red-100 text-red-700 rounded-lg text-sm",children:m}),d.map((k,V)=>{const ae=k._id.startsWith("temp-");return s.jsx("div",{className:`mb-3 flex ${k.senderType==="user"?"justify-end":"justify-start"}`,children:s.jsx("div",{className:`max-w-[80%] p-3 rounded-lg ${k.senderType==="user"?`bg-blue-500 text-white ${ae?"opacity-70":""}`:"bg-gray-100 text-gray-800"}`,children:s.jsxs("div",{className:"flex items-start",children:[k.senderType==="ai"&&s.jsx(wt,{size:16,className:"mr-2 mt-0.5 text-blue-600"}),k.senderType==="user"&&k.sender&&s.jsx(we,{size:16,className:"mr-2 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm leading-relaxed",children:k.content}),s.jsx("p",{className:`text-xs mt-1 opacity-70 ${k.senderType==="user"?"text-blue-100":"text-gray-500"}`,children:U(k.createdAt)})]})]})})},`${k._id}-${V}`)}),h&&s.jsx("div",{className:"flex justify-start mb-3",children:s.jsx("div",{className:"bg-gray-100 p-3 rounded-lg",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(wt,{size:16,className:"text-blue-600"}),s.jsxs("div",{className:"flex space-x-1",children:[s.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),s.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),s.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]})})}),s.jsx("div",{ref:i})]}),s.jsxs("div",{className:"border-t p-3 flex items-center space-x-2",children:[s.jsx("input",{type:"text",value:r,onChange:k=>n(k.target.value),onKeyPress:S,placeholder:"Type your message...",className:"flex-1 border rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400 text-sm",disabled:h||!c}),s.jsx("button",{onClick:_,disabled:!r.trim()||h||!c,className:"bg-blue-500 text-white p-2 rounded-full hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:s.jsx(Cn,{size:18})})]}),!u&&s.jsx("div",{className:"bg-yellow-100 border-t border-yellow-200 p-2 text-center",children:s.jsx("p",{className:"text-xs text-yellow-700",children:"Connecting to chat server..."})})]}):s.jsxs("button",{onClick:C,className:"bg-blue-600 text-white p-4 rounded-full shadow-lg flex items-center justify-center hover:bg-blue-700 transition-colors group",title:"Open AI Assistant",children:[s.jsx(ir,{size:24,className:"group-hover:scale-110 transition-transform"}),m&&s.jsx("div",{className:"absolute -top-2 -right-2 w-3 h-3 bg-red-500 rounded-full animate-pulse"})]})}):null};function De({children:t,searchQuery:e,setSearchQuery:r,isMapsApiLoaded:n,onSearchSubmit:a}){const[o,i]=B.useState(()=>{const N=localStorage.getItem("sidebarOpen");return N?JSON.parse(N):!1});B.useEffect(()=>{localStorage.setItem("sidebarOpen",JSON.stringify(o))},[o]);const[l,c]=B.useState(""),[d]=B.useState(!1),h=e??l,m=r??c,u=n??d,{isAuthenticated:w,user:p,logout:g}=he(),f=ue();x.useEffect(()=>{w||f("/")},[w,f]);const y=()=>{g(),f("/")},j=N=>{a?a(N):(window.location.pathname!=="/main"&&f("/main"),console.log("Search submitted:",N))};return s.jsxs("div",{className:"flex flex-col h-screen w-full bg-gray-100 relative overflow-hidden",children:[s.jsx(Xo,{toggleSidebar:()=>i(!o),searchQuery:h,setSearchQuery:m,onLocationSelect:()=>{},isMapsApiLoaded:u,isAuthenticated:w,onLogout:y,user:p,onSearchSubmit:j}),s.jsxs("div",{className:"flex flex-1 relative min-h-0",children:[s.jsx(Qo,{isOpen:o,isAuthenticated:w,onLoginClick:()=>f("/login"),onLogout:y,onClose:()=>i(!1)}),s.jsx("main",{className:"flex-1 relative transition-all duration-300 overflow-y-auto h-full",children:s.jsx("div",{className:"h-full overflow-y-auto",children:t})})]}),s.jsx(si,{isAuthenticated:w}),s.jsx(Vl,{})]})}const Ie=({children:t,className:e=""})=>s.jsx("div",{className:`bg-white rounded-lg border border-gray-200 shadow-sm ${e}`,children:t}),xt=({children:t,className:e=""})=>s.jsx("div",{className:`px-6 py-4 border-b border-gray-200 ${e}`,children:t}),Be=({children:t,className:e=""})=>s.jsx("div",{className:`px-6 py-4 ${e}`,children:t}),Jl=({onLogin:t,loading:e=!1,error:r=null})=>{const[n,a]=x.useState(""),[o,i]=x.useState(""),[l,c]=x.useState(!1),[d,h]=x.useState(null),m=async w=>{if(w.preventDefault(),h(null),!n||!o){h("Email and password are required");return}if(!n.includes("@")){h("Please enter a valid email address");return}try{await t(n,o)}catch{}},u=r||d;return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:s.jsx("div",{className:"w-full max-w-md",children:s.jsxs(Ie,{className:"shadow-2xl",children:[s.jsxs(xt,{className:"text-center pb-6",children:[s.jsx("div",{className:"flex justify-center mb-4",children:s.jsx("div",{className:"bg-blue-600 p-3 rounded-full",children:s.jsx(Pt,{className:"h-8 w-8 text-white"})})}),s.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Admin Access"}),s.jsx("p",{className:"text-gray-600",children:"Sign in to access the admin panel"})]}),s.jsxs(Be,{children:[s.jsxs("form",{onSubmit:m,className:"space-y-6",children:[u&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 flex items-center",children:[s.jsx(Fe,{className:"h-5 w-5 text-red-600 mr-2 flex-shrink-0"}),s.jsx("span",{className:"text-sm text-red-600",children:u})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),s.jsx("input",{type:"email",id:"email",value:n,onChange:w=>a(w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"admin@quicklister.com",required:!0,autoComplete:"email"})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{type:l?"text":"password",id:"password",value:o,onChange:w=>i(w.target.value),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your password",required:!0,autoComplete:"current-password"}),s.jsx("button",{type:"button",onClick:()=>c(!l),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:l?s.jsx(En,{className:"h-5 w-5"}):s.jsx(An,{className:"h-5 w-5"})})]})]})]}),s.jsx("button",{type:"submit",disabled:e,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:e?s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Signing in..."]}):"Sign In to Admin Panel"})]}),s.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx(Fe,{className:"h-5 w-5 text-yellow-600 mr-2 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"text-sm text-yellow-700",children:[s.jsx("p",{className:"font-medium mb-1",children:"Admin Access Required"}),s.jsx("p",{children:"Only users with admin privileges can access this panel. Contact your system administrator if you need access."})]})]})})})]})]})})})},be={getDashboardStats:async()=>(await P.get("/admin/dashboard/stats")).data.data,getUsers:async(t=1,e=20)=>(await P.get(`/admin/users?page=${t}&limit=${e}`)).data.data,updateUserStatus:async(t,e)=>{await P.patch(`/admin/users/${t}/status`,{status:e})},deleteUser:async t=>{await P.delete(`/admin/users/${t}`)},getGigs:async(t=1,e=20)=>(await P.get(`/admin/gigs?page=${t}&limit=${e}`)).data.data,updateGigStatus:async(t,e)=>{await P.patch(`/admin/gigs/${t}/status`,{status:e})},deleteGig:async t=>{await P.delete(`/admin/gigs/${t}`)}},Ks=()=>{const[t,e]=x.useState(null),[r,n]=x.useState(!0),[a,o]=x.useState(null);x.useEffect(()=>{i()},[]);const i=async()=>{try{n(!0);const c=await be.getDashboardStats();e(c)}catch(c){o("Failed to fetch dashboard stats"),console.error("Dashboard stats error:",c)}finally{n(!1)}};if(r)return s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(a)return s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-red-600 text-center",children:[s.jsx("p",{className:"mb-2",children:a}),s.jsx("button",{onClick:i,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"})]})});const l=[{title:"Total Users",value:(t==null?void 0:t.totalUsers)||0,icon:Kt,color:"text-blue-600",bgColor:"bg-blue-50"},{title:"Total Gigs",value:(t==null?void 0:t.totalGigs)||0,icon:ie,color:"text-green-600",bgColor:"bg-green-50"},{title:"Total Applications",value:(t==null?void 0:t.totalApplications)||0,icon:Ne,color:"text-purple-600",bgColor:"bg-purple-50"}];return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Admin Dashboard"}),s.jsx("button",{onClick:i,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Refresh"})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:l.map((c,d)=>{const h=c.icon;return s.jsx(Ie,{children:s.jsx(Be,{className:"p-6",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:`${c.bgColor} p-3 rounded-lg mr-4`,children:s.jsx(h,{className:`h-6 w-6 ${c.color}`})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:c.title}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:c.value.toLocaleString()})]})]})})},d)})}),s.jsxs(Ie,{children:[s.jsx(xt,{children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(_n,{className:"h-5 w-5 text-gray-600 mr-2"}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Recent Activity"})]})}),s.jsx(Be,{children:t!=null&&t.recentActivity&&t.recentActivity.length>0?s.jsx("div",{className:"space-y-3",children:t.recentActivity.map(c=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:c.description}),c.userName&&s.jsxs("p",{className:"text-xs text-gray-600",children:["by ",c.userName]})]}),s.jsxs("span",{className:"text-xs text-gray-500",children:[new Date(c.timestamp).toLocaleDateString()," ",new Date(c.timestamp).toLocaleTimeString()]})]},c._id))}):s.jsx("p",{className:"text-gray-600 text-center py-8",children:"No recent activity"})})]})]})},Yl=()=>{const[t,e]=x.useState(null),[r,n]=x.useState(!0),[a,o]=x.useState(null),[i,l]=x.useState(1),[c,d]=x.useState(null),[h,m]=x.useState(null);x.useEffect(()=>{u()},[i]);const u=async()=>{try{n(!0);const f=await be.getUsers(i,20);e(f)}catch(f){o("Failed to fetch users"),console.error("Users fetch error:",f)}finally{n(!1)}},w=async(f,y)=>{try{d(f);const j=y==="active"?"disabled":"active";await be.updateUserStatus(f,j),await u()}catch(j){console.error("Status update error:",j),alert("Failed to update user status")}finally{d(null)}},p=async f=>{try{d(f),await be.deleteUser(f),await u(),m(null)}catch(y){console.error("Delete user error:",y),alert("Failed to delete user")}finally{d(null)}},g=f=>{const y=f==="active";return s.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${y?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:[y?s.jsx(Rn,{className:"w-3 h-3 mr-1"}):s.jsx(Tn,{className:"w-3 h-3 mr-1"}),f==="active"?"Active":"Disabled"]})};return r?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-red-600 text-center",children:[s.jsx("p",{className:"mb-2",children:a}),s.jsx("button",{onClick:u,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"})]})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(Kt,{className:"h-8 w-8 text-gray-600 mr-3"}),s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"User Management"})]}),s.jsx("button",{onClick:u,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Refresh"})]}),s.jsxs(Ie,{children:[s.jsx(xt,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["All Users (",(t==null?void 0:t.total)||0,")"]}),s.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",t==null?void 0:t.page," of ",t==null?void 0:t.totalPages]})]})}),s.jsxs(Be,{children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Name"}),s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Email"}),s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Phone"}),s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Status"}),s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Joined"}),s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Actions"})]})}),s.jsx("tbody",{children:t==null?void 0:t.users.map(f=>s.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[s.jsx("td",{className:"py-3 px-4",children:s.jsx("div",{className:"font-medium text-gray-900",children:f.name})}),s.jsx("td",{className:"py-3 px-4 text-gray-600",children:f.email}),s.jsx("td",{className:"py-3 px-4 text-gray-600",children:f.phone||"N/A"}),s.jsx("td",{className:"py-3 px-4",children:g(f.status||"active")}),s.jsx("td",{className:"py-3 px-4 text-gray-600",children:new Date(f.createdAt).toLocaleDateString()}),s.jsx("td",{className:"py-3 px-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>w(f._id,f.status||"active"),disabled:c===f._id,className:`px-3 py-1 text-xs font-medium rounded transition-colors ${f.status==="active"?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"} ${c===f._id?"opacity-50 cursor-not-allowed":""}`,children:c===f._id?s.jsx("div",{className:"w-3 h-3 border border-current border-t-transparent rounded-full animate-spin"}):f.status==="active"?"Disable":"Enable"}),s.jsx("button",{onClick:()=>m(f._id),disabled:c===f._id,className:"p-1 text-red-600 hover:bg-red-100 rounded transition-colors",children:s.jsx(cr,{className:"w-4 h-4"})})]})})]},f._id))})]})}),t&&t.totalPages>1&&s.jsxs("div",{className:"flex items-center justify-between mt-6 pt-4 border-t border-gray-200",children:[s.jsx("button",{onClick:()=>l(f=>Math.max(1,f-1)),disabled:i===1,className:"px-4 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),s.jsxs("span",{className:"text-sm text-gray-600",children:["Page ",i," of ",t.totalPages]}),s.jsx("button",{onClick:()=>l(f=>Math.min(t.totalPages,f+1)),disabled:i===t.totalPages,className:"px-4 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]}),h&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white p-6 rounded-lg max-w-md w-full mx-4",children:[s.jsxs("div",{className:"flex items-center mb-4",children:[s.jsx(dr,{className:"h-6 w-6 text-red-600 mr-3"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Confirm Delete"})]}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to delete this user? This action cannot be undone and will also delete all their gigs and applications."}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx("button",{onClick:()=>m(null),className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:()=>p(h),disabled:c===h,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50",children:c===h?"Deleting...":"Delete"})]})]})})]})},Kl=()=>{const[t,e]=x.useState(null),[r,n]=x.useState(!0),[a,o]=x.useState(null),[i,l]=x.useState(1),[c,d]=x.useState(null),[h,m]=x.useState(null);x.useEffect(()=>{u()},[i]);const u=async()=>{try{n(!0);const y=await be.getGigs(i,20);e(y)}catch(y){o("Failed to fetch gigs"),console.error("Gigs fetch error:",y)}finally{n(!1)}},w=async(y,j)=>{try{d(y),await be.updateGigStatus(y,j),await u()}catch(N){console.error("Status update error:",N),alert("Failed to update gig status")}finally{d(null)}},p=async y=>{try{d(y),await be.deleteGig(y),await u(),m(null)}catch(j){console.error("Delete gig error:",j),alert("Failed to delete gig")}finally{d(null)}},g=y=>{const j={draft:"bg-gray-100 text-gray-800",posted:"bg-blue-100 text-blue-800",active:"bg-green-100 text-green-800",assigned:"bg-yellow-100 text-yellow-800",in_progress:"bg-purple-100 text-purple-800",completed:"bg-emerald-100 text-emerald-800",cancelled:"bg-red-100 text-red-800",expired:"bg-orange-100 text-orange-800"};return s.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${j[y]||"bg-gray-100 text-gray-800"}`,children:y.charAt(0).toUpperCase()+y.slice(1).replace("_"," ")})},f=["draft","posted","active","assigned","in_progress","completed","cancelled","expired"];return r?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):a?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsxs("div",{className:"text-red-600 text-center",children:[s.jsx("p",{className:"mb-2",children:a}),s.jsx("button",{onClick:u,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Retry"})]})}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(ie,{className:"h-8 w-8 text-gray-600 mr-3"}),s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gig Management"})]}),s.jsx("button",{onClick:u,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Refresh"})]}),s.jsxs(Ie,{children:[s.jsx(xt,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["All Gigs (",(t==null?void 0:t.total)||0,")"]}),s.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",t==null?void 0:t.page," of ",t==null?void 0:t.totalPages]})]})}),s.jsxs(Be,{children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Title"}),s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Category"}),s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Posted By"}),s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Payment"}),s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Applications"}),s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Status"}),s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Posted"}),s.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Actions"})]})}),s.jsx("tbody",{children:t==null?void 0:t.gigs.map(y=>s.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[s.jsx("td",{className:"py-3 px-4",children:s.jsx("div",{className:"font-medium text-gray-900 max-w-xs truncate",children:y.title})}),s.jsx("td",{className:"py-3 px-4 text-gray-600",children:y.category.replace("_"," ")}),s.jsx("td",{className:"py-3 px-4 text-gray-600",children:y.posterName}),s.jsx("td",{className:"py-3 px-4",children:s.jsxs("div",{className:"flex items-center text-gray-600",children:[s.jsx(Jt,{className:"w-3 h-3 mr-1"}),"â‚¹",y.payment.rate,"/",y.payment.paymentType]})}),s.jsx("td",{className:"py-3 px-4 text-gray-600",children:y.applicationCount}),s.jsx("td",{className:"py-3 px-4",children:g(y.status)}),s.jsx("td",{className:"py-3 px-4 text-gray-600",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(at,{className:"w-3 h-3 mr-1"}),new Date(y.createdAt).toLocaleDateString()]})}),s.jsx("td",{className:"py-3 px-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("select",{value:y.status,onChange:j=>w(y._id,j.target.value),disabled:c===y._id,className:"text-xs border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",children:f.map(j=>s.jsx("option",{value:j,children:j.charAt(0).toUpperCase()+j.slice(1).replace("_"," ")},j))}),s.jsx("button",{onClick:()=>m(y._id),disabled:c===y._id,className:"p-1 text-red-600 hover:bg-red-100 rounded transition-colors",children:s.jsx(cr,{className:"w-4 h-4"})})]})})]},y._id))})]})}),t&&t.totalPages>1&&s.jsxs("div",{className:"flex items-center justify-between mt-6 pt-4 border-t border-gray-200",children:[s.jsx("button",{onClick:()=>l(y=>Math.max(1,y-1)),disabled:i===1,className:"px-4 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),s.jsxs("span",{className:"text-sm text-gray-600",children:["Page ",i," of ",t.totalPages]}),s.jsx("button",{onClick:()=>l(y=>Math.min(t.totalPages,y+1)),disabled:i===t.totalPages,className:"px-4 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]}),h&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white p-6 rounded-lg max-w-md w-full mx-4",children:[s.jsxs("div",{className:"flex items-center mb-4",children:[s.jsx(dr,{className:"h-6 w-6 text-red-600 mr-3"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Confirm Delete"})]}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to delete this gig? This action cannot be undone and will also remove all applications for this gig."}),s.jsxs("div",{className:"flex justify-end space-x-3",children:[s.jsx("button",{onClick:()=>m(null),className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsx("button",{onClick:()=>p(h),disabled:c===h,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50",children:c===h?"Deleting...":"Delete"})]})]})})]})},Xl=({onLogout:t})=>{const[e,r]=x.useState("dashboard"),[n,a]=x.useState(!1),o=[{id:"dashboard",label:"Dashboard",icon:Pn,component:Ks},{id:"users",label:"Users",icon:Kt,component:Yl},{id:"gigs",label:"Gigs",icon:ie,component:Kl}],i=o.find(c=>c.id===e),l=(i==null?void 0:i.component)||Ks;return s.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[s.jsxs("div",{className:`
        fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg transform transition-transform duration-300 ease-in-out
        lg:translate-x-0 lg:static lg:inset-0
        ${n?"translate-x-0":"-translate-x-full"}
      `,children:[s.jsxs("div",{className:"flex items-center justify-between h-16 px-6 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(Pt,{className:"h-8 w-8 text-blue-600 mr-2"}),s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Admin Panel"})]}),s.jsx("button",{onClick:()=>a(!1),className:"lg:hidden p-1 rounded-md text-gray-400 hover:text-gray-600",children:s.jsx(ne,{className:"h-6 w-6"})})]}),s.jsx("nav",{className:"mt-6 px-3",children:s.jsx("div",{className:"space-y-1",children:o.map(c=>{const d=c.icon,h=e===c.id;return s.jsxs("button",{onClick:()=>{r(c.id),a(!1)},className:`
                    w-full flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors
                    ${h?"bg-blue-100 text-blue-700 border-r-2 border-blue-700":"text-gray-600 hover:bg-gray-100 hover:text-gray-900"}
                  `,children:[s.jsx(d,{className:`
                    mr-3 h-5 w-5 flex-shrink-0
                    ${h?"text-blue-700":"text-gray-400"}
                  `}),c.label]},c.id)})})}),s.jsx("div",{className:"absolute bottom-6 left-3 right-3",children:s.jsxs("button",{onClick:t,className:"w-full flex items-center px-3 py-2 text-sm font-medium text-red-600 rounded-lg hover:bg-red-50 hover:text-red-700 transition-colors",children:[s.jsx(lr,{className:"mr-3 h-5 w-5 flex-shrink-0"}),"Logout"]})})]}),n&&s.jsx("div",{className:"fixed inset-0 z-40 bg-black bg-opacity-25 lg:hidden",onClick:()=>a(!1)}),s.jsxs("div",{className:"flex-1 lg:ml-0",children:[s.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between h-16 px-4 sm:px-6 lg:px-8",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("button",{onClick:()=>a(!0),className:"lg:hidden p-2 rounded-md text-gray-400 hover:text-gray-600 hover:bg-gray-100",children:s.jsx(Ln,{className:"h-6 w-6"})}),s.jsx("h2",{className:"ml-2 lg:ml-0 text-lg font-semibold text-gray-900",children:(i==null?void 0:i.label)||"Dashboard"})]}),s.jsx("div",{className:"flex items-center space-x-4",children:s.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[s.jsx(Pt,{className:"h-4 w-4 mr-1"}),"Administrator"]})})]})}),s.jsx("main",{className:"p-4 sm:p-6 lg:p-8",children:s.jsx(l,{})})]})]})};function Ql(){const[t,e]=B.useState(!1),[r,n]=B.useState(!1),[a,o]=B.useState(null),[i,l]=B.useState(!0);B.useEffect(()=>{c()},[]);const c=async()=>{try{l(!0);const m=await re.isAdmin();e(m)}catch{e(!1)}finally{l(!1)}},d=async(m,u)=>{try{n(!0),o(null),await re.adminLogin({email:m,password:u}),e(!0)}catch(w){throw o(w instanceof Error?w.message:"Admin login failed"),w}finally{n(!1)}},h=async()=>{try{await re.logout(),e(!1),o(null)}catch(m){console.error("Admin logout error:",m)}};return i?s.jsx(ts,{}):t?s.jsx(Xl,{onLogout:h}):s.jsx(Jl,{onLogin:d,loading:r,error:a})}function Zl(){const t=ue();return s.jsx(Io,{onGetStarted:()=>t("/auth-selection")})}function ec(){const t=ue();return s.jsx(Bo,{onLoginClick:()=>t("/login"),onSignupClick:()=>t("/signup"),onBack:()=>t("/")})}function tc(){const t=ue();return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-white flex flex-col",children:[s.jsx(rs,{}),s.jsx("div",{className:"flex-1 flex items-center justify-center px-4",children:s.jsx("div",{className:"max-w-md w-full",children:s.jsx(Zi,{onSignupClick:()=>t("/signup"),onBack:()=>t("/")})})}),s.jsx(ss,{})]})}function sc(){const t=ue();return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-white flex flex-col",children:[s.jsx(rs,{}),s.jsx("div",{className:"flex-1 flex items-center justify-center px-4",children:s.jsx("div",{className:"max-w-md w-full",children:s.jsx(el,{onLoginClick:()=>t("/login"),onSuccess:()=>t("/main"),onBack:()=>t("/")})})}),s.jsx(ss,{})]})}function rc(){const[t,e]=B.useState(""),[r]=B.useState(null),[n,a]=B.useState(!1),o=i=>{console.log("Search submitted in MapRoute:",i),e(i)};return s.jsx(De,{searchQuery:t,setSearchQuery:e,isMapsApiLoaded:n,onSearchSubmit:o,children:s.jsx(Mo,{searchQuery:t,selectedLocation:r,onMapsApiLoaded:a})})}function nc(){return s.jsx(B.StrictMode,{children:s.jsx(B.Suspense,{fallback:s.jsx(ts,{}),children:s.jsx(Lo,{children:s.jsx(ac,{})})})})}function ac(){const{isAuthenticated:t,isInitialized:e}=he();return e?s.jsx(un,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:s.jsxs(hn,{children:[s.jsx(K,{path:"/",element:t?s.jsx(ee,{to:"/main"}):s.jsx(Zl,{})}),s.jsx(K,{path:"/auth-selection",element:t?s.jsx(ee,{to:"/main"}):s.jsx(ec,{})}),s.jsx(K,{path:"/login",element:t?s.jsx(ee,{to:"/main"}):s.jsx(tc,{})}),s.jsx(K,{path:"/signup",element:t?s.jsx(ee,{to:"/main"}):s.jsx(sc,{})}),s.jsx(K,{path:"/admin/*",element:s.jsx(Ql,{})}),s.jsx(K,{path:"/main",element:t?s.jsx(rc,{}):s.jsx(ee,{to:"/login"})}),s.jsx(K,{path:"/dashboard",element:t?s.jsx(De,{children:s.jsx(Vo,{})}):s.jsx(ee,{to:"/login"})}),s.jsx(K,{path:"/my-gigs",element:t?s.jsx(De,{children:s.jsx(zo,{})}):s.jsx(ee,{to:"/login"})}),s.jsx(K,{path:"/applications",element:t?s.jsx(De,{children:s.jsx(qo,{})}):s.jsx(ee,{to:"/login"})}),s.jsx(K,{path:"/profile",element:t?s.jsx(De,{children:s.jsx(Yo,{})}):s.jsx(ee,{to:"/login"})}),s.jsx(K,{path:"*",element:s.jsx(ee,{to:"/"})})]})}):s.jsx(ts,{})}Dn.createRoot(document.getElementById("root")).render(s.jsx(nc,{}));
